"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSSUI",["require","exports","react","VSS/Core/Util/String"],(function(e,t,i,a){var n,r,s,o,d,l,c,m,p,u,y,h,C,f,b,E;n=t.ResourcesPersona={},t.ResourcesPersona.Loading="Loading...",t.ResourcesPersona.IdentityCardLoadingText="Loading identities...",t.ResourcesPersona.IdentityCardResultsFoundText="Showing {0} results",t.ResourcesPersona.IdentityCardPlaceholderText="Search users and groups",t.ResourcesPersona.IdentityCardNoResultsText="No identities found",t.ResourcesPersona.IdentityCardContact="Contact",t.ResourcesPersona.IdentityCardStartChat="Start chat",t.ResourcesPersona.IdentityCardOrganization="Organization",t.ResourcesPersona.IdentityCardReportingTo="Reporting to {0} ({1})",t.ResourcesPersona.IdentityCardReportsTo="Reports to",t.ResourcesPersona.IdentityCardUnknownUser="Unknown user",t.ResourcesPersona.IdentityCardProfileCardAriaLabel="Contact card",t.ResourcesPersona.IdentityCardHeaderButtonLabel="Go back",t.ResourcesPersona.IdentityCardContactInfo="Contact information",t.ResourcesPersona.IdentityCardEmail="Email",t.ResourcesPersona.IdentityCardPhoneNumber="Phone number",t.ResourcesPersona.IdentityCardLocation="Location",t.ResourcesPersona.IdentityCardTitle="Title",t.ResourcesPersona.IdentityCardDepartment="Department",t.ResourcesPersona.IdentityCardAlias="Alias",t.ResourcesPersona.IdentityCardMembers="{0} members",t.ResourcesPersona.IdentityCardMembersCount="Members ({0})",t.ResourcesPersona.IdentityCardDistributionList="Distribution list",function(e){r=t[e]={};class a extends i.Component{constructor(e){super(e),this.targetElement=i.createRef(),this.showIdentityCard=()=>{this.props.personaProvider&&this.props.personaProvider.renderIdentityCard&&this.setState({showIdentityCard:!0})},this.onClick=e=>{this.props.personaProvider&&this.props.personaProvider.renderIdentityCard&&this.setState({showIdentityCard:!0}),e.preventDefault()},this.hideIdentityCard=()=>{this.setState({showIdentityCard:!1})},this.state={imageError:!1,imageLoaded:!1,showIdentityCard:!1}}render(){const{ariaLabel:e,ariaHidden:a,className:n,personaProvider:r,identity:s,size:o,tooltipProps:d}=this.props,l=!!r&&!!r.renderIdentityCard,c=s.image||s.imageUrl;return i.createElement(i.Fragment,null,i.createElement("div",{"aria-hidden":a,ref:this.targetElement},i.createElement(t.Coin.Coin,{ariaLabel:e,className:n,dataIsFocusable:l,isTabStop:l,onClick:l?this.onClick:void 0,displayName:s.displayName||"",imageUrl:this.getServerImageFromSize(c),imgAltText:s.displayName,size:o,tooltipProps:d})),this.state.showIdentityCard&&r&&r.renderIdentityCard&&r.renderIdentityCard(s,r,this.hideIdentityCard,this.targetElement.current))}getServerImageFromSize(e){if(e){if(this.props.size){if(this.props.size<=24)return e+(-1===e.indexOf("?")?"?size=0":"&size=0");if(this.props.size>40)return e+(-1===e.indexOf("?")?"?size=2":"&size=2")}return e}}}t[e].Persona=a}("ComponentsPersonaPersona"),function(e){s=t[e]={};t[e].CardContactLine=e=>i.createElement("div",{className:"bolt-identity-default-card-contact-line-wrapper flex-row"},i.createElement(t.Icon.Icon,{iconName:e.iconName,className:"bolt-identity-default-card-contact-line-label font-size"}),e.link&&i.createElement(t.Link.Link,{className:"flex-row text-ellipsis",href:e.link},e.hiddenLabel&&i.createElement("span",{className:"screen-reader-only"},e.hiddenLabel),e.content),!e.link&&i.createElement("span",{className:"bolt-identity-default-card-contact-line-no-link text-ellipsis"},e.content))}("ComponentsIdentityCardCardContactLine"),function(e){o=t[e]={};t[e].ContactCardContactLine=e=>{const{content:a,label:n,link:r,padTop:s}=e;return i.createElement("div",{className:"flex-column scroll-hidden"},i.createElement("div",{className:(0,t.Util.css)("bolt-identity-contact-card-line flex-row flex-grow",s&&"bolt-identity-contact-card-line-top")},i.createElement("div",{className:"bolt-identity-contact-card-span-label flex-noshrink"},n),i.createElement("div",{className:"bolt-identity-contact-card-span-content flex-grow flex-row"},r&&a&&i.createElement(t.Link.Link,{className:"flex-row text-ellipsis",href:r},a),!r&&a)))};t[e].ContactCard=a=>{const{identity:r}=a;return i.createElement("div",{className:"bolt-bolt-identity-contact-card-organization-card-wrapper flex-column scroll-hidden"},i.createElement("div",{className:"bolt-identity-contact-card-header-wrapper"},i.createElement("div",{className:"body-m"},n.IdentityCardContactInfo)),i.createElement("div",{className:"bolt-identity-contact-card-info-wrapper flex-column flex-grow body-s"},i.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardEmail,content:r.mail,link:`mailto:${r.mail}`}),i.createElement(t[e].ContactCardContactLine,{content:r.telephoneNumber,label:n.IdentityCardPhoneNumber,link:`mailto:${r.telephoneNumber}`}),i.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardLocation,content:r.physicalDeliveryOfficeName}),i.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardTitle,content:r.jobTitle,padTop:!0}),i.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardDepartment,content:r.department}),i.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardAlias,content:r.mailNickname})))}}("ComponentsIdentityCardContactCard"),function(e){d=t[e]={};t[e].DefaultAbridgedCard=e=>{const{displayName:t,signInAddress:a}=e.identity;return i.createElement("div",{className:"bolt-default-card-abridged flex-column scroll-hidden"},i.createElement("div",{className:"flex-row"},i.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:e.identity}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},i.createElement("div",{className:"text-ellipsis title-s"},t))),function(e){return!!e&&!!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e)}(a)&&i.createElement("div",{className:"flex-column scroll-hidden"},i.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},i.createElement("b",null,n.IdentityCardContact))),i.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},i.createElement(s.CardContactLine,{iconName:"Mail",hiddenLabel:n.IdentityCardEmail,content:a,link:`mailto:${a}`}),i.createElement(s.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${a}`}))))}}("ComponentsIdentityCardDefaultAbridgedCard"),function(e){l=t[e]={};class a extends i.Component{constructor(){super(...arguments),this.contactButtonRef=i.createRef()}componentDidMount(){this.contactButtonRef.current&&this.contactButtonRef.current.focus()}render(){const{identity:e,isPreviousHeader:a}=this.props,{displayName:o,department:d,jobTitle:l,mail:c,physicalDeliveryOfficeName:m,telephoneNumber:p}=e;return i.createElement("div",{className:(0,t.Util.css)("bolt-identity-card-content flex-column scroll-hidden",a?"bolt-identity-default-card-with-header":"bolt-identity-default-card-without-header")},i.createElement("div",{className:"flex-row"},i.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:this.props.identity}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},i.createElement("div",{className:"text-ellipsis title-s"},o),""===l?void 0:i.createElement("div",{className:"text-ellipsis"},l),""===d?void 0:i.createElement("div",{className:"text-ellipsis"},d))),i.createElement("div",{className:"flex-column scroll-hidden"},(c||p||m)&&i.createElement("div",{className:"bolt-identity-default-card-info-wrapper "},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},i.createElement(t.Button.Button,{"aria-label":n.IdentityCardContact,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element",onClick:()=>{this.props.showContactCard()},ref:this.contactButtonRef,role:"button",subtle:!0,text:n.IdentityCardContact},i.createElement(t.Icon.Icon,{iconName:"ChevronRight"}))),i.createElement("div",{className:"bolt-identity-default-card-contact-info-container flex-column scroll-hidden"},c&&i.createElement(s.CardContactLine,{iconName:"Mail",hiddenLabel:n.IdentityCardEmail,content:c,link:`mailto:${c}`}),c&&i.createElement(s.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${c}`}),p&&i.createElement(s.CardContactLine,{iconName:"Phone",hiddenLabel:n.IdentityCardPhoneNumber,content:p,link:`tel:${p}`}),m&&i.createElement(s.CardContactLine,{iconName:"POI",hiddenLabel:n.IdentityCardLocation,content:m}))),this.renderDirectManagerElement()))}renderDirectManagerElement(){if(!this.props.manager)return i.createElement("div",null);const e=this.props.manager,a={imageUrl:e.image,primaryText:e.displayName,secondaryText:e.jobTitle,tertiaryText:e.department};return i.createElement("div",{className:"bolt-identity-default-card-direct-manager-wrapper"},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},i.createElement(t.Button.Button,{"aria-label":n.IdentityCardOrganization,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element",onClick:()=>{this.props.showOrganizationCard&&this.props.showOrganizationCard()},role:"button",text:n.IdentityCardOrganization,subtle:!0},i.createElement(t.Icon.Icon,{iconName:"ChevronRight"}))),i.createElement("div",{className:"bolt-identity-default-card-direct-manager"},i.createElement("div",{className:"bolt-identity-default-card-header-reportsto"},n.IdentityCardReportsTo),i.createElement("div",{className:"flex-row scroll-hidden bolt-identity-card-reports-to-wrapper"},i.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element bolt-profile-card-tab-element flex-shrink text-ellipsis","aria-label":e.displayName,key:e.entityId+e.signInAddress,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},i.createElement(r.Persona,{size:40,identity:e}),i.createElement("div",{className:"bolt-identity-card-text flex-column scroll-hidden"},i.createElement("div",{className:"primary-text flex-row text-ellipsis"},a.primaryText),""===a.secondaryText?void 0:i.createElement("div",{className:"secondary-text flex-row text-ellipsis"},a.secondaryText))))))}}t[e].DefaultCard=a}("ComponentsIdentityCardDefaultCard"),function(e){c=t[e]={};t[e].DefaultSimpleCard=e=>{const a={imageUrl:e.identity.image,primaryText:e.identity.displayName,secondaryText:e.identity.scopeName&&e.identity.signInAddress?e.identity.scopeName+"\\"+e.identity.signInAddress:e.identity.signInAddress?e.identity.signInAddress:""};return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(t=>i.createElement("div",{className:"bolt-identity-default-card-simple bolt-identity-card-content flex-row scroll-hidden"},i.createElement("div",{className:"flex-row flex-grow"},i.createElement(r.Persona,{className:"bolt-identity-card-persona-main",identity:e.identity,size:72}),i.createElement("div",{className:"bolt-identity-card-persona-text flex-column flex-grow"},i.createElement("div",{className:"primary-text flex-row title-s",tabIndex:0,"data-focuszone":t.focuszoneId},a.primaryText),""===a.secondaryText?void 0:i.createElement("div",{className:"secondary-text flex-row body-l"},a.secondaryText))))))}}("ComponentsIdentityCardDefaultSimpleCard"),function(e){m=t[e]={};t[e].GroupMembersCard=e=>{const{members:s,onClickEntity:o}=e,d=(0,a.format)(n.IdentityCardMembers,s?s.length:0),l=s?s.map((e=>{const a={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return i.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow scroll-hidden",key:e.entityId+e.signInAddress},i.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-grow flex-shrink text-ellipsis","aria-label":e.displayName,onClick:()=>{o&&o(e)},subtle:!0},i.createElement(r.Persona,{size:40,identity:e}),i.createElement("div",{className:"flex-column flex-grow flex-shrink bolt-identity-card-name scroll-hidden"},i.createElement("div",{className:"text-left text-ellipsis"},a.primaryText),""===a.secondaryText?void 0:i.createElement("div",{className:"text-left text-ellipsis"},a.secondaryText))))})):[];return i.createElement("div",{className:"bolt-identity-contact-card-organization-card-wrapper bolt-identity-card-content"},i.createElement("div",{className:(0,t.Util.css)("bolt-identity-organization-card-content v-scroll-auto h-scroll-hidden",0===l.length&&"flex-row justify-center")},l.length>0?i.createElement(i.Fragment,null,i.createElement("div",{className:"bolt-identity-organization-card-header-wrapper"},d," "),i.createElement("div",{className:"bolt-identity-organization-card-members-wrapper"},l)):i.createElement(t.Spinner.Spinner,{label:n.Loading,size:"large",className:"bolt-identity-card-loading-spinner"})))}}("ComponentsIdentityCardGroupMembersCard"),function(e){p=t[e]={};t[e].GroupCard=e=>{const{identity:o,members:d,showOrganizationCard:l}=e,{displayName:c,mail:m,physicalDeliveryOfficeName:p,telephoneNumber:u}=o,y=i.useRef(null),h=m||u||p;i.useEffect((()=>{h||y.current&&y.current.focus()}),[]);const C=(0,a.format)(n.IdentityCardMembersCount,d?d.length:0);return i.createElement("div",{className:"bolt-identity-default-card-without-header bolt-identity-card-content"},i.createElement("div",{ref:y,tabIndex:-1}),i.createElement("div",{className:"flex-row"},i.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:o}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},i.createElement(t.TooltipEx.Tooltip,{text:c,overflowOnly:!0},i.createElement("div",{className:"text-ellipsis title-s"},c)),d&&d.length>0?i.createElement("div",{className:"text-ellipsis"},(0,a.format)(n.IdentityCardMembers,d.length)):void 0)),i.createElement("div",null,h&&i.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},m&&i.createElement(s.CardContactLine,{iconName:"Mail",content:m,link:`mailto:${m}`}))),d&&d.length>0?i.createElement("div",{className:"bolt-identity-default-card-member-list-wrapper "},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},i.createElement(t.Button.Button,{"aria-label":C,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element flex-center",onClick:()=>{l&&l()},role:"button",text:C,subtle:!0},i.createElement(t.Icon.Icon,{iconName:"ChevronRight"})))):void 0))}}("ComponentsIdentityCardGroupCard"),function(e){u=t[e]={};t[e].GitHubCard=e=>{const{identity:t}=e,{displayName:a,mail:o,mailNickname:d}=t;return i.createElement("div",{className:"bolt-identity-default-card-without-header bolt-identity-card-content"},i.createElement("div",{className:"flex-row"},i.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:t}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},i.createElement("div",{className:"text-ellipsis title-s"},a),""===d?void 0:i.createElement("div",{className:"text-ellipsis"},d),""===o?void 0:i.createElement("div",{className:"text-ellipsis"},o))),i.createElement("div",null,(o||d)&&i.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},i.createElement("div",{className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element"},n.IdentityCardContact)),i.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},d&&i.createElement(s.CardContactLine,{iconName:"GitHubLogo",content:"thomabr"}),o&&i.createElement(s.CardContactLine,{iconName:"Mail",content:o,link:`mailto:${o}`}),o&&i.createElement(s.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${o}`})))))}}("ComponentsIdentityCardGitHubCard"),function(e){y=t[e]={};class s extends i.Component{constructor(){super(...arguments),this.createManagerChainIdentityElements=()=>{const e=this.props.managerList?this.props.managerList.map((e=>{const a={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return i.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow scroll-hidden",key:e.entityId+e.signInAddress},i.createElement(t.Button.Button,{"aria-label":e.displayName,className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row text-ellipsis",onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},i.createElement(r.Persona,{size:40,identity:e}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name text-ellipsis"},i.createElement("div",{className:"text-left text-ellipsis"},a.primaryText),""===a.secondaryText?void 0:i.createElement("div",{className:"text-left text-ellipsis"},a.secondaryText))))})):[],a={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department};return e.push(i.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow",key:this.props.identity.entityId+this.props.identity.signInAddress},i.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-shrink text-ellipsis","aria-label":this.props.identity.displayName,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(this.props.identity)},subtle:!0},i.createElement(r.Persona,{size:40,identity:this.props.identity}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name text-ellipsis"},i.createElement("div",{className:"text-left text-ellipsis"},a.primaryText),""===a.secondaryText?void 0:i.createElement("div",{className:"text-left text-ellipsis"},a.secondaryText))))),e},this.createDirectReportsIdentityElements=()=>this.props.directReportList?this.props.directReportList.map((e=>{const a={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return i.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow",key:e.entityId+e.signInAddress},i.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row text-ellipsis","aria-label":e.displayName,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},i.createElement(r.Persona,{size:40,identity:e}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name text-ellipsis"},i.createElement("div",{className:"text-left text-ellipsis"},a.primaryText),""===a.secondaryText?void 0:i.createElement("div",{className:"text-left text-ellipsis"},a.secondaryText))))})):[]}render(){const e=this.createManagerChainIdentityElements(),t=this.createDirectReportsIdentityElements();return i.createElement("div",{className:"bolt-identity-contact-card-organization-card-wrapper bolt-identity-card-content"},i.createElement("div",{className:"bolt-identity-organization-card-content v-scroll-auto h-scroll-hidden"},i.createElement("div",{className:"bolt-identity-organization-card-header-wrapper"},n.IdentityCardOrganization," "),i.createElement("div",{className:"bolt-identity-organization-card-manager-chain-wrapper"},e),t.length>0&&i.createElement("div",{className:"bolt-identity-organization-card-direct-reports-wrapper"},(0,a.format)(n.IdentityCardReportingTo,this.props.identity.displayName,this.props.directReportList?this.props.directReportList.length:0),t)))}}t[e].OrganizationCard=s}("ComponentsIdentityCardOrganizationCard"),function(e){h=t[e]={};class a extends i.Component{constructor(){super(...arguments),this.contactButtonRef=i.createRef()}componentDidMount(){this.contactButtonRef.current&&this.contactButtonRef.current.focus()}render(){const{identity:e}=this.props,{displayName:a,mail:n,originId:o}=e;return i.createElement("div",{className:(0,t.Util.css)("bolt-identity-card-content flex-column scroll-hidden","bolt-identity-default-card-without-header")},i.createElement("div",{className:"flex-row"},i.createElement(r.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:this.props.identity}),i.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},i.createElement("div",{className:"text-ellipsis title-s"},a),i.createElement("div",{className:"text-ellipsis"},n))),i.createElement("div",{className:"flex-column scroll-hidden"},i.createElement("div",{className:"bolt-identity-default-card-info-wrapper "},i.createElement("hr",{className:"bolt-identity-card-hr"}),i.createElement("div",{className:"bolt-identity-default-card-contact-info-container flex-column scroll-hidden"},o&&i.createElement(s.CardContactLine,{iconName:"ContactCard",content:o})))))}}t[e].ServicePrincipalCard=a}("ComponentsIdentityCardServicePrincipalCard"),function(e){C=t[e]={};class a extends i.Component{constructor(){super(...arguments),this.personaElement=i.createRef()}componentDidMount(){this.setFocus()}componentDidUpdate(){this.setFocus()}render(){const{identity:e}=this.props;return e?i.createElement("div",{className:"flex-row scroll-hidden"},i.createElement(t.Button.Button,{className:"bolt-identity-card-go-back-wrapper flex-row flex-grow scroll-hidden",onClick:this.props.onClickFunction,"aria-label":n.IdentityCardHeaderButtonLabel,ref:this.personaElement,primary:!0},i.createElement(t.Icon.Icon,{iconName:"ChevronLeftMed"}),i.createElement(r.Persona,{className:"bolt-identity-card-go-back",size:24,identity:e}),i.createElement("div",{className:"bolt-identity-card-name text-ellipsis"},e.displayName))):i.createElement("div",null)}setFocus(){this.personaElement.current&&this.personaElement.current.focus()}}t[e].IdentityCardHeaderElement=a}("ComponentsIdentityCardIdentityCardHeaderElement"),function(e){function i(e){return!!e&&!!e.originDirectory&&"aad"===e.originDirectory.trim().toLowerCase()}function a(e){return!!e&&!!e.originDirectory&&"ad"===e.originDirectory.trim().toLowerCase()}function n(e){return!!e&&!!e.entityType&&"group"===e.entityType.trim().toLowerCase()}function r(e){return!!e&&!!e.originDirectory&&"vsd"===e.originDirectory.trim().toLowerCase()}function s(e){return!!e&&!!e.originDirectory&&"wmd"===e.originDirectory.trim().toLowerCase()}f=t[e]={},t[e].isCompleteIdentity=function(e,t){return!!e&&(n(e)?e.mail||e.displayName:i(e)||a(e)?!!(t&&e.mail||e.mailNickname||e.jobTitle||e.department||e.physicalDeliveryOfficeName||e.manager||e.surname||e.telephoneNumber):r(e)?!!e.signInAddress:!!s(e)&&!(!e.scopeName&&!e.signInAddress))},t[e].isAadUser=i,t[e].isAadServicePrincipal=function(e){return!!e&&!!e.subjectDescriptor&&e.subjectDescriptor.trim().startsWith("aadsp")},t[e].isAdUser=a,t[e].isGithubUser=function(e){return!!e&&!!e.originDirectory&&"github"===e.originDirectory.trim().toLowerCase()},t[e].isGroup=n,t[e].isVsdUser=r,t[e].isWmdUser=s}("ComponentsIdentityCardIdentityCardIdentityUtils"),function(e){b=t[e]={};class a extends i.Component{constructor(){super(...arguments),this.onKeyDown=e=>{27===e.which&&(this.onDismissCallout(),e.preventDefault())},this.onDismissCallout=()=>{this.props.onDismissCallback&&this.props.onDismissCallback()}}render(){const e=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return i.createElement(t.Callout.Callout,{onDismiss:this.onDismissCallout,anchorElement:e,anchorOrigin:{horizontal:"end",vertical:"start"},calloutOrigin:{horizontal:"start",vertical:"start"},ariaLabel:n.IdentityCardProfileCardAriaLabel,className:"bolt-identity-card-callout h-scroll-hidden depth-8",contentClassName:"v-scroll-auto",escDismiss:!0,lightDismiss:!0,ref:this.props.calloutRef},i.createElement("div",null,this.renderCard()))}renderCard(){const e="bolt-identity-card scroll-h-hidden";if(this.props.working&&!f.isCompleteIdentity(this.props.dataProps.identity))return i.createElement("div",{className:(0,t.Util.css)(e,"loading flex-row justify-center")},i.createElement(t.Spinner.Spinner,{label:n.Loading,size:"large",className:"bolt-identity-card-loading-spinner"}));const a=f.isAdUser(this.props.dataProps.identity)||f.isAadUser(this.props.dataProps.identity)||f.isGroup(this.props.dataProps.identity),r=this.props.dataProps.header||void 0,s=this.renderInnerCard();return s?i.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:".bolt-identity-card-focus-element",direction:2,focusOnMount:!0,handleTabKey:!0},i.createElement("div",{className:"bolt-identity-card-focus-element",tabIndex:-1}),i.createElement("div",{className:e,onKeyDown:this.onKeyDown},a&&r&&i.createElement(C.IdentityCardHeaderElement,{identity:r,onClickFunction:this.props.onHeaderClick}),s)):i.createElement("div",null)}renderInnerCard(){const{identity:e,successors:t,managerList:a,directReportList:r}=this.props.dataProps;if(!e||!0===this.props.showUnknownUser)return i.createElement("div",{className:"bolt-identity-card-content bolt-identity-card-unknown-user-content flex-column flex-center justify-center title-xs scroll-hidden"},n.IdentityCardUnknownUser);const s=f.isGroup(e),C=f.isVsdUser(e),b=f.isWmdUser(e),E=f.isAadUser(e),g=f.isAadServicePrincipal(e),x=f.isAdUser(e),N=f.isGithubUser(e);if(s)switch(this.props.dataProps.cardType){case 2:return i.createElement(m.GroupMembersCard,{identity:e,members:t,onClickEntity:this.props.onClickEntity});case 0:return i.createElement(p.GroupCard,{identity:e,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,members:t,showOrganizationCard:this.props.onShowOrganizationCard})}else{if(N)return i.createElement(u.GitHubCard,{identity:e});if(C)return i.createElement(d.DefaultAbridgedCard,{identity:e});if(b)return i.createElement(c.DefaultSimpleCard,{identity:e});if(g)return i.createElement(h.ServicePrincipalCard,{identity:e});if(E||x)switch(this.props.dataProps.cardType){case 1:return i.createElement(o.ContactCard,{identity:e});case 2:return i.createElement(y.OrganizationCard,{identity:e,managerList:a,directReportList:r,onClickEntity:this.props.onClickEntity});default:const t=a&&a.length>0?a[a.length-1]:void 0;return i.createElement(l.DefaultCard,{identity:e,manager:t,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity})}}return i.createElement("div",null)}}t[e].IdentityCardContent=a}("ComponentsIdentityCardIdentityCardContent"),function(e){E=t[e]={};class a extends i.Component{constructor(e){super(e),this.calloutRef=i.createRef(),this.onDismissCallback=()=>{this.props.onDismissCallback&&this.props.onDismissCallback()},this.headerOnClickHandler=()=>{this.state.dataState.previousDataState?this.setState({dataState:this.state.dataState.previousDataState,working:!1}):this.props.initialHeader&&this.props.initialHeader.onClickFunction&&this.props.initialHeader.onClickFunction()},this.onShowContactCard=()=>{const e=Object.assign(Object.assign({},this.state.dataState),{previousDataState:this.state.dataState,cardType:1,header:this.state.dataState.identity});this.setState({dataState:e})},this.onShowOrganizationCard=()=>{if(this.state.working||this.dismissed)return;const e=this.state.dataState;if(e.isGroup){const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t}),(!e.successors||e.successors.length<=1)&&(this.setState({working:!0}),this.resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity)))}else if(e.managerList&&e.managerList.length<=1){const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!0}),this.resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity,!0))}else{const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!1})}},this.onClickEntity=e=>{if(this.state.working)return;const t=this.state.dataState,i={identity:e,cardType:0,header:t.identity,isGroup:f.isGroup(t.identity),directReportList:[],managerList:[],previousDataState:t,displayName:e.displayName,imageUrl:e.image,email:e.mail};this.setState({dataState:i,working:!0}),this.getIdentityByUniqueAttribute(e)},this.updateConnections=(e,t)=>{this.dismissed||this.state.dataState&&e.identity===this.state.dataState.identity&&this.setState({dataState:Object.assign(Object.assign({},this.state.dataState),{managerList:t.managers&&t.managers.reverse(),directReportList:t.directReports,successors:t.successors}),working:!1})},this.updateEntity=e=>{if(!e)return void this.setState({working:!1});if(!f.isCompleteIdentity(e,!0))return void this.setState({working:!1,showUnknownUser:!0});const t=f.isGroup(e)&&(!this.state.dataState.successors||this.state.dataState.successors.length<=0)||f.isAadUser(e)||f.isAdUser(e),i=this.props.imageUrl?this.props.imageUrl:e.image,a=Object.assign(Object.assign({},this.state.dataState),{identity:e,displayName:e.displayName,imageUrl:i,isGroup:f.isGroup(e)});t?(this.setState({dataState:a,working:!1}),this.resolveIdentity(a,this.props.onRequestConnectionInformation(a.identity))):this.setState({dataState:a,working:!1})};const t={identity:e.identity,managerList:void 0,directReportList:void 0,previousDataState:void 0,cardType:0,header:e.initialHeader?e.initialHeader.identity:void 0,displayName:e.displayName,imageUrl:e.imageUrl,email:this.getEmail(),isGroup:f.isGroup(e.identity)};let a=!0;e.identity||e.uniqueAttribute||!e.displayName||(t.identity={entityId:"",entityType:"user",originDirectory:"vsd",originId:"",displayName:e.displayName,image:e.imageUrl,signInAddress:t.email},a=!1),this.state={dataState:t,showUnknownUser:!1,working:a}}componentDidMount(){this.state.working&&this.setupInitialData(this.props.uniqueAttribute)}componentDidUpdate(){this.calloutRef.current&&!this.state.working&&this.calloutRef.current.updateLayout()}componentWillUnmount(){this.dismissed=!0}render(){return this.props.uniqueAttribute||this.props.identity||this.props.displayName?i.createElement(b.IdentityCardContent,Object.assign({},this.props,{dataProps:this.state.dataState,onClickEntity:this.onClickEntity,onDismissCallback:this.onDismissCallback,onShowContactCard:this.onShowContactCard,onShowOrganizationCard:this.onShowOrganizationCard,working:this.state.working,onHeaderClick:this.headerOnClickHandler,calloutRef:this.calloutRef,showUnknownUser:this.state.showUnknownUser})):null}setupInitialData(e){const t=this.state.dataState;!t.identity&&e?this.getIdentityByUniqueAttribute(e):t.identity&&!f.isCompleteIdentity(t.identity)?this.getIdentityByUniqueAttribute(t.identity):f.isGroup(t.identity)&&t.successors&&t.successors.length>0?this.resolveIdentity(t,{successors:t.successors}):this.resolveIdentity(t,this.props.onRequestConnectionInformation(t.identity))}resolveIdentity(e,t){const i=t,a=t;a&&a.then?a.then((t=>{this.updateConnections(e,t)})):i&&this.updateConnections(e,i)}resolveIEntity(e){const t=e,i=e;i&&i.then?i.then((e=>{this.updateEntity(e)})):this.updateEntity(t)}getIdentityByUniqueAttribute(e){let t;t="string"==typeof e?e:f.isGroup(e)||f.isAadUser(e)||f.isAdUser(e)?e.entityId:e.signInAddress?e.signInAddress:"",this.resolveIEntity(this.props.getEntityFromUniqueAttribute(t))}getEmail(){if(this.props.identity){if((f.isAadUser(this.props.identity)||f.isAdUser(this.props.identity))&&this.props.identity.mail)return this.props.identity.mail;if(this.props.identity&&this.props.identity.signInAddress)return this.props.identity.signInAddress;if(this.props.identity&&this.props.identity.mail)return this.props.identity.mail;if(this.props.uniqueAttribute){const e=this.props.uniqueAttribute.split("@");if(2===e.length&&e[0].length>=1&&e[1].length>=3){if(e[1].split(".").length>1)return this.props.uniqueAttribute}}}return""}}t[e].IdentityCard=a}("ComponentsIdentityCardIdentityCard"),t.Persona={},Object.defineProperty(t.Persona,"Persona",{enumerable:!0,get:function(){return r.Persona}}),t.IdentityCard={},Object.defineProperty(t.IdentityCard,"IdentityCard",{enumerable:!0,get:function(){return E.IdentityCard}})}),["Resources.Persona","Components/Persona/Persona","Components/IdentityCard/CardContactLine","Components/IdentityCard/ContactCard","Components/IdentityCard/DefaultAbridgedCard","Components/IdentityCard/DefaultCard","Components/IdentityCard/DefaultSimpleCard","Components/IdentityCard/GroupMembersCard","Components/IdentityCard/GroupCard","Components/IdentityCard/GitHubCard","Components/IdentityCard/OrganizationCard","Components/IdentityCard/ServicePrincipalCard","Components/IdentityCard/IdentityCardHeaderElement","Components/IdentityCard/IdentityCardIdentityUtils","Components/IdentityCard/IdentityCardContent","Components/IdentityCard/IdentityCard","Persona","IdentityCard"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-persona-content"}}));