"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Promise","VSS/Core/Util/String","VSS/Core/TimerManagement"],(function(e,t,s,i,n,o,r){var a,l,d,u,c,p,h,g,m;a=t[m="ResourcesIdentityPicker"]={},t[m].Loading="Loading...",t[m].MultiIdentityPickerPlaceholderText="Add people",t[m].IdentityPickerLoadingText="Loading identities...",t[m].IdentityPickerResultsFoundText="Showing {0} results",t[m].IdentityPickerPlaceholderText="No one selected",t[m].IdentityPickerPlaceholderFocusText="Assign people",t[m].IdentityPickerNoResultsText="No identities found",t[m].IdentityPickerContact="Contact",t[m].IdentityPickerStartChat="Start chat",t[m].IdentityPickerOrganization="Organization",t[m].IdentityPickerReportingTo="Reporting to {0} ({1})",t[m].IdentityPickerReportsTo="Reports to",t[m].IdentityPickerProfileCardAriaLabel="Contact card",t[m].IdentityPickerProfileCardButtonTooltip="Show Contact Card",t[m].IdentityPickerHeaderButtonLabel="Go back",t[m].IdentityPickerContactInfo="Contact information",t[m].IdentityPickerEmail="Email",t[m].IdentityPickerPhoneNumber="Phone number",t[m].IdentityPickerLocation="Location",t[m].IdentityPickerTitle="Title",t[m].IdentityPickerDepartment="Department",t[m].IdentityPickerAlias="Alias",t[m].Clear="Clear",t[m].Remove="Remove {0}",t[m].UnknownUserOrGroup="Unknown user or group: {0}",function(e){function s(e){return e&&e.entityType&&"user"===e.entityType.toLocaleLowerCase()}function i(e){return e&&e.entityType&&"group"===e.entityType.toLocaleLowerCase()}function n(e){return e&&e.entityType&&"github"===e.originDirectory.toLocaleLowerCase()}l=t[e]={},t[e].getScopedGroupParts=function(e){if(i(e)){const t=e.displayName;if(t&&"["===t[0]){const e=t.indexOf("]\\");if(e>0)return{name:t.substr(e+2),scope:t.substr(0,e+1)}}}},t[e].getSignInAddress=function(e){return e?n(e)?e.mailNickname:!e.isHosted&&e.samAccountName&&e.samAccountName.trim()?(e.scopeName&&e.scopeName.trim()?e.scopeName+"\\":"")+e.samAccountName:e.signInAddress&&e.signInAddress.trim()?e.signInAddress:e.mail&&e.mail.trim()?e.mail:e.mailNickname&&e.mailNickname.trim()?e.mailNickname:"":""},t[e].isUser=s,t[e].isGroup=i,t[e].isGithubUser=n,t[e].shouldShowIdentityCard=function(e){return e&&(s(e)||i(e)||n(e))}}("ComponentsIdentityPickerDropdownIdentityPickerUtils"),function(e){d=t[e]={};class i extends s.Component{constructor(){super(...arguments),this.contactCardButtonRef=s.createRef()}render(){const e=this.props.item;let i=(0,l.getSignInAddress)(e),n=e.displayName;const o=(0,l.getScopedGroupParts)(e);return o&&(n=o.name,i||(i=o.scope)),s.createElement("div",{className:"bolt-picker-suggesteditem flex-row flex-grow flex-center scroll-hidden"},this.props.renderSuggestion&&"custom"===e.entityType?this.props.renderSuggestion(this.props):s.createElement("div",{className:"bolt-picker-suggesteditem-text flex-row flex-grow flex-center text-ellipsis"},s.createElement(t.Persona.Persona,{ariaHidden:!0,className:"bolt-picker-persona text-ellipsis",identity:e,size:24}),s.createElement("div",{className:"bolt-picker-persona-name flex-column flex-grow"},n&&s.createElement(t.TooltipEx.Tooltip,{text:e.displayName,overflowOnly:e.displayName===n},s.createElement("div",{className:"fontSizeM text-ellipsis"},n)),i?s.createElement("div",{className:"flex-row"},(0,l.isGithubUser)(e)&&s.createElement(t.Icon.Icon,{className:"bolt-identitypicker-github-icon flex-row flex-center justify-center",iconName:"GitHubLogo"}),s.createElement("div",{className:"fontSize secondary-text text-ellipsis"},i)):void 0)),!!this.props.onOpenPersonaCard&&(0,l.shouldShowIdentityCard)(e)&&s.createElement(t.Button.Button,{ariaLabel:a.IdentityPickerProfileCardButtonTooltip,className:"bolt-contact-card-button flex-noshrink",iconProps:{iconName:"ContactCard",className:"flex-shrink"},onClick:t=>{this.props.onOpenPersonaCard&&this.props.onOpenPersonaCard(e),t.preventDefault()},onBlur:this.props.onBlur,onFocus:this.props.onFocus,ref:this.contactCardButtonRef,subtle:!0,tooltipProps:{text:a.IdentityPickerProfileCardButtonTooltip,showOnFocus:!0}}))}focus(){this.contactCardButtonRef.current&&this.contactCardButtonRef.current.focus()}}t[e].IdentityPickerSuggestionItem=i}("ComponentsIdentityPickerSuggestionsListIdentityPickerSuggestionItem"),function(e){u=t[e]={};class r extends s.Component{constructor(e){super(e),this.resolveEmailPromises=[],this.itemRefs={},this.tagPickerRef=s.createRef(),this.openedIdentityCard=new i.ObservableValue(void 0),this.outerElement=s.createRef(),this.lastSearchVal="",this.suggestions=new i.ObservableArray([]),this.suggestionsLoading=new i.ObservableValue(!1),this._isMounted=!1,this.areTagsEqual=(e,t)=>e.entityId===t.entityId,this.renderSuggestionItem=e=>s.createElement("div",{className:"flex-row flex-grow full-width",onKeyDown:this.onKeyDownSuggestionItem},s.createElement(d.IdentityPickerSuggestionItem,Object.assign({},e,{onOpenPersonaCard:this.onOpenPersonaCard,ref:t=>this.itemRefs[e.item.entityId]=t,renderSuggestion:this.props.renderCustomIdentitySuggestion&&this.renderCustomSuggestionItem}))),this.onKeyDownSuggestionItem=e=>{e.defaultPrevented||37!==e.which&&27!==e.which&&9!==e.which||this.tagPickerRef.current&&(this.tagPickerRef.current.focus(),e.preventDefault())},this.createDefaultItem=e=>({displayName:e,originDirectory:"email",originId:e,entityId:e,entityType:"custom"}),this.onOpenPersonaCard=e=>{(0,l.shouldShowIdentityCard)(e)&&(this.openedIdentityCard.value=e)},this.onClosePersonaCard=()=>{this.openedIdentityCard.value=void 0,this.tagPickerRef.current.focus()},this.shouldBlurClear=()=>void 0===this.openedIdentityCard.value,this.onEmptyInputFocus=()=>{this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus())},this.focusContactCardButton=e=>{this.itemRefs[e.entityId]&&this.itemRefs[e.entityId].focus()},this.onAddIdentity=async e=>{if(this.setStateSafe({error:""}),this.props.pickerProvider.addIdentitiesToMRU)try{await this.props.pickerProvider.addIdentitiesToMRU([e]),this.props.onIdentityAdded(e)}catch(t){this.setStateSafe({error:t.message}),this.props.onIdentityRemoved(e)}else this.props.onIdentityAdded(e)},this.onDelimitedSearch=e=>{e.map((e=>e.trim())).forEach((e=>{this.updateResolvedEmail(this.props.pickerProvider.onFilterIdentities(e),e),this.props.onIdentityAdded(this.createDefaultItem(e))})),this.tagPickerRef.current&&this.tagPickerRef.current.clearTagPicker()},this.renderCustomSuggestionItem=e=>this.props.renderCustomIdentitySuggestion&&this.props.renderCustomIdentitySuggestion(e.item),this.convertItemToPill=(e,i)=>{const n="email"===e.originDirectory;return this.props.convertItemToPill&&"custom"===e.entityType?this.props.convertItemToPill(e,i):{className:"bolt-identity-picker-pill flex-row",content:n?s.createElement(t.TooltipEx.Tooltip,{text:(0,o.format)(a.UnknownUserOrGroup,e.displayName)},s.createElement("div",{className:"bolt-identity-picker-unresolved-email"},e.displayName)):e.displayName||e.mailNickname,onRenderFilledVisual:n?void 0:()=>s.createElement(t.Persona.Persona,{ariaLabel:"",className:"flex-row flex-center",identity:e,size:20})}},this.onResolveSuggestions=e=>{this.setStateSafe({error:""}),this.lastSearchVal=e;const t=this.props.pickerProvider.onFilterIdentities(e,i.ObservableLike.getValue(this.props.selectedIdentities));null!==t&&(this.cachedResults[e]?this.suggestions.value=this.cachedResults[e].filter((e=>!i.ObservableLike.getValue(this.props.selectedIdentities).some((t=>t.entityId===e.entityId)))):this.updateSuggestionsList(t,e))},this.setStateSafe=e=>{this._isMounted&&this.setState(e)},this.cachedResults={},this.state={error:""}}render(){return s.createElement("div",{className:this.props.className,ref:this.outerElement},s.createElement(t.Observer.Observer,{openedIdentityCard:this.openedIdentityCard},(e=>s.createElement(s.Fragment,null,s.createElement(t.TagPicker.TagPicker,{ariaLabel:this.props.ariaLabel,ariaLabelledBy:this.props.ariaLabelledBy,suggestionsLoading:this.suggestionsLoading,areTagsEqual:this.areTagsEqual,convertItemToPill:this.convertItemToPill,deliminator:this.props.onResolveEntity&&";",noResultsFoundText:a.IdentityPickerNoResultsText,onBlur:this.props.onBlur,onDelimitedSearch:this.props.onResolveEntity&&this.onDelimitedSearch,onEmptyInputFocus:this.onEmptyInputFocus,onSearchChanged:this.onResolveSuggestions,onSuggestionExpanded:this.focusContactCardButton,onTagAdded:this.onAddIdentity,onTagRemoved:this.props.onIdentityRemoved,onTagsRemoved:this.props.onIdentitiesRemoved,placeholderText:this.props.placeholderText||a.MultiIdentityPickerPlaceholderText,prefixIconProps:{className:"bolt-identity-picker-contact-icon secondary-text justify-center flex-center",iconName:"Contact",size:"medium"},ref:this.tagPickerRef,renderSuggestionItem:this.renderSuggestionItem,shouldBlurClear:this.shouldBlurClear,selectedTags:this.props.selectedIdentities,suggestions:this.suggestions,suggestionsLoadingText:a.Loading}),e.openedIdentityCard&&s.createElement(t.IdentityCard.IdentityCard,{getEntityFromUniqueAttribute:this.props.pickerProvider.getEntityFromUniqueAttribute,key:e.openedIdentityCard.entityId,identity:e.openedIdentityCard,displayName:e.openedIdentityCard.displayName,target:this.outerElement.current,onDismissCallback:this.onClosePersonaCard,onRequestConnectionInformation:this.props.pickerProvider.onRequestConnectionInformation}),s.createElement("div",{className:"bolt-identity-picker-error"},this.state.error)))))}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1,this.currentPromise&&this.currentPromise.cancel();for(const e of this.resolveEmailPromises)e.cancel()}updateResolvedEmail(e,t){const s=e,o=e;if(Array.isArray(s))this.props.onResolveEntity&&1===s.length&&this.props.onResolveEntity(t,i.ObservableLike.getValue(this.props.selectedIdentities).some((e=>e.entityId===s[0].entityId))?null:s[0]);else if(o&&o.then){(this.currentPromise=(0,n.makeCancelable)(o)).promise.then((e=>{this.props.onResolveEntity&&1===e.length&&this.props.onResolveEntity(t,i.ObservableLike.getValue(this.props.selectedIdentities).some((t=>t.entityId===e[0].entityId))?null:e[0])}))}}updateSuggestionsList(e,t){const s=e,o=e;if(Array.isArray(s))this.suggestions.value=s.filter((e=>!i.ObservableLike.getValue(this.props.selectedIdentities).some((t=>t.entityId===e.entityId))));else if(o&&o.then){this.suggestionsLoading.value=!0;const e=this.currentPromise=(0,n.makeCancelable)(o);this.resolveEmailPromises.push(e),e.promise.then((s=>{this.resolveEmailPromises=this.resolveEmailPromises.filter((t=>t!==e)),e===this.currentPromise&&(t&&this.lastSearchVal!==t||(this.suggestions.value=s.filter((e=>!i.ObservableLike.getValue(this.props.selectedIdentities).some((t=>t.entityId===e.entityId))))),t&&""!==t&&this.suggestions.value&&this.suggestions.value.length>0&&(this.cachedResults[t]=s),this.suggestionsLoading.value=!1)}),(()=>{this.resolveEmailPromises=this.resolveEmailPromises.filter((t=>t!==e))}))}}}t[e].IdentityPicker=r,r.area="IdentityPicker",r.feature="MRU"}("ComponentsIdentityPickerIdentityPicker"),function(e){c=t[e]={};class i extends s.Component{constructor(){super(...arguments),this.renderNoIdentitiesFound=()=>s.createElement("div",{className:"bolt-identitypickerdropdown-noresults flex-row flex-grow flex-center"},this.props.noResultsFoundText||a.IdentityPickerNoResultsText)}render(){return s.createElement(s.Fragment,null,s.createElement(t.Observer.Observer,{suggestionsVisible:this.props.suggestionsVisible,suggestionsLoading:this.props.isLoading,selectedIndex:this.props.selectedIndex,suggestions:this.props.suggestions},(e=>e.suggestionsVisible?s.createElement(t.Callout.Callout,Object.assign({},this.props.calloutProps,{className:(0,t.Util.css)("bolt-identitypickerdropdown-callout",this.props.calloutProps.className),contentClassName:(0,t.Util.css)("bolt-identitypickerdropdown-callout-content flex-row flex-grow",this.props.calloutProps.contentClassName)}),s.createElement(t.SuggestionsList.SuggestionsList,Object.assign({},this.props,{className:(0,t.Util.css)("bolt-identitypickerdropdown-list",this.props.className),isLoading:e.suggestionsLoading,loadingText:this.props.loadingText||a.IdentityPickerLoadingText,renderNoResultFound:this.renderNoIdentitiesFound,renderSuggestion:this.props.renderSuggestion,onBlur:this.props.onBlur,onFocus:this.props.onFocus,resultsMaximumNumber:25,suggestionsItemClassName:(0,t.Util.css)("bolt-identitypickerdropdown-item",this.props.suggestionsItemClassName),suggestions:e.suggestions,selectedIndex:e.selectedIndex,width:this.props.width}))):s.createElement("div",null))),s.createElement(t.Observer.Observer,{openedIdentityCard:this.props.openedIdentityCard},(e=>e.openedIdentityCard?s.createElement(t.IdentityCard.IdentityCard,{getEntityFromUniqueAttribute:this.props.pickerProvider.getEntityFromUniqueAttribute,key:e.openedIdentityCard.entityId,identity:e.openedIdentityCard,target:this.props.suggestionTarget,onDismissCallback:this.props.onClosePersonaCard,onRequestConnectionInformation:this.props.pickerProvider.onRequestConnectionInformation}):s.createElement("div",null))))}}t[e].IdentityPickerSuggestionsList=i}("ComponentsIdentityPickerSuggestionsListIdentityPickerSuggestionsList"),function(e){p=t[e]={};let u=1;class h extends s.Component{constructor(e){super(e),this.focusWithin=s.createRef(),this.inputElement=s.createRef(),this.itemRefs={},this.openedIdentityCard=new i.ObservableValue(void 0),this.outerElement=s.createRef(),this.suggestionsLoading=new i.ObservableValue(!1),this.isEditing=new i.ObservableValue(!1),this.selectedIndex=new i.ObservableValue(-1),this.suggestions=new i.ObservableArray([]),this.textFieldId="identity-picker-downdown-textfield-"+u++,this.onPickerDismiss=()=>{this.props.onSuggestionsVisibleChanged(!1)},this.renderSuggestionItem=e=>s.createElement("div",{className:"flex-row flex-grow scroll-hidden",onKeyDown:this.onKeyDownSuggestionItem},s.createElement(d.IdentityPickerSuggestionItem,Object.assign({},e,{onOpenPersonaCard:this.openPersonaCard,ref:t=>this.itemRefs[e.item.entityId]=t,renderSuggestion:this.props.renderCustomIdentitySuggestion&&this.renderCustomSuggestionItem}))),this.renderCustomSuggestionItem=e=>this.props.renderCustomIdentitySuggestion&&this.props.renderCustomIdentitySuggestion(e.item),this.renderPersonaCoin=e=>s.createElement(t.Observer.Observer,{selectedIdentity:this.props.value,isEditing:this.isEditing},(i=>i.selectedIdentity&&!i.isEditing?s.createElement(t.Persona.Persona,{className:(0,t.Util.css)("flex-row flex-center justify-center",e),identity:i.selectedIdentity,size:24}):s.createElement(t.Icon.Icon,{className:(0,t.Util.css)("flex-row flex-center justify-center",e),iconName:"Contact",size:"medium"}))),this.openPersonaCard=e=>{(0,l.shouldShowIdentityCard)(e)&&(this.openedIdentityCard.value=e)},this.closePersonaCard=()=>{if(this.openedIdentityCard.value=void 0,this.inputElement.current){this.inputElement.current.focus();i.ObservableLike.getValue(this.props.suggestionsVisible)||this.props.onSuggestionsVisibleChanged(!0)}},this.completeSuggestion=()=>{let e;return this.suggestions.value.length>0&&i.ObservableLike.getValue(this.props.suggestionsVisible)&&-1!==this.selectedIndex.value?e=this.suggestions.value[this.selectedIndex.value]:(this.selectedIndex.value=-1,e=this.props.resolveUnrecognizedIdentity&&this.props.resolveUnrecognizedIdentity(i.ObservableLike.getValue(this.props.textValue))),this.selectedPersonaChanged(e),e&&this.props.onSuggestionsVisibleChanged(!1),Boolean(e)},this.onBlur=()=>{this.props.onSuggestionsVisibleChanged(!1),this.openedIdentityCard.value||(""===i.ObservableLike.getValue(this.props.textValue)&&this.selectedPersonaChanged(),this.props.onBlur&&this.props.onBlur())},this.onClearClicked=e=>{this.clear(),e.preventDefault()},this.onClearKeyDown=e=>{13===e.which&&(this.clear(),e.preventDefault())},this.clear=()=>{var e;this.props.onClear&&this.props.onClear(),this.props.onChange(void 0),this.lastPickedIdentity=void 0,this.suggestions.value=[],null===(e=this.inputElement.current)||void 0===e||e.focus()},this.onClick=()=>{""===i.ObservableLike.getValue(this.props.textValue)&&this.props.pickerProvider.onEmptyInputFocus||i.ObservableLike.getValue(this.props.value)&&0===this.suggestions.length?(this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),this.props.onSuggestionsVisibleChanged(!i.ObservableLike.getValue(this.props.suggestionsVisible))):this.props.onSuggestionsVisibleChanged(!i.ObservableLike.getValue(this.props.suggestionsVisible)),this.inputElement.current.select()},this.onFocus=e=>{const{onFocus:t}=this.props;""===i.ObservableLike.getValue(this.props.textValue)&&this.props.pickerProvider.onEmptyInputFocus&&!i.ObservableLike.getValue(this.props.suggestionsVisible)&&this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),t&&t(e)},this.onKeyDown=e=>{if(e.isDefaultPrevented())return;const t=e.which,s=i.ObservableLike.getValue(this.props.suggestionsVisible),n=this.inputElement.current&&this.inputElement.current.inputElement.current;switch(t){case 27:this.openedIdentityCard.value&&(!this.suggestions.value||!this.suggestions.value[this.selectedIndex.value])&&this.selectedPersonaChanged(),s&&(this.props.onSuggestionsVisibleChanged(!1),this.openedIdentityCard.value=void 0);break;case 9:case 13:!e.shiftKey&&s?this.completeSuggestion()&&(e.preventDefault(),e.stopPropagation()):s?this.completeSuggestion():13===t&&n&&!n.value&&this.selectedPersonaChanged(void 0);break;case 39:this.suggestions.value&&this.suggestions.value[this.selectedIndex.value]&&n&&n.value.length===n.selectionEnd&&(this.focusContactCardButton(this.suggestions.value[this.selectedIndex.value]),e.preventDefault());break;case 38:s&&this.suggestions.value&&(this.selectedIndex.value=Math.max(0,this.selectedIndex.value-1),this.forceUpdate(),e.preventDefault(),e.stopPropagation());break;case 40:s&&this.suggestions.value?(this.selectedIndex.value=Math.min(this.suggestions.value.length-1,this.selectedIndex.value+1),this.forceUpdate(),e.preventDefault(),e.stopPropagation()):this.props.onSuggestionsVisibleChanged(!0)}},this.onKeyDownSuggestionItem=e=>{e.defaultPrevented||37!==e.which&&27!==e.which&&9!==e.which||this.inputElement.current&&(this.inputElement.current.focus(),e.preventDefault())},this.focusContactCardButton=e=>{this.itemRefs[e.entityId]&&this.itemRefs[e.entityId].focus()},this.onResolveSuggestions=e=>{const t=this.props.pickerProvider.onFilterIdentities(e.toLocaleLowerCase(),[]);null!==t&&this.updateSuggestionsList(t,e)},this.onSearchChange=(e,t)=>{if(0==t.length){const{onClear:e}=this.props;e&&e()}this.selectedIndex.value=-1,this.isEditing.value=!0,this.props.onInputChange(t),this.updateValue(t)},this.onSuggestionClick=e=>{this.selectedIndex.value=e.index,this.selectedPersonaChanged(e.item),this.props.onSuggestionsVisibleChanged(!1)},this.onTextFieldChanged=(e,t)=>{this.setState({width:Math.max(e,296)})},this.selectedPersonaChanged=e=>{this.lastPickedIdentity!==e&&e&&this.props.pickerProvider.addIdentitiesToMRU&&this.props.pickerProvider.addIdentitiesToMRU([e]),!1!==this.props.onChange(e)?(this.props.onInputChange(e?e.displayName:""),this.lastPickedIdentity=e):(this.props.onInputChange(""),this.props.onChange(void 0),this.lastPickedIdentity=void 0),this.isEditing.value=!1},this.updateValue=e=>{this.props.onSuggestionsVisibleChanged(!!e),this.cachedResults[e]?this.updateSuggestionsList(this.cachedResults[e],e):this.onResolveSuggestions(e)},this.cachedResults={},this.timerManagement=new r.TimerManagement,this.lastPickedIdentity=i.ObservableLike.getValue(e.value),this.state={width:296}}render(){const{ariaLabel:e,ariaLabelledBy:i,autoFocus:n,disabled:r,editPlaceholder:l=a.IdentityPickerPlaceholderFocusText,placeholder:d=a.IdentityPickerPlaceholderText,required:u}=this.props;return s.createElement(t.Observer.Observer,{suggestionsVisible:this.props.suggestionsVisible},(p=>s.createElement(t.FocusWithin.FocusWithin,{onBlur:this.onBlur,onFocus:this.onFocus,ref:this.focusWithin},(h=>s.createElement(s.Fragment,null,s.createElement(t.Observer.Observer,{selectedIdentity:this.props.value,selectedIndex:this.selectedIndex,suggestionsLoading:this.suggestionsLoading,textValue:this.props.textValue},(c=>{var g;let m;p.suggestionsVisible&&(m=-1===c.selectedIndex||c.suggestionsLoading?"sug-list-transition":this.suggestions&&this.suggestions.length?`sug-row-${c.selectedIndex}`:"sug-list-no-results");const y=p.suggestionsVisible?"tag-picker-callout":void 0,I=h.hasFocus||c.selectedIdentity?l:d;return s.createElement(t.Measure.Measure,{onMeasure:this.onTextFieldChanged},s.createElement("div",{className:"bolt-identitypickerdropdown flex-row flex-grow",ref:this.outerElement,onKeyDown:this.onKeyDown},s.createElement(t.TextField.TextField,{ariaExpanded:p.suggestionsVisible,ariaActiveDescendant:m,ariaAutoComplete:"list",ariaControls:y,autoFocus:n,ariaHasPopup:"listbox",ariaLabel:e||(""===c.textValue?I:c.textValue),ariaLabelledBy:i,className:(0,t.Util.css)(this.props.className,"bolt-identitypickerdropdown-textField flex-row flex-center",h.hasFocus&&"bolt-identitypickerdropdown-open"),containerClassName:"bolt-identitypickerdropdown-container flex-column flex-grow",inputId:null!==(g=this.props.inputId)&&void 0!==g?g:this.textFieldId,onBlur:h.onBlur,onChange:this.onSearchChange,onClick:this.onClick,onFocus:h.onFocus,prefixIconProps:{render:this.renderPersonaCoin},placeholder:I,ref:this.inputElement,required:u,role:"combobox",suffixIconProps:c.textValue&&!r?{ariaHidden:"false",iconName:"Clear",className:"bolt-identity-picker-clearButton fontSize",role:"button",ariaLabel:(0,o.format)(a.Remove,c.textValue),onClick:this.onClearClicked,onKeyDown:this.onClearKeyDown,tabIndex:0}:void 0,value:c.textValue,disabled:r})))})),s.createElement(t.Observer.Observer,{openedIdentityCard:this.openedIdentityCard,selectedIndex:this.selectedIndex},(e=>s.createElement(c.IdentityPickerSuggestionsList,{calloutProps:{anchorElement:this.outerElement.current,anchorOrigin:{horizontal:"start",vertical:"end"},calloutOrigin:{horizontal:"start",vertical:"start"},contentShadow:!0,id:"tag-picker-callout",onDismiss:this.onPickerDismiss,role:"presentation"},suggestionsVisible:p.suggestionsVisible||!!e.openedIdentityCard,isLoading:this.suggestionsLoading,onBlur:h.onBlur,onFocus:h.onFocus,onSuggestionClicked:this.onSuggestionClick,onClosePersonaCard:this.closePersonaCard,onDismiss:this.onPickerDismiss,onOpenPersonaCard:this.openPersonaCard,openedIdentityCard:e.openedIdentityCard,pickerProvider:this.props.pickerProvider,renderSuggestion:this.renderSuggestionItem,suggestions:this.suggestions,suggestionTarget:this.outerElement.current,selectedIndex:e.selectedIndex,width:this.state.width}))))))))}componentDidMount(){if(this.updateValue=this.timerManagement.debounce(this.updateValue,250),this.props.autoFocus){i.ObservableLike.getValue(this.props.textValue);this.props.pickerProvider.onEmptyInputFocus,this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),this.inputElement.current&&this.inputElement.current.select(),this.props.onSuggestionsVisibleChanged(!0)}this.setState({width:this.outerElement.current.clientWidth})}componentWillUnmount(){this.currentPromise&&this.currentPromise.cancel()}updateSuggestionsList(e,t){const s=e,i=e;if(Array.isArray(s))this.updateSuggestions(s,t);else if(i&&i.then){this.suggestionsLoading.value=!0;const e=this.currentPromise=(0,n.makeCancelable)(i);e.promise.then((s=>{e===this.currentPromise&&(this.updateSuggestions(s,t),t&&""!==t&&this.suggestions.value&&this.suggestions.value.length>0&&(this.cachedResults[t]=s),this.suggestionsLoading.value=!1)}))}}setSuggestions(e,t){this.suggestions.value=e,this.updateIndexTimer&&window.cancelAnimationFrame(this.updateIndexTimer),this.updateIndexTimer=window.requestAnimationFrame((()=>{this.selectedIndex.value=t}))}updateSuggestions(e,t){(void 0===t||this.inputElement.current&&i.ObservableLike.getValue(this.props.textValue)===t)&&this.setSuggestions(e,""===i.ObservableLike.getValue(this.props.textValue)?-1:0)}}t[e].CustomIdentityPickerDropdown=h}("ComponentsIdentityPickerDropdownCustomIdentityPickerDropdown"),function(e){h=t[e]={};function n(e){return e&&i.ObservableLike.getValue(e)?i.ObservableLike.getValue(e).displayName:""}t[e].IdentityPickerDropdown=e=>{const[o,r]=(0,i.useObservable)(n(e.value)),[a,l]=(0,i.useObservable)(!1),{onChange:d}=e,u=t=>{e.onSuggestionsVisibleChanged&&e.onSuggestionsVisibleChanged(t),l(t)},c=e=>!1!==d(e)?(r(e?e.displayName||e.mailNickname:""),!0):(r(""),!1);return i.ObservableLike.isObservable(e.value)||s.useEffect((()=>{r(e.value&&i.ObservableLike.getValue(e.value)&&i.ObservableLike.getValue(e.value).displayName||"")}),[e.value]),s.createElement(t.Observer.Observer,{value:{observableValue:e.value,filter:()=>(r(n(e.value)),!1)}},(()=>s.createElement(p.CustomIdentityPickerDropdown,Object.assign({},e,{suggestionsVisible:a,onChange:c,onInputChange:r,onSuggestionsVisibleChanged:u,textValue:o}))))}}("ComponentsIdentityPickerDropdownIdentityPickerDropdown"),function(e){g=t[e]={};class n extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.selectedUser=new i.ObservableValue(void 0),this.selectedUserFriendlyName=new i.ObservableValue(""),this.areSuggestionsVisible=new i.ObservableValue(!1),this.onFilterChanged=e=>{super.onFilterChanged(e),e&&e.value||(this.selectedUser.value=void 0,this.setTextValue(""))},this.onSuggestionsVisibleChanged=e=>{this.areSuggestionsVisible.value=e},this.onIdentityChanged=e=>{this.selectedUser.value=e,this.setFilterValue({value:this.selectedUser.value}),this.setTextValue(e&&e.displayName||"")},this.setTextValue=e=>{this.selectedUserFriendlyName.value=e},e.initialValue&&(i.ObservableLike.isObservable(e.initialValue)?this.selectedUser=e.initialValue:this.selectedUser.value=e.initialValue,this.selectedUserFriendlyName.value=this.selectedUser.value&&this.selectedUser.value.displayName||""),e.initialTextValue&&(i.ObservableLike.isObservable(e.initialTextValue)?this.selectedUserFriendlyName=e.initialTextValue:this.selectedUserFriendlyName.value=e.initialTextValue)}focus(){return!1}render(){return s.createElement(p.CustomIdentityPickerDropdown,{className:(0,t.Util.css)(this.props.className,"bolt-identitypicker-filterbaritem"),pickerProvider:this.props.pickerProvider,onChange:this.onIdentityChanged,placeholder:this.props.placeholder,editPlaceholder:this.props.editPlaceholder,value:this.selectedUser,textValue:this.selectedUserFriendlyName,resolveUnrecognizedIdentity:this.props.resolveUnrecognizedIdentity,suggestionsVisible:this.areSuggestionsVisible,onSuggestionsVisibleChanged:this.onSuggestionsVisibleChanged,onInputChange:this.setTextValue})}}t[e].IdentityPickerDropdownFilterBarItem=n}("ComponentsIdentityPickerDropdownIdentityPickerDropdownFilterBarItem"),t.IdentityPicker={},__exportStar(u,t.IdentityPicker),__exportStar(p,t.IdentityPicker),__exportStar(h,t.IdentityPicker),__exportStar(g,t.IdentityPicker),__exportStar(l,t.IdentityPicker)}),["Resources.IdentityPicker","Components/IdentityPickerDropdown/IdentityPickerUtils","Components/IdentityPickerSuggestionsList/IdentityPickerSuggestionItem","Components/IdentityPicker/IdentityPicker","Components/IdentityPickerSuggestionsList/IdentityPickerSuggestionsList","Components/IdentityPickerDropdown/CustomIdentityPickerDropdown","Components/IdentityPickerDropdown/IdentityPickerDropdown","Components/IdentityPickerDropdown/IdentityPickerDropdownFilterBarItem","IdentityPicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-identity-picker-content"}}));