"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Accessibility","VSS/Core/Util/String","VSS/Core/TimerManagement"],(function(e,t,i,o,s,n,r){var a,l,c,d,h,u,p,m,b,f,v,g,x,w,I,C,E,D,y,S,M,P,L,k,O,T,R,z,N,F,B,U,A,j,H,K,W,V,G,Z,_,X,q;a=t.ResourcesWidgets={},t.ResourcesWidgets.AllRowsSelectedMessage="All rows got selected",t.ResourcesWidgets.AllRowsUnselectedMessage="All rows got unselected",t.ResourcesWidgets.ClickableRowAnnouncement="Row {0}. Clickable",t.ResourcesWidgets.ClickableRowAnnouncementWithSize="Row {0} of {1}. Clickable",t.ResourcesWidgets.ColumnSizerLabel="{0} column sizer",t.ResourcesWidgets.ColumnSortedAscendingAnnouncement="Column sorted ascending",t.ResourcesWidgets.ColumnSortedDescendingAnnouncement="Column sorted descending",t.ResourcesWidgets.EmptyColumnHeaderLabel="Blank",t.ResourcesWidgets.ListItem="listitem",t.ResourcesWidgets.MoreActions="More actions",t.ResourcesWidgets.MoreTooltip="More options",t.ResourcesWidgets.NoMoreActions="No actions",t.ResourcesWidgets.RowAnnouncement="Row {0}",t.ResourcesWidgets.RowAnnouncementWithSize="Row {0} of {1}",t.ResourcesWidgets.RemovePillLabel="Remove {0}",t.ResourcesWidgets.SelectAllRowsLabel="Select all rows",t.ResourcesWidgets.SelectRowLabel="Select row",t.ResourcesWidgets.SelectionColumnLabel="Selection column",t.ResourcesWidgets.ShowLess="Show less",t.ResourcesWidgets.ShowMore="Show more",t.ResourcesWidgets.Started="Started {0}",t.ResourcesWidgets.SizerValueChanged="New size value {0}",t.ResourcesWidgets.SizerLabel="Current value {0}, minimum value {1}, maximum value {2}",t.ResourcesWidgets.VirtualizationDisabled="Virtualization disabled",t.ResourcesWidgets.VirtualizedListLabelFormat="{0}. Use ctrl + alt + v to disable list virtualization",function(e){l=t[e]={};class o extends i.Component{constructor(e){super(e),this.timerId=0,this.state={output:""}}static getDerivedStateFromProps(e){return{output:e.getTimeString()}}render(){const e={"aria-hidden":this.props.ariaHidden,className:(0,t.Util.css)(this.props.className,"bolt-time-item white-space-nowrap")};let o="span";this.props.dateTime&&(o="time",e.dateTime=this.props.dateTime.toISOString());const s=this.props.ariaLabel?`${this.state.output} ${this.props.ariaLabel||""}`:void 0;let n=i.createElement("span",{className:"text-ellipsis","aria-label":s,tabIndex:this.props.tabIndex},i.createElement(o,Object.assign({},e),this.state.output));return this.props.tooltipProps&&(n=i.createElement(t.TooltipEx.Tooltip,Object.assign({},this.props.tooltipProps),n)),n}componentDidUpdate(e){this.cancelNextRefresh(),this.setNextRefresh()}componentDidMount(){this.setNextRefresh()}componentWillUnmount(){this.cancelNextRefresh()}cancelNextRefresh(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=0)}setNextRefresh(){const e=this.props.getNextInterval();-1!==e&&(this.timerId=window.setTimeout((()=>{this.setState({output:this.props.getTimeString()})}),e))}}t[e].Time=o}("ComponentsTimeTimeTime"),function(e){c=t[e]={};class o extends i.Component{constructor(e){super(e),this.getTimeString=()=>{var e;return t.UtilitiesDate.ago(this.props.date,this.props.format,null!==(e=this.props.currentDate)&&void 0!==e?e:new Date,this.props.locale)},this.getNextInterval=()=>o.agoNextInterval(this.props.date,this.props.format),this.state={tooltipProps:{}}}static getDerivedStateFromProps(e){return{tooltipProps:void 0===e.tooltipProps?{renderContent:function(){return t.UtilitiesDate.tooltipString(e.date,void 0,e.tooltipTimeFormat)}}:e.tooltipProps}}render(){return i.createElement(l.Time,{ariaLabel:this.props.ariaLabel?this.props.ariaLabel:t.UtilitiesDate.tooltipString(this.props.date),className:this.props.className,dateTime:this.props.date,getNextInterval:this.getNextInterval,getTimeString:this.getTimeString,tabIndex:this.props.tabIndex,tooltipProps:this.state.tooltipProps})}static agoNextInterval(e,i,o){o||(o=new Date),i||(i=0);const s=o.getTime()-e.getTime();let n;if(s<2*t.UtilitiesDate.minute)n=2*t.UtilitiesDate.minute-s;else if(s<59*t.UtilitiesDate.minute&&0===i)n=t.UtilitiesDate.minute-s%t.UtilitiesDate.minute;else if(o.toDateString()===e.toDateString()&&0===i)n=t.UtilitiesDate.hour-s%t.UtilitiesDate.hour;else if(1===i&&o.toDateString()===e.toDateString()||s<t.UtilitiesDate.week&&o.getDay()!==e.getDay()){const e=new Date(o);e.setDate(o.getDate()+1),e.setHours(0,0,0),n=e.getTime()-o.getTime()}else if(o.getFullYear()===e.getFullYear()){n=new Date(o.getFullYear()+1,0,1).getTime()-o.getTime()}return(!n||n>t.UtilitiesDate.week)&&(n=-1),n}}t[e].Ago=o}("ComponentsTimeAgoAgo"),t.Ago={},__exportStar(c,t.Ago),function(e){d=t[e]={};class o extends i.Component{constructor(){super(...arguments),this.buttonElement=i.createRef(),this.onClick=e=>{if(this.props.disabled)e.preventDefault();else{const{onClick:t}=this.props;this.focus(),t&&t(e)}},this.onFocus=e=>{this.props.onFocus&&this.props.onFocus(e),this.props.id&&this.context.onFocus&&this.context.onFocus(this.props.id)},this.onKeyDown=e=>{e.defaultPrevented||this.props.disabled||(13===e.which||32===e.which?(this.props.onClick&&this.props.onClick(e),this.props.href||e.preventDefault()):this.props.onKeyDown&&this.props.onKeyDown(e))},this.onMouseDown=e=>{e.defaultPrevented||this.props.disabled&&e.preventDefault();const{onMouseDown:t}=this.props;t&&t(e)},this.onMouseLeave=e=>{if(!this.props.disabled){const{onMouseLeave:t}=this.props;t&&t(e)}},this.onMouseOver=e=>{if(!this.props.disabled){const{onMouseOver:t}=this.props;t&&t(e)}}}render(){const e=this.props.iconProps&&!this.props.text&&0===(0,t.Util.childCount)(this.props.children),o=void 0!==this.props.tooltipProps?this.props.tooltipProps:e&&this.props.ariaLabel?{text:this.props.ariaLabel}:void 0;return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(s=>{const n=this.props.href?"a":"button";let r=this.props.role||(this.props.href?"link":"button"),a=i.createElement(n,{autoFocus:this.props.href?void 0:this.props.autoFocus,"aria-controls":(0,t.Util.getSafeId)(this.props.ariaControls),"aria-describedby":(0,t.Util.getSafeId)(this.props.ariaDescribedBy),"aria-disabled":this.props.disabled||this.props.ariaDisabled,"aria-expanded":this.props.ariaExpanded,"aria-haspopup":this.props.ariaHasPopup,"aria-hidden":this.props.ariaHidden,"aria-label":this.props.ariaLabel,"aria-labelledby":this.props.ariaLabelledBy,"aria-setsize":this.props.ariaSetSize,"aria-posinset":this.props.ariaPosInSet,"aria-selected":this.props.ariaSelected,"aria-checked":this.props.ariaChecked,"aria-pressed":this.props.ariaPressed,"aria-roledescription":this.props.ariaRoleDescription,className:(0,t.Util.css)(this.props.className,"bolt-button",this.props.href&&"bolt-link-button",this.props.iconProps&&"bolt-icon-button",this.props.danger&&"danger",this.props.disabled?"disabled":"enabled",this.props.primary&&"primary",this.props.subtle&&"subtle",e&&"icon-only","bolt-focus-treatment"),"data-focuszone":this.props.disabled||this.props.excludeFocusZone?void 0:(0,t.Util.css)(this.props.focusZoneId,s.focuszoneId),"data-index":this.props.dataIndex,"data-is-focusable":!this.props.excludeFocusZone,href:this.props.disabled?void 0:this.props.href,id:(0,t.Util.getSafeId)(this.props.id),onBlur:this.props.onBlur,onClick:this.onClick,onMouseLeave:this.onMouseLeave,onMouseOver:this.onMouseOver,onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDown,onFocus:this.onFocus,rel:this.props.rel,role:r,style:this.props.style,tabIndex:(0,t.UtilitiesFocus.getTabIndex)(this.props,this.context),target:this.props.target,type:this.props.type?this.props.type:this.props.href?void 0:"button",ref:this.buttonElement},this.props.iconProps&&(0,t.Icon.Icon)(Object.assign(Object.assign({size:"medium"},this.props.iconProps),{className:(0,t.Util.css)(this.props.iconProps.className,"left-icon")})),this.props.text&&i.createElement("span",{className:"bolt-button-text body-m"},this.props.text),this.props.children);return o&&(a=i.createElement(t.TooltipEx.Tooltip,Object.assign({addAriaDescribedBy:!0},o),a)),a}))}focus(){this.buttonElement.current&&this.buttonElement.current.focus()}}t[e].Button=o,o.contextType=t.FocusGroup.FocusGroupContext}("ComponentsButtonButton"),function(e){h=t[e]={};let o=1;class s extends i.Component{constructor(e){super(e),this.buttonElement=i.createRef(),this.expandable=i.createRef(),this.collapse=()=>{this.expandable.current&&this.expandable.current.collapse()},this.expand=()=>{this.expandable.current&&this.expandable.current.expand()},this.renderCallout=()=>this.props.renderCallout(this,this.dropdownId,this.props.anchorElement?this.props.anchorElement:this.props.anchorPoint?void 0:this.containerElement.current?this.containerElement.current:void 0,this.props.anchorOffset||{horizontal:0,vertical:0},this.props.anchorOrigin||{horizontal:"end",vertical:"end"},this.props.anchorPoint,this.props.dropdownOrigin||{horizontal:"end",vertical:"start"}),this.dropdownId=e.dropdownId||"dropdown-"+o++,this.containerElement=e.containerRef||i.createRef()}render(){return i.createElement(t.Expandable.Expandable,{disabled:this.props.disabled,expandKey:this.props.expandKey,onCollapse:this.props.onCollapse,onExpand:this.props.onExpand,renderCallout:this.renderCallout,ref:this.expandable},(e=>{var o,s;return i.createElement("div",{className:(0,t.Util.css)(this.props.className,"bolt-expandable-button inline-flex-row"),onMouseDown:e.onMouseDown,onKeyDown:e.onKeyDown,ref:this.containerElement},i.createElement(d.Button,Object.assign({},this.props,{ariaControls:e.expanded?this.dropdownId:void 0,ariaExpanded:e.expanded,ariaHasPopup:!0,ariaLabel:null!==(o=this.props.ariaLabel)&&void 0!==o?o:this.props.tooltipProps&&this.props.tooltipProps.text?null===(s=this.props.tooltipProps)||void 0===s?void 0:s.text:"",className:(0,t.Util.css)(!this.props.text&&!this.props.children&&this.props.iconProps&&"icon-only",e.expanded&&"active",this.props.buttonClassName),onClick:t=>{e.onClick(t),this.props.onClick&&this.props.onClick(t),t.preventDefault()},ref:this.buttonElement,tooltipProps:this.props.tooltipProps?Object.assign(Object.assign({},this.props.tooltipProps),{disabled:e.expanded}):void 0}),this.props.children,this.props.hideDropdownIcon?void 0:(0,t.Icon.Icon)({key:"dropdown-icon",className:"icon-right font-weight-normal",iconName:"ChevronDownMed",size:"small"})))}))}focus(){this.buttonElement.current&&this.buttonElement.current.focus()}}t[e].ExpandableButton=s,s.defaultProps={expandKey:[40,13]}}("ComponentsButtonExpandableButton"),u=t.Button={},Object.defineProperty(t.Button,"Button",{enumerable:!0,get:function(){return d.Button}}),Object.defineProperty(t.Button,"ExpandableButton",{enumerable:!0,get:function(){return h.ExpandableButton}}),function(e){p=t[e]={};t[e].ButtonGroup=e=>i.createElement("div",{className:(0,t.Util.css)(e.className,"bolt-button-group flex-row"),role:e.role},e.children)}("ComponentsButtonGroupButtonGroup"),t.ButtonGroup={},Object.defineProperty(t.ButtonGroup,"ButtonGroup",{enumerable:!0,get:function(){return p.ButtonGroup}}),function(e){m=t[e]={};let s=1;class n extends i.Component{constructor(e){super(e),this.checkboxElement=i.createRef(),this.animationClassName="",this.onClick=e=>{this.focus(),this.onChange(e)},this.onFocus=()=>{const e=this.props.id;e&&this.context.onFocus(e)},this.onKeyDown=e=>{e.defaultPrevented||this.props.disabled||32===e.which&&(this.onChange(e),e.preventDefault())},this.onChange=e=>{if(this.props.onChange){let t=o.ObservableLike.getValue(this.props.checked);t=!1===t||!0===t&&(!!this.props.triState&&void 0),this.props.onChange(e,t)}},this.labelId=`checkbox-${s++}-label`}render(){const{disabled:e,label:o,labelId:s,tooltipProps:n}=this.props;return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(r=>i.createElement(t.Observer.Observer,{checked:this.props.checked},(a=>{let l;"presentation"!==this.props.role&&(l=void 0===a.checked?"mixed":a.checked?"true":"false");let c=i.createElement("div",{"aria-checked":l,"aria-describedby":(0,t.Util.getSafeId)(this.props.ariaDescribedBy),"aria-disabled":this.props.disabled,"aria-label":this.props.ariaLabel,"aria-labelledby":this.props.ariaLabel?void 0:(0,t.Util.getSafeId)(this.props.ariaLabelledBy),className:(0,t.Util.css)(this.props.className,"bolt-checkbox cursor-pointer",!1!==a.checked&&"checked",e?"disabled":"enabled","bolt-focus-treatment",o&&"labelled"),"data-focuszone":!e&&(0,t.Util.css)(this.props.focuszoneId,this.props.excludeFocusZone?void 0:r.focuszoneId),id:(0,t.Util.getSafeId)(this.props.id),onClick:e?void 0:this.onClick,onFocus:this.onFocus,onKeyDown:this.onKeyDown,ref:this.checkboxElement,role:this.props.role||"checkbox",tabIndex:(0,t.UtilitiesFocus.getTabIndex)(this.props,this.context)},i.createElement("div",{className:"bolt-checkmark justify-center flex-row flex-noshrink scroll-hidden"},(0,t.Icon.Icon)({className:this.animationClassName,iconName:void 0===a.checked?"SkypeMinus":"CheckMark",size:"small"})),o&&i.createElement("div",{className:"bolt-checkbox-label",id:(0,t.Util.getSafeId)(s||this.labelId)},o),this.props.children);return n&&(c=i.createElement(t.TooltipEx.Tooltip,Object.assign({addAriaDescribedBy:!0},n),c)),c}))))}componentDidMount(){this.animationClassName="animation-ready"}focus(){this.checkboxElement.current&&this.checkboxElement.current.focus()}}t[e].TriStateCheckbox=n,n.contextType=t.FocusGroup.FocusGroupContext;class r extends n{}t[e].Checkbox=r,r.defaultProps={checked:!1}}("ComponentsCheckboxCheckbox"),function(e){b=t[e]={},t[e].FormItemContext=i.createContext({});let o=1;class s extends i.Component{constructor(){super(...arguments),this.id="form-item-"+o++}render(){const{ariaLabel:o,className:s,error:n,severity:r,label:a,message:l,required:c}=this.props,d=a?this.id+"-label":void 0;return i.createElement(t.Observer.Observer,{error:n,severity:r,message:l},(l=>{const h=l.message?this.id+"-message":void 0;return i.createElement(t[e].FormItemContext.Provider,{value:{ariaDescribedById:h,ariaLabelledById:d,error:l.error,severity:l.severity}},i.createElement("div",{className:(0,t.Util.css)(s,"flex-column")},a&&i.createElement("label",{"aria-label":o,className:(0,t.Util.css)("bolt-formitem-label","body-m",c&&"bolt-formitem-label--required"),id:(0,t.Util.getSafeId)(d)},a),this.props.children,l.message&&i.createElement("span",{className:(0,t.Util.css)("bolt-formitem-message body-xs",n&&(!r||1===r)&&"bolt-formitem-message-error",n&&2===r&&"bolt-formitem-message-warning"),id:(0,t.Util.getSafeId)(h),role:l.error?"alert":void 0},l.message)))}))}}t[e].FormItem=s}("ComponentsFormItemFormItem"),function(e){f=t[e]={};class s extends i.Component{constructor(e){super(e),this.intersectionElements={},this.bodyElement=i.createRef(),this.listElement=i.createRef(),this.scrollToIndex=-1,this.scrollToOptions=void 0,this.selectOnFocus=!0,this.focusIndex=new o.ObservableValue(-1),this.pivotIndex=-1,this.onBlur=()=>{this.focusIndex.value=-1},this.onClick=e=>{if(this.onDispatch(e),!e.defaultPrevented&&this.listElement.current){const{cellElement:t,rowIndex:i}=a(e);if(!t){const t=o.ObservableLike.getValue(this.state.rows[i]);if(i>=0&&t){const o={data:t,index:i};this.props.selectRowOnClick&&this.processSelectionEvent(e,o),this.props.singleClickActivation&&this.rowActivated(e,o)}}}},this.onDispatch=e=>{this.state.eventDispatch.dispatchEvent(e)},this.onDoubleClick=e=>{if(this.onDispatch(e),!e.defaultPrevented&&!this.props.singleClickActivation){const t=a(e).rowIndex,i=o.ObservableLike.getValue(this.state.rows[t]);t>=0&&i&&this.rowActivated(e,{data:i,index:t})}},this.onFocusBody=e=>{if(this.selectOnFocus){const{selection:t}=this.props;if(!t||t.selectOnFocus){const t=this.focusIndex.value;if(t>=0){const i=o.ObservableLike.getValue(this.state.rows[t]);i&&this.processSelectionEvent(e,{data:i,index:t})}}this.selectOnFocus=!1}},this.onFocusItem=(e,t)=>{const{focusIndex:i}=this;if(i.value!==e){this.focusRow(e,2),i.value>=0?delete this.state.renderedRows[i.value]:void 0!==this.props.defaultTabbableRow&&delete this.state.renderedRows[this.props.defaultTabbableRow],delete this.state.renderedRows[e],this.focusIndex.value=e;const s=o.ObservableLike.getValue(this.state.rows[e]);s&&this.rowFocused(t,{data:s,index:e})}},this.onKeyDown=e=>{if(this.onDispatch(e),!e.defaultPrevented){const i=e.target.nodeName;if("INPUT"===i||"TEXTAREA"===i)return;const{focusIndex:s}=this,n=o.ObservableLike.getValue(this.state.rows[s.value]);if(n)if(13===e.which)s.value>=0&&!(0,t.Util.eventTargetContainsNode)(e,["A"])&&this.rowActivated(e,{data:n,index:s.value});else if(32===e.which)this.processSelectionEvent(e,{data:n,index:s.value}),e.preventDefault();else if(38===e.which||40===e.which){const{selection:t}=this.props;t&&(!t.selectOnFocus||!e.shiftKey&&e.ctrlKey)||(e.persist(),window.setTimeout((()=>{this.focusIndex.value!=s.value&&this.processSelectionEvent(e,{data:n,index:this.focusIndex.value})}),0))}else 34===e.which?(this.focusRow(Math.min(s.value+this.props.pageSize,this.state.rowCount-1),1),e.preventDefault()):33===e.which?(this.focusRow(Math.max(s.value-this.props.pageSize,0),-1),e.preventDefault()):36===e.which?(this.focusRow(0,1),e.preventDefault()):35===e.which&&(this.focusRow(this.state.rowCount-1,-1),e.preventDefault())}},this.onIntersect=e=>{const{scrollTop:t}=this.context.root,{rowCount:i}=this.state,{firstMaterialized:o,lastMaterialized:s}=this.state,{rowHeight:n,rowProportion:r}=this.state;if(t!==this.state.scrollTop&&e.length)return;if(!this.listElement.current||!this.bodyElement.current)return;const a=this.context.root.getBoundingClientRect(),l=Math.max(0,t+this.context.root.offsetTop-this.listElement.current.offsetTop);let c=Math.max(0,Math.min(i-1,Math.floor(l/(n*r)))),d=Math.min(i-1,c+Math.ceil(a.height/n));l+(d-c)*n>this.state.maxHeight&&(d=i-1,c=Math.max(0,d-Math.ceil(a.height/n))),c===o&&d===s&&n===this.state.rowHeight&&t===this.state.scrollTop&&l===this.state.scrollTopRect||this.setState({firstMaterialized:c,lastMaterialized:d,rowHeight:n,scrollTop:t,scrollTopRect:l})},this.onMouseDownBody=e=>{this.selectOnFocus=!1};const s=e.itemProvider.length;this.state={eventDispatch:e.eventDispatch||new t.UtilitiesDispatch.EventDispatch,firstMaterialized:0,itemProvider:e.itemProvider,lastMaterialized:0,maxHeight:this.props.maxHeight||1e6,focusRows:{},renderedRows:{},rowCount:s,rowHeight:e.rowHeight||0,rowProportion:e.rowHeight&&e.maxHeight?Math.min(1,e.maxHeight/(e.rowHeight*s)):1,rows:{},scrollTop:0,scrollTopRect:0}}static getDerivedStateFromProps(e,t){const i=e.itemProvider.length;let o=t.firstMaterialized,s=t.lastMaterialized;i!==t.rowCount&&(o=Math.max(0,Math.min(t.firstMaterialized,i)),s=Math.max(o,Math.min(t.lastMaterialized+(t.lastMaterialized===t.rowCount-1?e.pageSize:0),i-1)));const n={firstMaterialized:o,itemProvider:e.itemProvider,lastMaterialized:s,rowCount:i,rowProportion:Math.min(1,t.maxHeight/(t.rowHeight*i))};return e.itemProvider!==t.itemProvider&&(n.renderedRows={},n.rows={}),n}getListRole(){return this.props.role?this.props.role:this.props.selection?"listbox":"list"}getItemRole(){switch(this.getListRole()){case"tree":case"group":return"treeitem";case"list":return"listitem";case"listbox":return"option";case"radiogroup":return"radio";default:return null}}render(){const{className:e,focuszoneProps:o,id:s,width:n}=this.props,{firstMaterialized:r,lastMaterialized:a,maxHeight:l,rowCount:c,rowHeight:d}=this.state,h=this.getListRole(),u=[],p=Math.max(0,this.focusIndex.value-3),m=Math.min(c,this.focusIndex.value+3);if(u.push(this.renderIntersectionBounds(!0)),-1!==this.focusIndex.value&&p<r)for(let e=p;e<=Math.min(m,r-1);e++)u.push(this.renderRow(e,!1));for(let e=r;e<=a;e++)u.push(this.renderRow(e,!0));if(-1!==this.focusIndex.value&&m>a&&a>0)for(let e=Math.max(p,a+1);e<=m;e++)u.push(this.renderRow(e,!1));u.push(this.renderIntersectionBounds(!1));const b=Math.min(l,d*this.state.rowCount);let f=i.createElement("div",{"aria-label":this.props.ariaLabel,className:(0,t.Util.css)(e,"bolt-fixed-height-list relative"),id:(0,t.Util.getSafeId)(s),onBlur:this.onBlur,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onDragEnd:this.onDispatch,onDragEnter:this.onDispatch,onDragExit:this.onDispatch,onDragOver:this.onDispatch,onDragStart:this.onDispatch,onDrop:this.onDispatch,onKeyUp:this.onDispatch,onMouseDown:this.onDispatch,onTouchStart:this.onDispatch,ref:this.listElement,role:h,style:{width:n,height:b}},i.createElement("div",{className:"relative",onFocus:this.onFocusBody,onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDownBody,ref:this.bodyElement,style:{width:n,height:b}},u));return f=i.createElement(t.FocusZone.FocusZone,Object.assign({direction:2,skipHiddenCheck:!0},o),f),i.createElement(t.Observer.Observer,{itemProvider:{filter:(e,t)=>{this.props.selection&&this.props.selection.onItemsChanged(e,t);const i={renderedRows:{},focusRows:{},rows:{}};if(-1!==this.state.rowCount){const t=(e.addedItems?e.addedItems.length:0)-(e.removedItems?e.removedItems.length:0);t&&(i.rowCount=this.state.rowCount+t,i.firstMaterialized=Math.max(0,Math.min(this.state.firstMaterialized,i.rowCount-1)),i.lastMaterialized=Math.max(i.firstMaterialized,Math.min(this.state.lastMaterialized+(e.index>=this.state.firstMaterialized&&e.index<=this.state.lastMaterialized+1?t:0),i.rowCount-1)))}return this.setState(i),!1},observableValue:this.props.itemProvider}},(()=>f))}componentDidMount(){this.onIntersect([]),this.context.register(this.onIntersect)}componentDidUpdate(e,t){const{scrollToIndex:i,onScrollComplete:o}=this;if(this.state.rowCount!==t.rowCount&&this.onIntersect([]),-1!==i&&this.state.rowHeight){const e=this.bodyElement.current,{firstMaterialized:t,lastMaterialized:s}=this.state;if(i>=t&&i<=s&&e)for(let t=0;t<e.children.length;t++){const o=e.children[t];if(r(o).rowIndex===i){o.scrollIntoView(this.scrollToOptions);break}}this.onScrollComplete=void 0,this.scrollToIndex=-1,this.scrollToOptions=void 0,o&&o(i)}}componentWillUnmount(){this.context.unregister(this.onIntersect)}getFocusIndex(){return this.focusIndex.value}getStats(){return{firstMaterialized:this.state.firstMaterialized,lastMaterialized:this.state.lastMaterialized}}scrollIntoView(e,t,i){const{pageSize:o}=this.props,{firstMaterialized:s,lastMaterialized:n,rowCount:a}=this.state;if(e>=0&&e<this.state.rowCount){const o=this.bodyElement.current;if(e>=s&&e<=n&&o){for(let i=0;i<o.children.length;i++){const s=o.children[i];if(r(s).rowIndex===e){s.scrollIntoView(t);break}}i&&i(e)}else this.onScrollComplete&&this.onScrollComplete(-1),this.onScrollComplete=i,this.scrollToIndex=e,this.scrollToOptions=t,this.setState({firstMaterialized:Math.max(0,e-Math.floor((n-s)/2)),lastMaterialized:Math.min(a-1,Math.ceil(e+(n-s)/2))})}}focusRow(e,t){this.scrollIntoView(e,{block:"nearest"},(i=>{if(i===e&&this.bodyElement.current){const e=this.bodyElement.current.querySelector("[data-row-index='"+i+"']");if(e)if(e.getAttribute("tabindex"))e.focus();else{const e=Math.min(this.state.rowCount-1,Math.max(0,i+t));e!==i?this.focusRow(e,t):e!==this.focusIndex.value&&this.focusRow(e,-t)}}}))}processSelectionEvent(e,t){const{selection:i}=this.props;if(!i||i.selectable(t.index)){let o=!1,s=!0;if(i){const{index:n}=t;o=i.selected(n),this.pivotIndex>=0&&e.shiftKey&&i.multiSelect?i.select(Math.min(this.pivotIndex,n),Math.abs(this.pivotIndex-n)+1,e.ctrlKey||e.metaKey):(e.ctrlKey||e.metaKey||i.alwaysMerge)&&i.multiSelect?(i.toggle(n,!0),s=!1):i.select(n,1,!1),e.shiftKey||(this.pivotIndex=n)}o!==s&&this.rowSelected(e,t)}}renderLoadingRow(e,t){return i.createElement("div",{className:"bolt-list-row-loading"},i.createElement("div",{className:"shimmer shimmer-line",style:{width:80*Math.random()+20+"%"}}," "))}renderIntersectionBounds(e){const{firstMaterialized:t,lastMaterialized:o,rowHeight:s,rowProportion:n}=this.state,r=e?"topobserv":"bottomobserv";let a=0;return t*s*n+(o-t)*s>this.state.maxHeight?e?(a=this.state.maxHeight,a-=(o-t)*s*n+s,a--):a=this.state.maxHeight-1:a=e?t*s*n-1:t*s*n+(1+o-t)*s+1,i.createElement("div",{className:"bolt-list-row-spacer invisible absolute",key:r,ref:e=>{const t=this.intersectionElements[r];e?t!==e&&(t&&this.context.unobserve(e),this.context.observe(e),this.intersectionElements[r]=e):t&&(this.context.unobserve(t),delete this.intersectionElements[r])},role:"presentation",style:{top:`${a}px`,height:"1px"}})}renderRow(e,s){const{itemProvider:n}=this.props,{focusRows:r,renderedRows:a,firstMaterialized:l,lastMaterialized:c,rowHeight:d,rowProportion:h,rows:u}=this.state,p=this.getItemRole();let m=s?a[e]:r[e];if(!m||1!==h){let r=u[e];if(r||(r=n.getItem?n.getItem(e):n.value[e]),!r)return null;u[e]=r;const{selection:a}=this.props;let d;a&&(d={observableValue:a,filter:t=>{for(const i of t)if(e>=i.beginIndex&&e<=i.endIndex)return!0;return!1}});const b=t=>{this.onFocusItem(e,t)};m=i.createElement(t.Observer.UncheckedObserver,{item:r,key:e,selection:d,focusIndex:this.focusIndex},(s=>{var n,a;const{renderRow:d,renderLoadingRow:u}=this.props,{rowHeight:m,rowCount:f}=this.state,v=o.ObservableLike.getValue(r),g={ariaBusy:!s.item,ariaRowOffset:1,data:v,eventDispatch:this.state.eventDispatch,itemProvider:this.props.itemProvider,listProps:this.props,onFocusItem:this.onFocusItem,singleClickActivation:this.props.onActivate&&this.props.singleClickActivation};let x;x=s.item?d(e,s.item,g):u?u(e,g):this.renderLoadingRow(e,g);let w=0,I=0;e>=l&&e<=c&&(I=m),l*m*h+(c-l)*m>this.state.maxHeight?(w=this.state.maxHeight,w-=(f-c)*m*h,w-=(c-e)*m):0===I?w=e*m*h:(w=l*m*h,w+=(e-l)*m);const C=null==g?void 0:g.data,E=null===(n=null==C?void 0:C.underlyingItem)||void 0===n?void 0:n.childItems,D=null===(a=null==C?void 0:C.underlyingItem)||void 0===a?void 0:a.expanded;return i.createElement(t.FocusWithin.FocusWithin,{onFocus:b},(o=>i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(s=>i.createElement(t.FocusZone.FocusZone,{direction:1},i.createElement("div",{className:(0,t.Util.css)("bolt-fixed-height-list-row scroll-hidden absolute",this.focusIndex.value===e&&"focused"),style:{height:`${I}px`,top:`${w}px`},"data-focuszone":s.focuszoneId,"data-row-index":e,tabIndex:0==e||E?0:-1,onBlur:o.onBlur,onFocus:o.onFocus,role:p,"aria-expanded":(!E||void 0!==D)&&D,"aria-labelledby":`rowContent-${e}`},x))))))})),s?this.state.renderedRows[e]=m:this.state.focusRows[e]=m}return m}rowActivated(e,t){this.state.eventDispatch.dispatchEvent(e,t,"activate"),this.props.onActivate&&this.props.onActivate(e,t)}rowSelected(e,t){this.state.eventDispatch.dispatchEvent(e,t,"select"),this.props.onSelect&&this.props.onSelect(e,t)}rowFocused(e,t){this.state.eventDispatch.dispatchEvent(e,t,"focus"),this.props.onFocus&&this.props.onFocus(e,t)}}function n(e,t){const i=e.getAttribute(t);return i?parseInt(i,10):-1}function r(e){let t;let i=-1;for(;e;){if(t=n(e,"data-row-index"),-1!==t){i=t;break}if(e.classList.contains("bolt-fixed-height-list")){e=null;break}e=e.parentElement}return{cellElement:null,cellIndex:-1,rowElement:e,rowIndex:i}}function a(e){return r(e.target)}t[e].FixedHeightList=s,s.contextType=t.Intersection.IntersectionContext,s.defaultProps={defaultTabbableRow:0,focuszoneProps:{direction:2},maxHeight:1e6},t[e].rowFromElement=r,t[e].rowFromEvent=a}("ComponentsListFixedHeightList"),function(e){v=t.ComponentsListList={};class r extends i.Component{constructor(e){super(e),this.bodyElement=i.createRef(),this.listElement=i.createRef(),this.spacerElements={},this.scrollToIndex=-1,this.scrollToOptions=void 0,this.selectOnFocus=!0,this.focusIndex=-1,this.pivotIndex=-1,this.onVirtualizeKeyDown=e=>{if(this.state.virtualize&&e.ctrlKey&&e.altKey&&"v"===e.key){const e=this.props.itemProvider.length;this.setState({virtualize:!1,lastMaterialized:e-1,lastRendered:e-1,firstMaterialized:0,firstRendered:0}),s.announce(a.VirtualizationDisabled)}},this.onBlur=()=>{this.focusIndex=-1},this.onClick=e=>{if(this.onDispatch(e),!(e.defaultPrevented||e.altKey&&this.props.selectableText)&&this.listElement.current){const{cellElement:i,rowIndex:s}=b(e);if(!i||!(0,t.Util.eventTargetContainsNode)(e,["A"],i)){const t=o.ObservableLike.getValue(this.state.rows[s]);if(s>=0&&t){const i={data:t,index:s};this.props.selectRowOnClick&&this.processSelectionEvent(e,i),this.props.singleClickActivation&&this.rowActivated(e,i)}}}},this.onDispatch=e=>{this.state.eventDispatch.dispatchEvent(e)},this.onDoubleClick=e=>{if(this.onDispatch(e),!e.defaultPrevented&&!this.props.singleClickActivation){const t=b(e).rowIndex,i=o.ObservableLike.getValue(this.state.rows[t]);t>=0&&i&&this.rowActivated(e,{data:i,index:t})}},this.onFocusBody=e=>{if(this.selectOnFocus){const{selection:t}=this.props;if(!t||t.selectOnFocus){const t=this.focusIndex;if(t>=0){const i=o.ObservableLike.getValue(this.state.rows[t]);i&&this.processSelectionEvent(e,{data:i,index:t})}}this.selectOnFocus=!1}},this.onFocusItem=(e,t)=>{const{focusIndex:i}=this;if(i!==e){i>=0?delete this.state.renderedRows[i]:delete this.state.renderedRows[this.getInitialTabbableRow()],delete this.state.renderedRows[e],this.focusIndex=e;const s=o.ObservableLike.getValue(this.state.rows[e]);s&&this.rowFocused(t,{data:s,index:e})}},this.onKeyDown=e=>{if(this.onDispatch(e),!e.defaultPrevented){const i=e.target.nodeName;if("INPUT"===i||"TEXTAREA"===i)return;const{focusIndex:s}=this,n=o.ObservableLike.getValue(this.state.rows[s]);if(n)if(13===e.which)s>=0&&!(0,t.Util.eventTargetContainsNode)(e,["A"])&&this.rowActivated(e,{data:n,index:s});else if(32===e.which)this.processSelectionEvent(e,{data:n,index:s}),e.preventDefault();else if(38===e.which||40===e.which){const{selection:t}=this.props;t&&(!t.selectOnFocus||!e.shiftKey&&e.ctrlKey)||(e.persist(),window.setTimeout((()=>{if(this.focusIndex!=s){const t=o.ObservableLike.getValue(this.state.rows[this.focusIndex]);t&&this.processSelectionEvent(e,{data:t,index:this.focusIndex})}}),0))}else if(34===e.which){const t=this.getStats();this.focusRow(Math.min(s+(t.lastRendered-t.firstRendered),this.state.rowCount-1),1),e.preventDefault()}else if(33===e.which){const t=this.getStats();this.focusRow(Math.max(s-(t.lastRendered-t.firstRendered),0),-1),e.preventDefault()}else 36===e.which?(this.focusRow(0,1),e.preventDefault()):35===e.which&&(this.focusRow(this.state.rowCount-1,-1),e.preventDefault())}},this.onIntersect=e=>{if(!this.state.virtualize)return;const{scrollTop:t}=this.context.root,{firstRendered:i,firstMaterialized:o,lastRendered:s,lastMaterialized:n,rowCount:r,rowProportion:a}=this.state;let{rowHeight:l}=this.state;if(t!==this.state.scrollTop&&e.length)return;if(!this.listElement.current||!this.bodyElement.current)return;const c=this.bodyElement.current.children;if(0===l){if(c.length>0){let e=0,t=0;for(let i=0;i<c.length;i++){const o=this.bodyElement.current.children[i].getBoundingClientRect().height;o>0&&(e+=o,t++)}t>0&&(l=e/t)}if(0===l)return;if(-1!==this.scrollToIndex)return void this.setState({firstMaterialized:Math.max(0,this.scrollToIndex-this.state.pageSize),lastMaterialized:this.scrollToIndex+Math.min(this.props.initialPageCount*this.state.pageSize,r-1),rowHeight:l})}const d=this.context.root.getBoundingClientRect();let h,u,m=o,b=n,f=b,v=m;for(let e=0;e<c.length;e++){const t=c[e],i=p(t,"data-row-index"),s=t.getBoundingClientRect();i>=o&&i<=n&&(s.bottom<d.top-this.state.pageSize*(a*l)?m++:s.top>d.bottom+this.state.pageSize*(a*l)&&b--,i===o&&(h=t),i===n&&(u=t)),i>-1&&s.top<d.bottom&&s.bottom>d.top&&(v=Math.max(v,i),f=Math.min(f,i))}if(a<1)if(m>b||f===m||v===b)if(v>=r-1)m=Math.ceil(b-(d.height/l+this.state.pageSize));else{const e=t-(this.listElement.current.offsetTop-this.context.root.offsetTop);m=Math.max(0,Math.min(r-1,Math.floor(e/(a*l)))-this.state.pageSize),b=Math.min(r-1,m+Math.ceil(d.height/(a*l)+this.state.pageSize-1)),v=-1,f=-1}else m=Math.min(m,f-this.state.pageSize),b=Math.max(b,v+this.state.pageSize-1),v=-1,f=-1;else if(m>b){const e=t-(this.listElement.current.offsetTop-this.context.root.offsetTop);m=Math.max(0,Math.min(r-1,Math.floor(e/l))-this.state.pageSize),b=Math.min(r-1,m+Math.ceil(d.height/l+this.state.pageSize-1)),v=-1,f=-1}else{if(m===o&&h){const e=h.getBoundingClientRect().top-d.top;e>0&&(m-=Math.ceil(e/l))}if(b===n&&u){const e=u.getBoundingClientRect(),t=d.bottom-e.bottom;t>0&&(b+=Math.ceil(t/l))}}m=Math.max(m,0),b=Math.min(b,r-1),m===o&&f===i&&b===n&&v===s&&l===this.state.rowHeight&&t===this.state.scrollTop||this.setState({firstMaterialized:m,firstRendered:f,lastMaterialized:b,lastRendered:v,rowHeight:l,scrollTop:t})},this.onPointerDownBody=e=>{this.selectOnFocus=!1},this.getInitialTabbableRow=()=>{const{defaultTabbableRow:e,itemProvider:t,selection:i}=this.props;if(e)return e;if(i)for(let e=0;e<t.length;e++)if(i.selectable(e))return e;return 0},this.getHeight=e=>{let t=0;const i=this.props.rowHeights||[];for(let o=0;o<e&&o<i.length;o++)t+=i[o];return t};const n=e.itemProvider.length,r=e.pageSize;if(this.state={columnCount:1,eventDispatch:e.eventDispatch||new t.UtilitiesDispatch.EventDispatch,firstMaterialized:0,firstRendered:0,itemProvider:e.itemProvider,lastMaterialized:this.props.virtualize?Math.min(e.initialPageCount*r,n-1):n-1,lastRendered:this.props.virtualize?Math.min(e.initialPageCount*r,n-1):n-1,overlays:new o.ObservableArray,pageSize:r,renderedRows:{},rowCount:n,rowHeight:e.rowHeight||0,rowProportion:e.rowHeight&&e.maxHeight?Math.min(1,e.maxHeight/(e.rowHeight*n)):1,rows:{},scrollTop:0,virtualize:!!e.virtualize},e.behaviors)for(const t of e.behaviors)t.initialize&&t.initialize(e,this,this.state.eventDispatch)}static getDerivedStateFromProps(e,t){const i=e.itemProvider.length;let o=t.firstMaterialized,s=t.lastMaterialized;i!==t.rowCount&&(o=Math.max(0,Math.min(t.firstMaterialized,i)),s=t.virtualize?Math.max(o,Math.min(t.lastMaterialized+(t.lastMaterialized===t.rowCount-1||t.lastMaterialized===t.rowCount?e.pageSize:0),i-1)):i-1);const n={firstMaterialized:o,itemProvider:e.itemProvider,lastMaterialized:s,pageSize:e.pageSize,rowCount:i,rowProportion:Math.min(1,(e.maxHeight||1e5)/(t.rowHeight*(i-(s-o))))};return e.itemProvider===t.itemProvider&&e.columnCount===t.columnCount||(n.columnCount=e.columnCount,n.renderedRows={},n.rows={}),n}render(){const{ariaRowOffset:e,className:o,focuszoneProps:s,id:r,maxWidth:l,minWidth:c,width:d}=this.props,{firstMaterialized:h,lastMaterialized:u,rowCount:p,rowProportion:m}=this.state,{focusIndex:b}=this,f=this.props.role?this.props.role:this.props.selection?"listbox":"list",v="table"===f||"grid"===f||"treegrid"===f,g=[];let x=0,w=h,I=Math.max(0,p-u-1),C=0,E=Number.MAX_SAFE_INTEGER,D=0;if(-1!==b&&(E=Math.max(0,b-3),D=Math.min(p,b+3),E<h?(D=Math.min(D,h-1),x=E,w=h-D-1):D>u&&(E=Math.max(E,u+1),I=E-u-1,C=Math.max(0,p-D-1))),m<1&&(w+=Math.min(this.state.pageSize,h)),g.push(this.renderSpacer("st1",x)),E<h)for(let e=E;e<=D;e++)g.push(this.renderRow(e));g.push(this.renderSpacer("st2",w));for(let e=h;e<=u;e++)g.push(this.renderRow(e));if(g.push(this.renderSpacer("sb2",I,!0)),D>u)for(let e=E;e<=D;e++)g.push(this.renderRow(e));return g.push(this.renderSpacer("sb1",C,!0)),i.createElement(t.Observer.UncheckedObserver,{itemProvider:{filter:(e,t)=>{this.props.selection&&this.props.selection.onItemsChanged(e,t);const i={renderedRows:{},rows:{}};if(e.removedItems&&this.focusIndex>=e.index&&e.index+e.removedItems.length>=this.focusIndex&&(this.focusIndex=-1),-1!==this.state.rowCount){const t=(e.addedItems?e.addedItems.length:0)-(e.removedItems?e.removedItems.length:0);t&&(i.rowCount=this.state.rowCount+t,i.firstMaterialized=Math.max(0,Math.min(this.state.firstMaterialized,i.rowCount-1)),i.lastMaterialized=this.state.virtualize?Math.max(i.firstMaterialized,Math.min(this.state.lastMaterialized+(e.index>=this.state.firstMaterialized&&e.index<=this.state.lastMaterialized+1?Math.min(this.state.pageSize,t):0),i.rowCount-1)):i.rowCount-1)}return this.setState(i),!1},observableValue:this.props.itemProvider}},i.createElement(t.FocusWithin.FocusWithin,{onBlur:this.onBlur},(h=>{let u=i.createElement("table",{"aria-colcount":v?this.props.ariaColumnCount?this.props.ariaColumnCount:this.props.columnCount:void 0,"aria-label":this.props.virtualize?(0,n.format)(a.VirtualizedListLabelFormat,this.props.ariaLabel):this.props.ariaLabel,"aria-rowcount":v?this.state.itemProvider.length+e:void 0,className:(0,t.Util.css)(o,"bolt-list body-m relative",this.props.showScroll?void 0:"scroll-hidden"),id:(0,t.Util.getSafeId)(r),onBlur:h.onBlur,onClick:this.onClick,onContextMenu:this.onDispatch,onDoubleClick:this.onDoubleClick,onDragEnd:this.onDispatch,onDragEnter:this.onDispatch,onDragExit:this.onDispatch,onDragOver:this.onDispatch,onDragStart:this.onDispatch,onDrop:this.onDispatch,onFocus:h.onFocus,onKeyDown:this.onKeyDown,onKeyUp:this.onDispatch,onPointerDown:this.onDispatch,ref:this.listElement,role:f,style:{maxWidth:l,minWidth:c,width:d},tabIndex:0},this.props.renderHeader&&this.props.renderHeader(),i.createElement("tbody",{className:"relative",onFocus:this.onFocusBody,onPointerDown:this.onPointerDownBody,ref:this.bodyElement,role:"listbox"===f||"list"===f||"menu"===f||"tree"===f?"presentation":void 0},this.renderOverlay(this.listElement),g));return s&&(u=i.createElement(t.FocusZone.FocusZone,Object.assign({},s,{skipHiddenCheck:!0}),u)),u})))}componentDidMount(){this.context.register(this.onIntersect),this.props.virtualize&&document.addEventListener("keydown",this.onVirtualizeKeyDown)}componentDidUpdate(){const{scrollToIndex:e,onScrollComplete:t}=this;if(-1!==e&&this.state.rowHeight){const i=this.bodyElement.current,{firstMaterialized:o,lastMaterialized:s}=this.state;if(e>=o&&e<=s&&i)for(let t=0;t<i.children.length;t++){const o=i.children[t];if(m(o).rowIndex===e){o.scrollIntoView(this.scrollToOptions);break}}this.onScrollComplete=void 0,this.scrollToIndex=-1,this.scrollToOptions=void 0,t&&t(e)}}componentWillUnmount(){this.context.unregister(this.onIntersect),this.props.virtualize&&document.removeEventListener("keydown",this.onVirtualizeKeyDown)}addOverlay(e,t,i,o=0,s){const{overlays:n}=this.state,r=n.value.findIndex((t=>t.id===e)),a={render:i,id:e,rowIndex:t,zIndex:o+1,columnIndex:s};r>=0?n.change(r,a):n.push(a)}removeOverlay(e){const{overlays:t}=this.state,i=t.value.findIndex((t=>t.id===e));i>=0&&t.splice(i,1)}getFocusIndex(){return this.focusIndex}getStats(){return{firstMaterialized:this.state.firstMaterialized,firstRendered:this.state.firstRendered,lastMaterialized:this.state.lastMaterialized,lastRendered:this.state.lastRendered}}scrollIntoView(e,t,i){const{firstMaterialized:o,lastMaterialized:s,pageSize:n,rowCount:r,rowHeight:a,rowProportion:l}=this.state;if(e>=0&&e<this.state.rowCount){const c=this.bodyElement.current;if(e>=o&&e<=s&&c){for(let i=0;i<c.children.length;i++){const o=c.children[i];if(m(o).rowIndex===e){o.scrollIntoView(t);break}}i&&i(e)}else{this.onScrollComplete&&this.onScrollComplete(-1),this.onScrollComplete=i,this.scrollToIndex=e,this.scrollToOptions=t;const o=l<1?n:0;a&&this.setState({firstMaterialized:Math.max(0,e-o),lastMaterialized:Math.min(r-1,e+o)})}}}focusRow(e,t=1){return new Promise((i=>{this.scrollIntoView(e,{block:"center"},(o=>{if(o===e&&this.bodyElement.current){const e=this.bodyElement.current.querySelector("[data-row-index='"+o+"']");if(e)if(e.getAttribute("tabindex"))e.focus();else{const e=Math.min(this.state.rowCount-1,Math.max(0,o+t));e!==o?this.focusRow(e,t):e!==this.focusIndex&&this.focusRow(e,-t)}}i()}))}))}processSelectionEvent(e,t){const{selection:i,enforceSingleSelect:o}=this.props;if(!i||i.selectable(t.index)){if(i){const{index:s}=t,n=!o&&i.multiSelect;if(this.pivotIndex>=0&&e.shiftKey&&n)i.select(Math.min(this.pivotIndex,s),Math.abs(this.pivotIndex-s)+1,e.ctrlKey||e.metaKey,n);else{const t=32===e.which;(e.ctrlKey||e.metaKey||i.alwaysMerge||t)&&n?i.toggle(s,!0,n):i.select(s,1,!1,n)}e.shiftKey||(this.pivotIndex=s)}this.rowSelected(e,t)}}renderLoadingRow(e,t){return i.createElement(h,{className:"bolt-list-row-loading",details:t,index:e},i.createElement("div",{className:"shimmer shimmer-line",style:{width:80*Math.random()+20+"%"}}," "))}renderOverlay(e){const{firstMaterialized:o,lastMaterialized:s,overlays:n}=this.state;return i.createElement(t.Observer.Observer,{overlays:n},(n=>{const r=this.bodyElement.current;return n.overlays.length>0&&r?i.createElement("div",{className:"bolt-list-overlay-container absolute"},n.overlays.map((n=>{var a;if(-1!==n.rowIndex&&(n.rowIndex<o||n.rowIndex>s)&&!(0,t.UtilitiesDragDrop.getDragInProgress)())return null;const l=e.current&&e.current.querySelector("[data-row-index='"+n.rowIndex+"']"),c=this.props.overlay?null==l?void 0:l.querySelector(this.props.overlay):l,d=null===(a=e.current)||void 0===a?void 0:a.querySelector("[data-column-index='"+n.columnIndex+"']");return c?d?i.createElement("div",{className:"bolt-list-overlay flex-row absolute",id:(0,t.Util.getSafeId)(n.id),key:n.id,style:{height:c.offsetHeight,width:d.offsetWidth,top:c.getBoundingClientRect().top-r.getBoundingClientRect().top,left:d.getBoundingClientRect().left-r.getBoundingClientRect().left,zIndex:10*n.zIndex}},n.render({rowElement:d})):i.createElement("div",{className:"bolt-list-overlay flex-row absolute",id:(0,t.Util.getSafeId)(n.id),key:n.id,style:{height:c.offsetHeight,top:c.getBoundingClientRect().top-r.getBoundingClientRect().top,zIndex:10*n.zIndex}},n.render({rowElement:c})):null}))):null}))}renderRow(e){const{itemProvider:s}=this.props,{renderedRows:n,rows:r}=this.state;let a=n[e];if(!a){let n=r[e];if(n||(n=s.getItem?s.getItem(e):s.value[e]),!n)return null;r[e]=n;const{selection:l}=this.props;let c;l&&(c={observableValue:l,filter:t=>{for(const i of t)if(e>=i.beginIndex&&e<=i.endIndex)return!0;return!1}}),a=i.createElement(t.Observer.UncheckedObserver,{item:n,key:e,selection:c},(t=>{const{selectableText:i,renderRow:s,renderLoadingRow:r}=this.props,{focusIndex:a}=this,l=a>=0?a:this.getInitialTabbableRow(),c=o.ObservableLike.getValue(n),d={selectableText:i,ariaBusy:!t.item,ariaRowOffset:this.props.ariaRowOffset+1,data:c,eventDispatch:this.state.eventDispatch,excludeTabStop:this.props.excludeTabStop||l!==e,listProps:this.props,onFocusItem:this.onFocusItem,singleClickActivation:this.props.onActivate&&this.props.singleClickActivation};return t.item?s(e,t.item,d):r?r(e,d):this.renderLoadingRow(e,d)})),this.state.renderedRows[e]=a}return a}renderSpacer(e,t,o){var s;const n=!o&&(null===(s=this.props.rowHeights)||void 0===s?void 0:s.length)?this.getHeight(t):t*this.state.rowHeight*this.state.rowProportion;return i.createElement("tr",{className:"bolt-list-row-spacer invisible",key:e,ref:t=>{const i=this.spacerElements[e];t?i!==t&&(i&&this.context.unobserve(t),this.context.observe(t),this.spacerElements[e]=t):i&&(this.context.unobserve(i),delete this.spacerElements[e])},role:"presentation"},i.createElement("td",{className:"bolt-list-cell-spacer invisible",colSpan:this.props.columnCount,style:{height:n+"px"}}))}rowActivated(e,t){this.state.eventDispatch.dispatchEvent(e,t,"activate"),this.props.onActivate&&this.props.onActivate(e,t)}rowSelected(e,t){this.state.eventDispatch.dispatchEvent(e,t,"select"),this.props.onSelect&&this.props.onSelect(e,t)}rowFocused(e,t){this.state.eventDispatch.dispatchEvent(e,t,"focus"),this.props.onFocus&&this.props.onFocus(e,t)}}t.ComponentsListList.List=r,r.contextType=t.Intersection.IntersectionContext,r.defaultProps={ariaRowOffset:0,columnCount:1,focuszoneProps:{direction:2},initialPageCount:3,maxHeight:1e5,pageSize:10,singleClickActivation:!1,selectRowOnClick:!0,virtualize:!0};class l extends i.Component{constructor(){super(...arguments),this.list=i.createRef(),this.scrollableElement=i.createRef()}render(){return i.createElement(t.Intersection.Intersection,{rootMargin:window.innerHeight/2},i.createElement("div",{ref:this.scrollableElement,onScroll:this.props.onScroll,className:(0,t.Util.css)(this.props.outerClassName,"flex-grow","scroll-auto")},i.createElement(r,Object.assign({},this.props,{ref:this.list}))))}addOverlay(e,t,i,o=0,s){if(this.list.current)return this.list.current.addOverlay(e,t,i,o,s)}getStats(){return this.list.current?this.list.current.getStats():{firstMaterialized:-1,firstRendered:-1,lastMaterialized:-1,lastRendered:-1}}removeOverlay(e){if(this.list.current)return this.list.current.removeOverlay(e)}focusRow(e,t=1){return this.list.current?this.list.current.focusRow(e,t):Promise.resolve()}getFocusIndex(){return this.list.current?this.list.current.getFocusIndex():-1}scrollIntoView(e,t){if(this.list.current)return this.list.current.scrollIntoView(e,t)}scrollTo(e){this.scrollableElement.current&&(this.scrollableElement.current.scrollTop=e)}}t.ComponentsListList.ScrollableList=l;class c extends i.Component{constructor(){super(...arguments),this.list=i.createRef(),this.renderListItem=(e,t,i)=>d(e,i,u(t))}render(){const e={selectableText:this.props.selectableText,className:this.props.className,columnCount:1,eventDispatch:this.props.eventDispatch,focuszoneProps:this.props.focuszoneProps,id:this.props.id,initialPageCount:this.props.initialPageCount,itemProvider:this.props.itemProvider,maxHeight:this.props.maxHeight,onActivate:this.props.onActivate,onFocus:this.props.onFocus,onSelect:this.props.onSelect,pageSize:this.props.pageSize,renderRow:this.renderListItem,selection:this.props.selection,width:this.props.width,virtualize:this.props.virtualize};return this.props.scrollable?i.createElement(l,Object.assign({},e,{ref:this.list})):i.createElement(r,Object.assign({},e,{ref:this.list}))}addOverlay(e,t,i,o=0){if(this.list.current)return this.list.current.addOverlay(e,t,i,o)}removeOverlay(e){if(this.list.current)return this.list.current.removeOverlay(e)}focusRow(e,t=1){return this.list.current?this.list.current.focusRow(e,t):Promise.resolve()}getFocusIndex(){return this.list.current?this.list.current.getFocusIndex():-1}getStats(){return this.list.current?this.list.current.getStats():{firstMaterialized:-1,firstRendered:-1,lastMaterialized:-1,lastRendered:-1}}scrollIntoView(e,t){if(this.list.current)return this.list.current.scrollIntoView(e,t)}}function d(e,t,o){return i.createElement(h,{details:t,index:e},o)}function h(e){const{children:o,details:s,index:n,linkProps:r,itemId:a,tabIndex:l}=e,{selectableText:c,ariaBusy:d,ariaDescribedBy:h,ariaLabel:u,ariaPosInSet:p,ariaSetSize:m,excludeFocusZone:b}=s,{selection:f,singleClickActivation:v}=s.listProps;return i.createElement(t.FocusWithin.FocusWithin,{onFocus:function(t){e.details.onFocusItem(e.index,t)}},(g=>i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(x=>{const w={"aria-busy":d,"aria-describedby":h,"aria-label":u,"aria-posinset":void 0===p?n+1:null===p?void 0:p,"aria-selected":f&&f.selected(n),"aria-setsize":void 0===m?e.details.listProps.itemProvider.length:null===m?void 0:m,className:(0,t.Util.css)(e.className,"bolt-list-row",0===n&&"first-row",r&&"bolt-link",f&&f.selected(n)&&"selected",g.hasFocus&&"focused",v&&"single-click-activation",c&&"selectable-text"),"data-focuszone":b||f&&!f.selectable(n)?void 0:x.focuszoneId,"data-row-index":n,"data-itemid":a,tabIndex:null!=l?l:(0,t.UtilitiesFocus.getTabIndex)(s),onBlur:g.onBlur,onFocus:g.onFocus,role:f?"option":"listitem"};return i.createElement(t.FocusZone.FocusZone,{direction:1},r?i.createElement("a",Object.assign({},(0,t.Link.getDefaultLinkProps)(r),w),i.createElement("div",{className:"bolt-list-cell","data-column-index":0},i.createElement("div",{className:"bolt-list-cell-content flex-row"},o))):i.createElement("tr",Object.assign({},w),i.createElement("td",{className:"bolt-list-cell","data-column-index":0},i.createElement("div",{className:"bolt-list-cell-content flex-row"},o))))}))))}function u(e,o=!0){let s,n=i.createElement("span",{className:"text-ellipsis body-m"},"string"==typeof e||"number"==typeof e?e:e.textNode?e.textNode:e.text);o&&(n=i.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0},n));let r=n;const a=(0,t.Util.css)("bolt-list-cell-child flex-row flex-center");return"string"!=typeof e&&"number"!=typeof e&&(s=e.textClassName,e.iconProps&&(r=i.createElement(i.Fragment,null,(0,t.Icon.Icon)(Object.assign(Object.assign({},e.iconProps),{className:(0,t.Util.css)("icon-margin",e.iconProps.className)})),n)),e.href)?i.createElement(t.Link.Link,{className:(0,t.Util.css)(s,a,"scroll-hidden"),href:e.href,rel:e.hrefRel,target:e.hrefTarget,excludeTabStop:!0,subtle:!0},r):i.createElement("span",{className:(0,t.Util.css)(s,a,"bolt-list-cell-text")},r)}function p(e,t){const i=e.getAttribute(t);return i?parseInt(i,10):-1}function m(e){let t,i=-1,o=-1,s=null;for(;e;){if(t=p(e,"data-column-index"),-1!==t&&(i=t,s=e),t=p(e,"data-row-index"),-1!==t){o=t;break}if(e.classList.contains("bolt-list")){e=null;break}e=e.parentElement}return{cellElement:s,cellIndex:i,rowElement:e,rowIndex:o}}function b(e){return m(e.target)}t.ComponentsListList.SimpleList=c,t.ComponentsListList.renderListItem=d,t.ComponentsListList.ListItem=h,t.ComponentsListList.renderListCell=u,t.ComponentsListList.cellFromElement=m,t.ComponentsListList.cellFromEvent=b}(),function(e){g=t[e]={};t[e].ListDragSourceBehavior=class{constructor(e){this.initialize=(e,t,i)=>{this.dragDroppableUI=t,this.eventDispatch=i,this.eventDispatch.addEventListener("pointerdown",this.onPointerDown),this.eventDispatch.addEventListener("dragstart",this.onDragStart),this.eventDispatch.addEventListener("dragend",this.onDragEnd),this.eventDispatch.addEventListener("dragover",this.onDragging),this.itemProvider=e.itemProvider},this.onDragging=e=>{this.options.onDragging?this.options.onDragging(e):this.onDraggingDefault()},this.onDraggingDefault=()=>{var e,t,i,o;const s=null===(t=null===(e=this.dragDroppableUI)||void 0===e?void 0:e.currentElement)||void 0===t?void 0:t.current;if(!s)return;const{top:n,bottom:r}=s.getBoundingClientRect(),a=.05*s.offsetHeight,l=null===(o=null===(i=this.operation)||void 0===i?void 0:i.y)||void 0===o?void 0:o.value;if(!l)return;const c=r-a<l,d=n+a>l,h=s.scrollTop>0,u=s.scrollTop+s.offsetHeight<s.scrollHeight;c&&u?s.scrollTo({top:s.scrollTop+20}):d&&h&&s.scrollTo({top:s.scrollTop-20})},this.onDragEnd=e=>{(0,v.cellFromEvent)(e).rowIndex>=0&&this.options.onDragEnd&&this.options.onDragEnd(e),this.dragDroppableUI.removeOverlay("drag-source-item"),this.dragImageData=void 0},this.onDragStart=e=>{if(e.detail.dataTransfer){const t=(0,v.cellFromEvent)(e).rowIndex;t>=0&&(this.options.onDragStart&&this.options.onDragStart(e),"none"!==e.detail.dataTransfer.effectAllowed&&(this.dragDroppableUI.addOverlay("drag-source-item",t,this.renderDragSourceItemOverlay),void 0===this.dragImageData&&(this.dragImageData={image:this.options.renderDragImage(e)})))}else e.stopPropagation(),e.preventDefault()},this.onPointerDown=e=>{0===e.button&&this.beginDrag(e)},this.renderDragSourceItemOverlay=e=>i.createElement(i.Fragment,null,i.createElement("div",{className:"bolt-list-drag-source-item flex-grow"}),this.operation&&this.dragImageData&&i.createElement(t.UtilitiesDragDrop.DragImage,{operation:this.operation},this.dragImageData.image)),this.setDragImage=(e,t,i)=>{this.dragImageData={image:e,xOffset:t,yOffset:i}},this.options=e}componentDidUpdate(e){this.itemProvider=e.itemProvider}componentWillUnmount(){var e,t,i,o;null===(e=this.eventDispatch)||void 0===e||e.removeEventListener("pointerdown",this.onPointerDown),null===(t=this.eventDispatch)||void 0===t||t.removeEventListener("dragstart",this.onDragStart),null===(i=this.eventDispatch)||void 0===i||i.removeEventListener("dragend",this.onDragEnd),null===(o=this.eventDispatch)||void 0===o||o.removeEventListener("dragover",this.onDragging)}beginDrag(e){const i=(0,v.cellFromEvent)(e).rowIndex;if(this.itemProvider&&i>=0){const o=this.itemProvider.value[i];this.operation=(0,t.UtilitiesDragDrop.beginDragOperation)(e,{data:o,dropEffect:"none",secondaryData:{index:i,sourceId:this.options.id},setDragImage:this.setDragImage,type:this.options.type})}}}}("ComponentsListListDragSourceBehavior"),x=t[q="ComponentsListListDropIndicator"]={},t[q].ListDropIndicator=function(e){const{position:o,xOffset:s,lineOffset:n}=e,r=(s||0)+"px",a=(n||0)+"px",l=o;return i.createElement(i.Fragment,null,i.createElement("div",{className:(0,t.Util.css)("bolt-list-drop-indicator-line flex-grow absolute",l),style:{left:a}}),i.createElement("div",{className:(0,t.Util.css)("bolt-list-drop-indicator-circle absolute",l),style:{left:r}}))},function(e){w=t[e]={};t[e].ListDropTargetBehavior=class{constructor(e){this.initialize=(e,t,i)=>{this.dragDroppableUI=t,this.eventDispatch=i,this.eventDispatch.addEventListener("dragenter",this.onDragEnter),this.eventDispatch.addEventListener("dragexit",this.onDragExit),this.eventDispatch.addEventListener("dragover",this.onDragOver),this.eventDispatch.addEventListener("drop",this.onDrop),this.itemProvider=e.itemProvider,this.indicatorName=this.options.isTree?"tree-drop-indicator":"drop-indicator"},this.onDragEnter=e=>{this.handlesType(e)&&(this.options.onDragEnter?this.options.onDragEnter(e):e.detail.dataTransfer.dropEffect="move")},this.onDragExit=e=>{this.handlesType(e)&&(this.options.onDragExit&&this.options.onDragExit(e),this.dragDroppableUI.removeOverlay(this.indicatorName))},this.onDragOver=e=>{if(!this.handlesType(e))return;const t=this.calculateIndex(e),i=e.detail.dataTransfer.secondaryData.index,o=e.detail.dataTransfer.secondaryData.sourceId;t>=0&&(t!==i||o!==this.options.id||this.options.isTree)?this.options.onDragOver?this.options.onDragOver(e,{index:"bottom"===this.listIndicatorPosition?t+1:t}):e.detail.dataTransfer.dropEffect="move":e.detail.dataTransfer.dropEffect="none","none"===e.detail.dataTransfer.dropEffect?this.dragDroppableUI.removeOverlay(this.indicatorName):this.dragDroppableUI.addOverlay(this.indicatorName,t,this.renderDropIndicator)},this.onDrop=e=>{if(!this.handlesType(e))return;const t=this.calculateIndex(e),i=e.detail.dataTransfer.secondaryData.index,o=e.detail.dataTransfer.secondaryData.sourceId;t>=0&&(t!==i||o!==this.options.id)&&this.options.onDrop&&this.options.onDrop(e,{index:"bottom"===this.listIndicatorPosition?t+1:t}),this.dragDroppableUI.removeOverlay(this.indicatorName)},this.renderDropIndicator=e=>this.options.isTree?i.createElement("div",{className:"bolt-list-tree-drop-target flex-grow"}):i.createElement(x.ListDropIndicator,{position:this.listIndicatorPosition}),this.options=e}componentDidUpdate(e){this.itemProvider=e.itemProvider}componentWillUnmount(){var e,t,i;null===(e=this.eventDispatch)||void 0===e||e.removeEventListener("dragenter",this.onDragEnter),null===(t=this.eventDispatch)||void 0===t||t.removeEventListener("dragexit",this.onDragExit),null===(i=this.eventDispatch)||void 0===i||i.removeEventListener("dragover",this.onDragOver)}calculateIndex(e){const i=(0,v.cellFromEvent)(e);let o=i.rowIndex;if(this.options.isTree)return o;if(i.rowElement&&e.detail.dataTransfer.secondaryData){const s=e.detail.dataTransfer.secondaryData.index,n=e.detail.dataTransfer.secondaryData.sourceId,r=e.detail.nativeEvent,a=i.rowElement.getBoundingClientRect(),l=(0,t.Util.getPointByEventType)(r),c=l?l.y<a.height/2+a.top:o<s;this.options.id!==n?(this.listIndicatorPosition="top",c||o++,o>=this.itemProvider.length&&(this.listIndicatorPosition="bottom",o--)):o<s?(this.listIndicatorPosition="top",c||o++):o>s&&(this.listIndicatorPosition="bottom",c&&o--)}return o}handlesType(e){var t;const i=(null===(t=e.detail.dataTransfer)||void 0===t?void 0:t.type)||"";return-1!==this.options.allowedTypes.indexOf(i)}}}("ComponentsListListDropTargetBehavior"),function(e){I=t[e]={};t[e].ListDragDropBehavior=class{constructor(e){this.initialize=(e,t,i)=>{this.eventDispatch=i,this.itemProvider=e.itemProvider,this.eventDispatch.addEventListener("keydown",this.onKeyDown),this.dragBehavior.initialize(e,t,i),this.dropBehavior.initialize(e,t,i)},this.onDragRowKeyDown=e=>{27===e.which?this.endDrag(e):32===e.which?this.endDrag(e,!0):40===e.which?(this.focusIndex=Math.min(this.focusIndex+1,this.itemProvider.length),this.fireRowDragEvents(e)):38===e.which&&(this.focusIndex=Math.max(this.focusIndex-1,0),this.fireRowDragEvents(e)),e.preventDefault()},this.onKeyDown=e=>{if(!e.defaultPrevented&&32===e.which&&"INPUT"!==e.target.tagName){const i=(0,v.cellFromEvent)(e).rowIndex;this.focusIndex=i;const o=this.itemProvider.value[i];this.dataTransfer={data:o,dropEffect:"none",secondaryData:{index:i,sourceId:this.options.id},setDragImage:t.Util.noop,type:this.options.type},(0,t.UtilitiesDragDrop.dispatchCustomDragEvent)("dragstart",e.target,e.nativeEvent,this.dataTransfer),"none"!==this.dataTransfer.effectAllowed&&(this.dragItemRowElement=e.target,this.dragItemRowElement.addEventListener("keydown",this.onDragRowKeyDown))}},this.options=e,this.dragBehavior=new g.ListDragSourceBehavior(e),this.dropBehavior=new w.ListDropTargetBehavior(e)}componentDidUpdate(e){this.itemProvider=e.itemProvider,this.dragBehavior.componentDidUpdate(e),this.dropBehavior.componentDidUpdate(e)}componentWillUnmount(){var e;null===(e=this.eventDispatch)||void 0===e||e.removeEventListener("keydown",this.onKeyDown),this.dragItemRowElement&&this.dragItemRowElement.removeEventListener("keydown",this.onDragRowKeyDown),this.dragBehavior.componentWillUnmount(),this.dropBehavior.componentWillUnmount()}dispatchEventAtIndex(e,i,o,s){let n=i;for(;n&&!n.classList.contains("bolt-list");)n=n.parentElement;if(n){const i=n.querySelector("[data-row-index='"+s+"']");i&&(0,t.UtilitiesDragDrop.dispatchCustomDragEvent)(e,i,o,this.dataTransfer)}}endDrag(e,i=!1){(0,t.UtilitiesDragDrop.dispatchCustomDragEvent)("dragend",e.target,e,this.dataTransfer),i?this.dispatchEventAtIndex("drop",e.target,e,this.focusIndex):this.dispatchEventAtIndex("dragexit",e.target,e,this.focusIndex),this.dragItemRowElement&&(this.dragItemRowElement.removeEventListener("keydown",this.onDragRowKeyDown),this.dragItemRowElement=void 0)}fireRowDragEvents(e){this.dispatchEventAtIndex("dragenter",e.target,e,this.focusIndex),this.dispatchEventAtIndex("dragover",e.target,e,this.focusIndex)}}}("ComponentsListListDragDropBehavior"),function(e){C=t[e]={};t[e].ListDragImage=e=>i.createElement(i.Fragment,null,e.iconProps&&i.createElement(t.Icon.Icon,Object.assign({},e.iconProps,{className:(0,t.Util.css)(e.iconProps.className,"flex-noshrink icon-margin")})),i.createElement("span",{className:"text-ellipsis"},e.text))}("ComponentsListListDragImage"),function(e){E=t[e]={};class i extends t.UtilitiesSelection.Selection{constructor(e){super("boolean"==typeof e||void 0===e?e:{alwaysMerge:e.alwaysMerge,multiSelect:e.multiSelect,unselectableRanges:e.unselectableRanges,selectedRanges:e.selectedRanges}),this.selectOnFocus=!0,"boolean"!=typeof e&&void 0!==e&&(this.selectOnFocus=void 0===e.selectOnFocus||e.selectOnFocus)}}t[e].ListSelection=i;t[e].FilteredListSelection=class extends i{constructor(e){super({alwaysMerge:e.alwaysMerge,multiSelect:e.multiSelect,unselectableRanges:e.unselectableRanges,selectedRanges:e.value,selectOnFocus:e.selectOnFocus}),this.filteredIndexMap=[],this.updateFilteredSelection=(e,i=this.selection.multiSelect)=>{if(0===e.length)this.value=[...this.selection.value],this.unselectableRanges=[...this.selection.unselectableRanges];else{const o=new t.UtilitiesSelection.Selection(i);e.map(((e,t)=>{this.selection.selected(e)&&o.select(t,1,!0,i),this.selection.selectable(e)||o.addUnselectable(t)})),this.value=[...o.value],this.unselectableRanges=[...o.unselectableRanges]}this.filteredIndexMap=e},this.selectionChanged=(e,t)=>{switch(t){case"addUnselectable":for(let t=0;t<e.length;t++)for(let i=e[t].beginIndex;i<=e[t].endIndex;i++){const e=this.filteredIndexMap.length>0?this.filteredIndexMap.indexOf(i):i;this.selectable(e)&&this.addUnselectable(e,1)}break;case"removeUnselectable":for(let t=0;t<e.length;t++)for(let i=e[t].beginIndex;i<=e[t].endIndex;i++){const e=this.filteredIndexMap.length>0?this.filteredIndexMap.indexOf(i):i;this.selectable(e)||this.removeUnselectable(e,1)}break;case"setUnselectable":case"set":this.updateFilteredSelection(this.filteredIndexMap);break;case"select":for(let t=0;t<e.length;t++)for(let i=e[t].beginIndex;i<=e[t].endIndex;i++){const e=this.filteredIndexMap.length>0?this.filteredIndexMap.indexOf(i):i;e>-1&&!this.selected(e)&&this.select(e,1,!0)}break;case"unselect":for(let t=0;t<e.length;t++)for(let i=e[t].beginIndex;i<=e[t].endIndex;i++){const e=this.filteredIndexMap.length>0?this.filteredIndexMap.indexOf(i):i;this.selected(e)&&this.unselect(e,1)}}},this.selection=e}select(e,t,i,o){if(super.select(e,t,i,o),this.filteredIndexMap.length>0){i||this.clear(),t=t||1;for(let i=0;i<t;i++)this.selection.select(this.filteredIndexMap[e+i],1,!0,o)}else this.selection.select(e,t,i,o)}unselect(e,t){if(super.unselect(e,t),this.filteredIndexMap.length>0){t=t||1;for(let i=0;i<t;i++)this.selection.unselect(this.filteredIndexMap[e+i],1)}else this.selection.unselect(e,t)}clear(){if(super.clear(),this.filteredIndexMap.length>0)for(let e=0;e<this.filteredIndexMap.length;e++)this.selection.unselect(this.filteredIndexMap[e]);else this.selection.clear()}}}("ComponentsListListSelection"),function(e){D=t[e]={};t[e].ContextMenuBehavior=class{constructor(e){this.initialize=(e,t,i)=>{this.eventDispatch=i,this.eventDispatch.addEventListener("contextmenu",this.onContextMenu)},this.onContextMenu=e=>{this.contextMenuHandler(e)},this.contextMenuHandler=e}componentWillUnmount(){var e;null===(e=this.eventDispatch)||void 0===e||e.removeEventListener("contextmenu",this.onContextMenu)}}}("ComponentsMenuContextMenuBehavior"),y=t.Checkbox={},Object.defineProperty(t.Checkbox,"Checkbox",{enumerable:!0,get:function(){return m.Checkbox}}),Object.defineProperty(t.Checkbox,"TriStateCheckbox",{enumerable:!0,get:function(){return m.TriStateCheckbox}}),S=t.List={},Object.defineProperty(t.List,"FixedHeightList",{enumerable:!0,get:function(){return f.FixedHeightList}}),Object.defineProperty(t.List,"cellFromEvent",{enumerable:!0,get:function(){return v.cellFromEvent}}),Object.defineProperty(t.List,"List",{enumerable:!0,get:function(){return v.List}}),Object.defineProperty(t.List,"ListItem",{enumerable:!0,get:function(){return v.ListItem}}),Object.defineProperty(t.List,"renderListCell",{enumerable:!0,get:function(){return v.renderListCell}}),Object.defineProperty(t.List,"renderListItem",{enumerable:!0,get:function(){return v.renderListItem}}),Object.defineProperty(t.List,"ScrollableList",{enumerable:!0,get:function(){return v.ScrollableList}}),Object.defineProperty(t.List,"SimpleList",{enumerable:!0,get:function(){return v.SimpleList}}),Object.defineProperty(t.List,"ListDragDropBehavior",{enumerable:!0,get:function(){return I.ListDragDropBehavior}}),Object.defineProperty(t.List,"ListDragImage",{enumerable:!0,get:function(){return C.ListDragImage}}),Object.defineProperty(t.List,"ListDragSourceBehavior",{enumerable:!0,get:function(){return g.ListDragSourceBehavior}}),Object.defineProperty(t.List,"ListDropTargetBehavior",{enumerable:!0,get:function(){return w.ListDropTargetBehavior}}),Object.defineProperty(t.List,"FilteredListSelection",{enumerable:!0,get:function(){return E.FilteredListSelection}}),Object.defineProperty(t.List,"ListSelection",{enumerable:!0,get:function(){return E.ListSelection}}),function(e){function s(e,t){const i={};let o=0;const s=[],n=t||[];if(n.length>0){o=n.reduce(((e,t)=>t.rank||0>e?t.rank:e),0)||0;for(const e of n)i[e.key]={key:e.key,rank:void 0===e.rank?++o:e.rank,items:[]}}for(const t of e)t.groupKey?i[t.groupKey]?i[t.groupKey].items.push(t):i[t.groupKey]={key:t.groupKey,rank:++o,items:[t]}:s.push(t);const r=Object.keys(i).map((e=>i[e]));r.sort(((e,t)=>(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE))),r.push({key:"ungrouped",rank:++o,items:s}),r.forEach((e=>{const t=e.items;for(;t.length>0&&1===t[0].itemType;)t.shift();for(;t.length>0&&1===t[t.length-1].itemType;)t.pop()})),e=[];let a=!0;for(const t of r)0!==t.items.length&&(a||e.push({id:`divider_${t.key}`,itemType:1}),a&&(a=!1),e=e.concat(t.items));return e}M=t.ComponentsMenuMenu={},t.ComponentsMenuMenu.groupMenuItems=s;class n extends t.UtilitiesProvider.ArrayItemProvider{constructor(e,t){super(e),this.positions=[];let i=[];if(e){let o,n=!1,r=!1,a=1;for(const t of e)if(!t.hidden){if(1===t.itemType){if(t.itemType===a)continue;o=t}else o&&(i.push(o),o=void 0),i.push(t);a=t.itemType||0,n=!!t.groupKey||n,r=t.rank>=0||r}r&&i.sort(((e,t)=>(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE))),n&&(i=s(i,t))}this.items=i}getCount(){if(void 0===this.count){this.count=0;for(const e of this.items)1===e.itemType||2===e.itemType?this.positions.push(-1):this.positions.push(++this.count)}return this.count}getItem(e){return this.items[e]}getPosition(e){return this.positions.length||this.getCount(),this.positions[e]}}class r extends i.Component{constructor(e){super(e),this.containerElement=i.createRef(),this.expandItem=(e,t)=>{if(e||-1===this.state.expandedIndex.value||(e=this.itemProvider.getItem(this.state.expandedIndex.value)),e&&e.subMenuProps)for(let i=0;i<this.itemProvider.length;i++)if(e===this.itemProvider.getItem(i)){this.state.expandedIndex.value=t?i:-1;break}},this.focus=()=>{this.containerElement.current&&this.containerElement.current.focus()},this.getParent=()=>this.props.parentMenu,this.onActivate=(e,t)=>{this.props.onActivate&&this.props.onActivate(e,t)},this.renderMenuItem=(e,t,o)=>{const{onFocusItem:s}=o,n={expandedIndex:this.state.expandedIndex,menu:this,menuProps:this.props,onActivate:this.onActivate,onFocusItem:s,position:this.itemProvider.getPosition(e),setSize:this.itemProvider.getCount()};if(t.renderMenuItem)return t.renderMenuItem(e,t,n);const r=t.id;switch(t.itemType){case 1:return a(e,t);case 2:return l(e,t);default:return i.createElement(c,{key:r,index:e,menuItem:t,details:n})}},this.state={expandedIndex:new o.ObservableValue(-1)}}render(){return i.createElement(t.Observer.Observer,{items:this.props.items},(e=>(this.itemProvider=new n(e.items,this.props.groups),this.renderList())))}renderList(){return i.createElement("div",{className:"bolt-menu-container no-outline",ref:this.containerElement,tabIndex:-1},this.itemProvider.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:"bolt-menu-spacer",onMouseDown:t.Util.preventDefault}),i.createElement(S.List,{ariaLabel:this.props.ariaLabel,className:(0,t.Util.css)(this.props.className,"bolt-menu"),columnCount:7,focuszoneProps:null,id:this.props.id,itemProvider:this.itemProvider,renderRow:this.renderMenuItem,role:"menu",virtualize:!1}),i.createElement("div",{className:"bolt-menu-spacer",onMouseDown:t.Util.preventDefault})))}}function a(e,o){return i.createElement("tr",{"aria-hidden":"true",className:(0,t.Util.css)(o.className,"bolt-menuitem-row bolt-list-row bolt-menuitem-divider"),key:o.id||"divider-"+e,onMouseDown:t.Util.preventDefault},i.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}),i.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell bolt-menuitem-divider-column",colSpan:5},i.createElement("div",{className:"bolt-menuitem-divider-content"})),i.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}))}function l(e,o){return i.createElement("tr",{"aria-level":1,className:(0,t.Util.css)(o.className,"bolt-menuitem-row bolt-list-row bolt-menuitem-header"),key:o.id||"header-"+e,onMouseDown:t.Util.preventDefault,role:"heading"},i.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}),i.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell",colSpan:3},i.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-text"},o.text)),i.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell",colSpan:3}))}t.ComponentsMenuMenu.Menu=r,t.ComponentsMenuMenu.MenuDivider=a,t.ComponentsMenuMenu.MenuHeader=l;class c extends i.Component{constructor(){super(...arguments),this.localKeyStroke=!1,this.expanded=!1,this.element=i.createRef(),this.handleClick=e=>{const t=this.props.menuItem;if(t.disabled)e.preventDefault();else if(!this.expanded){let i;t.onActivate&&(i=t.onActivate(t,e)),i||(t.href||e.preventDefault(),t.subMenuProps?this.props.details.menu.expandItem(t,!0):(t.href||void 0===t.checked||t.readonly)&&this.props.details.onActivate(t,e))}},this.onClick=e=>{e.defaultPrevented||this.handleClick(e)},this.onDismissSubMenu=e=>{!e&&this.element.current&&this.props.details.menu.expandItem(this.props.menuItem,!1)},this.onExpandedChange=e=>this.expanded&&e!==this.props.index||!this.expanded&&e===this.props.index,this.onFocus=e=>{this.element.current===document.activeElement&&this.props.details.onFocusItem(this.props.index,e)},this.onKeyDown=e=>{if(this.localKeyStroke=!0,!e.defaultPrevented){const t=this.props.menuItem;9===e.which||32===e.which?e.preventDefault():39===e.which&&t.subMenuProps&&(e.preventDefault(),this.props.details.menu.expandItem(t,!0))}},this.onKeyUp=e=>{this.localKeyStroke&&(e.defaultPrevented||13!==e.which&&32!==e.which||this.handleClick(e))},this.onMouseDown=e=>{if(!e.defaultPrevented){(this.props.menuItem.disabled||this.props.details.expandedIndex.value===this.props.index)&&e.preventDefault()}},this.onMouseEnter=()=>{this.props.menuItem.disabled||(this.element.current&&this.element.current.focus(),this.props.details.menu.expandItem(this.props.menuItem,!0),(0,t.Util.setFocusVisible)(!1))},this.onMouseLeave=()=>{this.onDismissSubMenu(!1)}}render(){const{index:e,menuItem:o,details:s}=this.props,{menu:n,position:r,setSize:a}=s,{ariaLabel:l,checked:c,className:h,disabled:u,href:p,iconProps:m,readonly:b,secondaryText:f,subMenuProps:v,target:g}=o;let{id:x,rel:w,text:I}=o;const C=p?"div":"td",E=p?"a":"tr";return p&&g&&!w&&(w="noopener"),i.createElement(t.Observer.Observer,{checked:c,expandedIndex:{observableValue:this.props.details.expandedIndex,filter:this.onExpandedChange}},(c=>(this.expanded=c.expandedIndex===e,i.createElement(t.MouseWithin.MouseWithin,{enterDelay:250,leaveDelay:250,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},(e=>i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(D=>i.createElement(t.FocusWithin.FocusWithin,{onFocus:this.onFocus},(S=>i.createElement(t.FocusZone.FocusZone,{direction:1},i.createElement(E,{"aria-label":l,"aria-checked":!0===c.checked||void 0,"aria-controls":this.expanded&&v?(0,t.Util.getSafeId)(v.id):void 0,"aria-disabled":u?"true":void 0,"aria-expanded":v?this.expanded:void 0,"aria-haspopup":!!v||void 0,"aria-posinset":r,"aria-setsize":a,className:(0,t.Util.css)(h,"bolt-menuitem-row bolt-list-row bolt-menuitem-row-normal cursor-pointer",u&&"disabled",this.expanded&&"expanded",S.hasFocus&&"focused"),"data-focuszone":u?void 0:D.focuszoneId,href:p,id:(0,t.Util.getSafeId)(x),role:void 0!==c.checked?"menuitemcheckbox":"menuitem",onBlur:S.onBlur,onClick:this.onClick,onFocus:S.onFocus,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onMouseDown:this.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,ref:this.element,rel:w,tabIndex:u?void 0:-1,target:g},i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},i.createElement("div",{className:"bolt-menuitem-cell-content flex-row"})),i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},void 0!==c.checked&&(o.renderMenuCell&&o.renderMenuCell(0,o,s)||i.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-state flex-row"},!0===b?(0,t.Icon.Icon)({className:(0,t.Util.css)(!c.checked&&"invisible"),iconName:"CheckMark"}):i.createElement(y.Checkbox,{checked:c.checked,disabled:u,excludeFocusZone:!0,excludeTabStop:!0,onChange:this.onClick})))),i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},o.renderMenuCell&&o.renderMenuCell(1,o,s)||m&&i.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-icon flex-row"},(0,t.Icon.Icon)(m))),i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},o.renderMenuCell&&o.renderMenuCell(2,o,s)||i.createElement("div",{id:(0,t.Util.getSafeId)(x+"-text"),className:"bolt-menuitem-cell-content bolt-menuitem-cell-text flex-row"},I?i.createElement(i.Fragment,null," ",I," "):i.createElement("div",null," "))),i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},o.renderMenuCell&&o.renderMenuCell(3,o,s)||f&&i.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-secondary flex-row"},f)),i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},o.renderMenuCell&&o.renderMenuCell(4,o,s)||v&&i.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-submenu flex-row"},(0,t.Icon.Icon)({iconName:"ChevronRightMed",size:"small"}),this.expanded&&this.element.current&&i.createElement(d,{anchorElement:this.element.current,anchorOffset:{horizontal:0,vertical:-8},anchorOrigin:{horizontal:"end",vertical:"start"},subMenu:!0,menuOrigin:{horizontal:"start",vertical:"start"},menuProps:v,onActivate:this.props.details.onActivate,onDismiss:this.onDismissSubMenu,parentMenu:n}))),i.createElement(C,{className:"bolt-menuitem-cell bolt-list-cell"},i.createElement("div",{className:"bolt-menuitem-cell-content flex-row"})))))))))))))}}t.ComponentsMenuMenu.MenuItem=c;class d extends i.Component{constructor(){super(...arguments),this.calloutRef=i.createRef(),this.onDismiss=()=>{this.props.onDismiss&&this.props.onDismiss(!1)},this.onKeyDown=e=>{e.defaultPrevented||(27===e.which||9===e.which||37===e.which&&this.props.subMenu)&&(e.preventDefault(),this.props.onDismiss&&this.props.onDismiss(!1))},this.onActivate=(e,t)=>{this.props.menuProps.onActivate&&this.props.menuProps.onActivate(e,t),this.props.onActivate&&this.props.onActivate(e,t),this.props.onDismiss&&this.props.onDismiss(!0)},this.preprocessKeyStroke=e=>(0,t.Util.isArrowKey)(e)?2:1}render(){let e=".bolt-menu-container",s=o.ObservableLike.getValue(this.props.menuProps.items);this.props.menuProps.items instanceof o.ObservableCollection&&(s=s.slice());const n=s.sort(((e,t)=>(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE)));for(let i=0;i<n.length;i++)if(0===n[i].itemType||void 0===n[i].itemType){const o=n[i].id;if(!o||n[i].disabled)continue;e=(0,t.Util.getSafeIdSelector)(o);break}return i.createElement(t.Observer.Observer,{menuItems:{observableValue:this.props.menuProps.items,filter:()=>{var e;return null===(e=this.calloutRef.current)||void 0===e||e.updateLayout(),!1}}},(()=>i.createElement(t.Callout.Callout,{ref:this.calloutRef,anchorElement:this.props.anchorElement,anchorOffset:this.props.anchorOffset,anchorOrigin:this.props.anchorOrigin,anchorPoint:this.props.anchorPoint,blurDismiss:!0,calloutOrigin:this.props.menuOrigin,className:this.props.className,contentClassName:(0,t.Util.css)("bolt-contextual-menu flex-column custom-scrollbar depth-8",this.props.subMenu&&"bolt-contextual-submenu"),contentShadow:!0,onDismiss:this.onDismiss,fixedLayout:this.props.fixedLayout,focuszoneProps:{defaultActiveElement:e,direction:2,focusOnMount:!0,preprocessKeyStroke:this.preprocessKeyStroke,circularNavigation:!0},id:this.props.menuProps.id+"-callout",portalProps:{className:"bolt-menu-portal"}},i.createElement("div",{className:"bolt-contextualmenu-container",onKeyDown:this.onKeyDown},i.createElement(r,Object.assign({},this.props.menuProps,{onActivate:this.onActivate,parentMenu:this.props.parentMenu}))))))}}t.ComponentsMenuMenu.ContextualMenu=d}(),function(e){P=t[e]={};let o=1;class s extends i.Component{constructor(e){super(e),this.dropdownButton=i.createRef(),this.expand=()=>{this.dropdownButton.current&&this.dropdownButton.current.expand()},this.collapse=()=>{this.dropdownButton.current&&this.dropdownButton.current.collapse()},this.renderMenu=(e,t,o,s,n,r,a)=>{const l="function"==typeof this.props.contextualMenuProps?this.props.contextualMenuProps():this.props.contextualMenuProps;return i.createElement(M.ContextualMenu,{anchorElement:o,anchorOffset:l.anchorOffset||s,anchorOrigin:l.anchorOrigin||n,anchorPoint:l.anchorPoint||r,fixedLayout:l.fixedLayout,menuOrigin:l.menuOrigin||a,menuProps:l.menuProps,className:l.className,onActivate:(t,i)=>{l.onActivate&&l.onActivate(t,i),e.collapse()},onDismiss:e.collapse})},this.state={id:this.props.id||"menu-button-"+o++}}render(){const{contextualMenuProps:e,hideDropdownIcon:t}=this.props;return i.createElement(u.ExpandableButton,Object.assign({},Object.assign(Object.assign({},this.props),{menuProps:void 0}),{hideDropdownIcon:t,id:this.state.id,ref:this.dropdownButton,renderCallout:this.renderMenu}),this.props.children)}focus(){this.dropdownButton.current&&this.dropdownButton.current.focus()}}t[e].MenuButton=s}("ComponentsMenuMenuButton"),function(e){L=t[e]={};class o extends i.Component{constructor(){super(...arguments),this.menuButton=i.createRef(),this.expand=()=>{this.menuButton.current&&this.menuButton.current.expand()},this.collapse=()=>{this.menuButton.current&&this.menuButton.current.collapse()}}render(){return i.createElement(P.MenuButton,Object.assign({ariaLabel:a.MoreActions,hideDropdownIcon:!0,iconProps:{iconName:"MoreVertical"},ref:this.menuButton,subtle:!0,tooltipProps:{text:a.MoreActions}},this.props))}focus(){this.menuButton.current&&this.menuButton.current.focus()}}t[e].MoreButton=o}("ComponentsMenuMoreButton"),function(e){k=t.ComponentsPillPill={};class o extends i.Component{constructor(e){super(e),this.getChildText=()=>{let e="";return i.Children.map(this.props.children,(t=>{"string"==typeof t&&(e+=t)})),e},this.onKeyDown=e=>{13===e.which&&this.props.onClick&&this.props.onClick()},this.onMouseEnter=e=>{this.props.onMouseEnter&&this.props.onMouseEnter(e),this.setState({isHoveringPrimaryElement:!0})},this.onMouseLeave=e=>{this.props.onMouseLeave&&this.props.onMouseLeave(e),this.setState({isHoveringPrimaryElement:!1})},this.onMouseLeaveButton=()=>{this.setState({isHoveringPrimaryElement:!0})},this.onMouseOverButton=()=>{this.setState({isHoveringPrimaryElement:!1})},this.state={isHoveringPrimaryElement:!1}}static getColorStyle(e,i,o){if(!e)return;const s=o&&i?(0,t.UtilitiesColor.darken)(e,.06):e;return{backgroundColor:(0,t.UtilitiesColor.getColorString)(s)}}static getSizeClass(e){switch(e){case 0:return"compact";case 2:return"large";default:return"regular"}}static getVariantClass(e,i){switch(e){case 1:return"outlined";case 2:return i?(0,t.Util.css)("colored",(0,t.UtilitiesColor.isDark)(i)?"dark":"light"):"standard";case 3:return"themed-standard";default:return"standard"}}static getDerivedStateFromProps(e,t){return t}render(){const{ariaHidden:e,contentClassName:s,className:r,color:l,containsCount:c=!1,iconProps:d,id:h,onClick:p,onBlur:m,onFocus:b,onRemoveClick:f,onRenderFilledVisual:v,size:g=1,variant:x=0}=this.props,{isHoveringPrimaryElement:w}=this.state,I=this.props.ariaLabel||this.getChildText();return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(C=>i.createElement("div",{className:(0,t.Util.css)(r,"bolt-pill flex-row flex-center",o.getVariantClass(x,l),o.getSizeClass(g),c&&"count",w&&"hover",p&&"clickable",v&&"has-filled-visual",d&&!v&&"has-icon",f&&"has-remove-button"),id:(0,t.Util.getSafeId)(h),onClick:p,onBlur:m,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:o.getColorStyle(l,w,p)},v&&i.createElement("div",{className:"bolt-pill-filled-visual flex-noshrink"},v()),d&&!v&&i.createElement(t.Icon.Icon,Object.assign({},d,{className:(0,t.Util.css)(d.className,"bolt-pill-icon")})),i.createElement("div",{"aria-label":I,"aria-hidden":e,className:(0,t.Util.css)(s,"bolt-pill-content text-ellipsis"),"data-focuszone":this.props.excludeFocusZone?void 0:C.focuszoneId,onFocus:b,onKeyDown:this.onKeyDown,role:p?"button":"presentation",tabIndex:p||b?(0,t.UtilitiesFocus.getTabIndex)(this.props):void 0},this.props.children),f&&i.createElement(u.Button,{ariaLabel:(0,n.format)(a.RemovePillLabel,I),className:"bolt-pill-button",iconProps:{iconName:"Cancel",size:""},onClick:f,onMouseLeave:this.onMouseLeaveButton,onMouseOver:this.onMouseOverButton,subtle:!0,tooltipProps:{text:(0,n.format)(a.RemovePillLabel,I)}}))))}}t.ComponentsPillPill.Pill=o}(),O=t.Pill={},Object.defineProperty(t.Pill,"Pill",{enumerable:!0,get:function(){return k.Pill}}),function(e){T=t[e]={};class o extends i.Component{constructor(e){super(e),this.observing=!1,this.onClick=e=>{this.setState({overflow:this.state.overflow===this.props.overflow?1:this.props.overflow}),null==e||e.preventDefault()},this.observeElement=e=>{e&&this.intersectionContext&&!this.observing&&(this.intersectionContext.observe(e),this.observing=!0)},this.onIntersect=e=>{this.setState({overflowing:Math.round(e[0].rootBounds.right)<Math.round(e[0].boundingClientRect.right)})},this.state={overflowing:!1,overflow:this.props.overflow}}render(){const{onMouseEnter:e,onMouseLeave:o}=this.props,{overflow:s}=this.state;let n,r;return r=i.createElement(O.Pill,{size:0},i.createElement(u.Button,{ariaLabel:this.state.overflow===this.props.overflow?a.ShowMore:a.ShowLess,className:"bolt-pill-button",iconProps:{iconName:"More",size:""},onClick:this.onClick,subtle:!0,tooltipProps:{text:this.state.overflow===this.props.overflow?a.ShowMore:a.ShowLess}})),n=2===s?i.createElement(t.Intersection.IntersectionContext.Consumer,null,(e=>(this.intersectionContext=e,i.createElement("div",{className:"bolt-pill-overflow flex-row"},i.createElement("div",{className:"bolt-pill-group-inner flex-row"},this.state.overflowing&&r,this.props.children),i.createElement("div",{className:"bolt-pill-observe",ref:e=>this.observeElement(e)}))))):i.createElement("div",{className:"bolt-pill-group-inner flex-row"},this.state.overflowing&&r,this.props.children),n=i.createElement("div",{className:(0,t.Util.css)(this.props.className,"bolt-pill-group flex-row",1===s?"overflow-wrap":2===s?this.state.overflowing&&"overflow-fade":void 0),onMouseEnter:e,onMouseLeave:o},n),2===s&&(n=i.createElement(t.Intersection.Intersection,null,n)),n}componentDidMount(){this.intersectionContext&&this.intersectionContext.register(this.onIntersect)}componentWillUnmount(){this.intersectionContext&&this.intersectionContext.unregister(this.onIntersect)}}t[e].PillGroup=o}("ComponentsPillGroupPillGroup"),R=t.FormItem={},Object.defineProperty(t.FormItem,"FormItem",{enumerable:!0,get:function(){return b.FormItem}}),Object.defineProperty(t.FormItem,"FormItemContext",{enumerable:!0,get:function(){return b.FormItemContext}}),function(e){z=t[e]={},t[e].RadioButtonGroupContext=i.createContext({onSelect:t.Util.noop,registerId:t.Util.noop});class s extends i.Component{constructor(){super(...arguments),this.focusGroupContext=i.createRef(),this.idMap={},this.onChange=e=>{this.props.onSelect&&this.props.onSelect(e)},this.getFirstButtonId=()=>{const e=i.Children.toArray(this.props.children);if(e.length){return e[0].props.id}},this.postProcessKeystroke=e=>{if(document.activeElement&&(0,t.Util.isArrowKey)(e)){const e=this.idMap[document.activeElement.id];e&&e!==o.ObservableLike.getValue(this.props.selectedButtonId||"")&&this.props.onSelect&&this.props.onSelect(e)}return 1},this.registerId=(e,t)=>{this.idMap[e]=t}}render(){const{className:o,defaultButtonId:s,direction:n,excludeFocusZone:r,id:a,selectedButtonId:l,text:c}=this.props,d=(0,t.Util.css)("bolt-radio-button-group",2===n?"flex-column":"flex-row",this.props.groupClassName);return i.createElement(t.Observer.Observer,{selectedButtonId:l},(l=>i.createElement(t[e].RadioButtonGroupContext.Provider,{value:{onSelect:this.onChange,registerId:this.registerId,selectedButtonId:l.selectedButtonId||this.getFirstButtonId()}},i.createElement(R.FormItem,{className:(0,t.Util.css)(o,"bolt-radio-button-group-container",r&&d),label:c},r?this.props.children:i.createElement(R.FormItemContext.Consumer,null,(e=>i.createElement(t.FocusZone.FocusZone,{direction:2===n?2:1,circularNavigation:!0,focusGroupProps:{defaultElementId:s||l.selectedButtonId||this.getFirstButtonId(),ref:this.focusGroupContext},postprocessKeyStroke:this.postProcessKeystroke},i.createElement("div",{"aria-labelledby":(0,t.Util.getSafeId)(e.ariaLabelledById),className:d,role:"radiogroup",id:(0,t.Util.getSafeId)(a)},this.props.children))))))))}focus(){this.focusGroupContext.current&&this.focusGroupContext.current.focus()}}t[e].RadioButtonGroup=s,s.defaultProps={direction:2};class n extends i.Component{constructor(){super(...arguments),this.radioButtonInternal=i.createRef()}render(){return i.createElement(t[e].RadioButtonGroupContext.Consumer,null,(e=>i.createElement(t.FocusGroup.FocusGroupContext.Consumer,null,(o=>i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(t=>i.createElement(r,Object.assign({},this.props,{focusGroupContext:o,focuszoneId:t.focuszoneId,onFocus:o.onFocus,onSelect:e.onSelect,registerId:e.registerId,selectedButton:e.selectedButtonId===this.props.id,ref:this.radioButtonInternal}))))))))}focus(){this.radioButtonInternal.current&&this.radioButtonInternal.current.focus()}}t[e].RadioButton=n;class r extends i.Component{constructor(){super(...arguments),this.radioButton=i.createRef(),this.onClick=e=>{e.defaultPrevented||this.props.disabled||(this.props.onSelect(this.props.id),e.preventDefault())},this.onFocus=e=>{this.props.onFocus(this.props.id)}}render(){const e=(0,t.UtilitiesFocus.getTabIndex)(this.props,this.props.focusGroupContext),o=this.props.text&&"rb-label-"+this.props.id;let s=i.createElement("div",{"aria-checked":this.props.selectedButton,"aria-disabled":this.props.disabled,"aria-labelledby":(0,t.Util.getSafeId)(this.props.ariaLabelledBy||o),"aria-describedby":(0,t.Util.getSafeId)(this.props.ariaDescribedBy),className:(0,t.Util.css)(this.props.className,"bolt-radio-button cursor-pointer",this.props.disabled?"disabled":"enabled",this.props.selectedButton&&"checked",(this.props.text||i.Children.count(this.props.children)>0)&&"labelled","bolt-focus-treatment"),"data-focuszone":this.props.disabled||this.props.excludeFocusZone?void 0:this.props.focuszoneId,"data-is-focusable":this.props.disabled?"false":"true",id:(0,t.Util.getSafeId)(this.props.id),key:this.props.id,onClick:this.onClick,onFocus:this.onFocus,ref:this.radioButton,role:this.props.role||"radio",tabIndex:e},i.createElement("div",{className:"bolt-radio-button-icon"},i.createElement("div",{className:"bolt-radio-button-bullet"})),this.props.text&&i.createElement("div",{className:"bolt-radio-button-label",id:(0,t.Util.getSafeId)(o)},this.props.text),this.props.children);return this.props.tooltipProps&&(s=i.createElement(t.TooltipEx.Tooltip,Object.assign({},this.props.tooltipProps),s)),s}componentDidMount(){const{id:e,registerId:i}=this.props;i((0,t.Util.getSafeId)(e),e)}focus(){this.radioButton.current&&this.radioButton.current.focus()}}}("ComponentsRadioButtonRadioButton"),function(e){N=t[e]={},t[e].ResizeGroupContext=i.createContext({});class s extends i.Component{constructor(e){super(e),this.onLayoutChange=e=>{this.state.hiddenCount.value=e,this.props.responsiveLayoutProps.onLayoutChange&&this.props.responsiveLayoutProps.onLayoutChange(e),s.updateOverflowItems(this.props,this.state)};const t=this.props.extraItems||[];this.state={hiddenCount:new o.ObservableValue(0),overflowItems:new o.ObservableArray([...t]),editedItems:[]}}static getDerivedStateFromProps(e,t){return s.updateOverflowItems(e,t),t}render(){return i.createElement(t[e].ResizeGroupContext.Provider,{value:{overflowItems:this.state.overflowItems}},i.createElement(t.ResponsiveLayout.ResponsiveLayout,Object.assign({},this.props.responsiveLayoutProps,{onLayoutChange:this.onLayoutChange}),this.props.children))}static updateOverflowItems(e,t){const i=e.extraItems||[];t.overflowItems.value=[...i,...e.overflowMenuItems.slice(0,t.hiddenCount.value)],e.useAriaLabelForOverflow&&(t.editedItems.forEach((e=>e.text="")),t.editedItems=[],t.overflowItems.value.forEach((e=>{!e.text&&e.ariaLabel&&(e.text=e.ariaLabel,t.editedItems.push(e))})))}}t[e].ResizeGroup=s}("ComponentsResizeGroupResizeGroup"),function(e){F=t[e]={};class o extends i.Component{constructor(){super(...arguments),this.moreButton=i.createRef()}render(){return i.createElement(N.ResizeGroupContext.Consumer,null,(e=>i.createElement(t.Observer.Observer,{menuItems:e.overflowItems},(e=>e.menuItems&&e.menuItems.length>0?i.createElement(L.MoreButton,Object.assign({contextualMenuProps:{menuProps:{id:"overflow-menu",items:e.menuItems}},ref:this.moreButton},this.props)):i.createElement("div",null)))))}focus(){this.moreButton.current&&this.moreButton.current.focus()}}t[e].OverflowButton=o}("ComponentsResizeGroupOverflowButton"),function(e){B=t[e]={};class l extends i.Component{constructor(e){super(e),this.lastLocation=-1,this.timerManagement=new r.TimerManagement,this.state={showPortal:!1},this.onDragStart=e=>{e.preventDefault()},this.onMouseCapture=e=>{this.lastLocation+=this.updateSize(e,this.getMouseLocation(e)-this.lastLocation),"mouseup"===e.type&&(this.setState({showPortal:!1}),this.onSizeEnd())},this.onKeyDown=e=>{var t;if(!e.defaultPrevented){const{orientation:i}=this.props;let o;if(0===i){if(13===e.which){let i=this.props.getFocusedElement(e);null===(t=null==i?void 0:i.current)||void 0===t||t.focus()}37===e.which?o=this.updateSize(e.nativeEvent,-1):39===e.which&&(o=this.updateSize(e.nativeEvent,1))}else 38===e.which?o=this.updateSize(e.nativeEvent,-1):40===e.which&&(o=this.updateSize(e.nativeEvent,1));o&&(e.preventDefault(),this.debouncedEnd())}},this.onSizeEnd=()=>{this.props.onSizeEnd&&this.props.onSizeEnd(this.props.id)},this.onMouseDown=e=>{e.defaultPrevented||(this.lastLocation=this.getMouseLocation(e.nativeEvent),t.Util.Mouse.setCapture(this.onMouseCapture),this.setState({showPortal:!0}),e.preventDefault())},this.onFocus=e=>{(0,s.announce)((0,n.format)(a.SizerLabel,this.props.size,this.props.minSize,this.props.maxSize),!0)},this.debouncedEnd=this.timerManagement.debounce(this.onSizeEnd,500,{trailing:!0})}render(){const{divider:e}=this.props;return i.createElement("div",{"aria-label":this.props.ariaLabel,"aria-valuemin":this.props.minSize,"aria-valuemax":this.props.maxSize,"aria-valuenow":o.ObservableLike.getValue(this.props.size),className:(0,t.Util.css)(this.props.className,"bolt-sizer",0===this.props.orientation?"bolt-sizer-row flex-row":"bolt-sizer-column flex-column",e&&"divider"),id:this.props.id,onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDown,onDragStart:this.onDragStart,role:"separator",tabIndex:this.props.tabIndex,onFocus:this.onFocus},this.state.showPortal&&i.createElement(t.Portal.Portal,{className:(0,t.Util.css)("bolt-sizer-portal",0===this.props.orientation?"bolt-sizer-portal-row":"bolt-sizer-portal-column")},i.createElement("div",null)))}componentWillUnmount(){t.Util.Mouse.releaseCapture(this.onMouseCapture),this.timerManagement.dispose()}getMouseLocation(e){return 0===this.props.orientation?e.pageX:e.pageY}updateSize(e,t){const i=o.ObservableLike.getValue(this.props.size),r=1===this.props.position?-1:1,l=Math.floor(Math.min(this.props.maxSize,Math.max(this.props.minSize,i+t*r)));return this.props.onSize(e,l,this.props.id),(0,s.announce)((0,n.format)(a.SizerValueChanged,l),!0),(l-i)*r}}t[e].Sizer=l,l.defaultProps={divider:!0,maxSize:1e4,minSize:100},t[e].Sized=function(e){return i.createElement(t.Observer.Observer,{height:e.height,width:e.width},(o=>{const s={};return void 0!==o.height&&(s.height=o.height+"px"),void 0!==o.width&&(s.width=o.width+"px"),i.createElement("div",{className:(0,t.Util.css)(e.className,"flex-noshrink"),style:s},e.children)}))}}("ComponentsSizerSizer"),U=t.Menu={},Object.defineProperty(t.Menu,"ContextMenuBehavior",{enumerable:!0,get:function(){return D.ContextMenuBehavior}}),Object.defineProperty(t.Menu,"ContextualMenu",{enumerable:!0,get:function(){return M.ContextualMenu}}),Object.defineProperty(t.Menu,"groupMenuItems",{enumerable:!0,get:function(){return M.groupMenuItems}}),Object.defineProperty(t.Menu,"Menu",{enumerable:!0,get:function(){return M.Menu}}),Object.defineProperty(t.Menu,"MenuButton",{enumerable:!0,get:function(){return P.MenuButton}}),Object.defineProperty(t.Menu,"MoreButton",{enumerable:!0,get:function(){return L.MoreButton}}),function(e){A=t[e]={},t[e].SplitButton=function(e){const o=i.useRef(),s=e.expandableRef||i.useRef(),{buttonRef:n,buttonProps:r,className:l,disabled:c,menuButtonProps:d,primary:h,subtle:p}=e,m=()=>{const t="function"==typeof e.menuButtonProps.contextualMenuProps?e.menuButtonProps.contextualMenuProps():e.menuButtonProps.contextualMenuProps;return i.createElement(U.ContextualMenu,{anchorElement:o.current,anchorOrigin:{horizontal:"end",vertical:"end"},menuOrigin:{horizontal:"end",vertical:"start"},menuProps:t.menuProps,onActivate:(e,i)=>{t.onActivate&&t.onActivate(e,i),s.current&&s.current.collapse()},onDismiss:()=>s.current&&s.current.collapse()})};return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(b=>{let f=i.createElement("div",{className:(0,t.Util.css)(l,"bolt-split-button flex-stretch inline-flex-row"),ref:o},i.createElement(u.Button,Object.assign({},r,{className:(0,t.Util.css)("bolt-split-button-main",r.className),disabled:c||r.disabled,focusZoneId:2===b.direction?b.focuszoneId:void 0,primary:h,subtle:p,ref:n})),i.createElement("div",{className:(0,t.Util.css)("bolt-split-button-divider flex-noshrink",h&&"primary",c&&"disabled")}),i.createElement(t.Expandable.Expandable,{disabled:c,onCollapse:d.onCollapse,onExpand:d.onExpand,ref:s,renderCallout:e.renderCallout||m},(e=>i.createElement("div",{className:"inline-flex-row",onMouseDown:e.onMouseDown,onKeyDown:e.onKeyDown},i.createElement(u.Button,Object.assign({ariaExpanded:e.expanded,ariaLabel:a.MoreActions,iconProps:{iconName:"ChevronDownMed",size:"small"},text:void 0},d,{className:(0,t.Util.css)("bolt-split-button-option flex-self-stretch body-s",d.className,e.expanded&&"active"),disabled:c,onClick:e.onClick,primary:h,subtle:p}))))));return 1!==b.direction&&(f=i.createElement(t.FocusZone.FocusZone,{direction:1},f)),f}))}}("ComponentsSplitButtonSplitButton"),function(e){j=t[e]={};t[e].ColumnMore=class{constructor(e,s,n,r=2.625,l){this.ariaLabel=a.MoreActions,this.columnLayout=0,this.id="_more",this.widthStyle=1,this.renderCell=(e,o,s,n)=>{var r;const l=i.createRef();return this.refs&&!this.refs.value[e]&&(this.refs.value[e]=l),i.createElement("td",{"aria-colindex":o+1,className:(0,t.Util.css)("bolt-table-cell-side-action bolt-table-cell bolt-list-cell","col-"+o),"data-column-index":o,key:"col-more",onClick:this.onClick,onDoubleClick:t.Util.preventDefault,onKeyDown:this.onKeyDown,onMouseDown:t.Util.preventDefault},!this.menuAvailable||this.menuAvailable(n)?i.createElement("div",{className:"bolt-table-cell-content-reveal flex-row justify-center"},i.createElement(u.ExpandableButton,{ariaLabel:a.MoreTooltip,className:"bolt-table-button-more",excludeTabStop:!0,hideDropdownIcon:!0,iconProps:{className:"small",iconName:"MoreVertical"},onClick:t=>{this.onActivate&&this.onActivate(e,o,t)},ref:null===(r=this.refs)||void 0===r?void 0:r.value[e],renderCallout:(t,o,s)=>i.createElement(U.ContextualMenu,{anchorElement:s,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:this.menuProvider(n,e,l),menuOrigin:{horizontal:"end",vertical:"start"},onDismiss:t.collapse}),subtle:!0,tooltipProps:{text:a.MoreTooltip}})):i.createElement("span",{className:"bolt-table-cell-content visually-hidden"},a.NoMoreActions))},this.renderHeaderCell=(e,o)=>i.createElement("th",{"aria-colindex":e+1,"aria-label":o.ariaLabel,className:(0,t.Util.css)(o.headerClassName,"bolt-table-header-cell","col-header-"+e),"data-column-index":e,key:"col-more"},i.createElement("span",{className:"visually-hidden"},o.ariaLabel)),this.onClick=e=>{e.defaultPrevented||(0,t.Util.eventTargetContainsNode)(e,["A"],document.body)||e.preventDefault()},this.onKeyDown=e=>{e.defaultPrevented||13!==e.which&&32!==e.which||(0,t.Util.eventTargetContainsNode)(e,["A"])||e.preventDefault()},this.menuAvailable=s,this.menuProvider=e,this.onActivate=n,this.width=new o.ObservableValue(r),this.refs=l}}}("ComponentsTableColumnMore"),function(e){H=t[e]={};t[e].ColumnSelect=class{constructor(e){this.columnSelectBehavior={initialize:e=>{this.ariaHidden="menu"===e.tableProps.role,this.itemProvider=e.tableProps.itemProvider,this.selection=e.tableProps.selection,this.onSelect=e.tableProps.onSelect},componentDidMount:e=>{this.componentDidMount(e)},componentDidUpdate:e=>{this.componentDidUpdate(e)},componentWillUnmount:()=>{this.componentWillUnmount()}},this.allSelected=new o.ObservableValue(!1),this.columnLayout=0,this.id="_select",this.width=2.5,this.widthStyle=1,this.behaviors=[this.columnSelectBehavior],this.renderCell=(e,o,s)=>{var n,r,l;const{selection:c}=this,d=c&&c.selected(e),h=c&&c.selectable(e);return i.createElement("td",{"aria-colindex":o+1,"aria-hidden":this.ariaHidden,className:(0,t.Util.css)("bolt-table-cell-select bolt-table-cell bolt-list-cell","col-"+o),"data-column-index":o,key:"col-select",onClick:t.Util.preventDefault,onDoubleClick:t.Util.preventDefault,onMouseDown:t=>{this.updateSelection(t,e),t.preventDefault()},onKeyDown:t=>{32===t.which&&(this.updateSelection(t,e),t.preventDefault())}},i.createElement("div",{className:"flex-row justify-center"},i.createElement("span",{className:"flex-row-inline"},i.createElement(y.Checkbox,{role:null===(n=this.props)||void 0===n?void 0:n.role,ariaLabel:"presentation"===(null===(r=this.props)||void 0===r?void 0:r.role)?void 0:a.SelectRowLabel,checked:!!d,excludeFocusZone:null===(l=this.props)||void 0===l?void 0:l.excludeFocusZone,excludeTabStop:!0,disabled:!h}))))},this.renderHeaderCell=(e,o,s)=>i.createElement("th",{"aria-colindex":e+1,className:(0,t.Util.css)("bolt-table-cell-select bolt-table-header-cell","col-header-"+e),"data-column-index":e,key:"col-select"},i.createElement("div",{className:"flex-row"},i.createElement(t.Observer.Observer,{allSelected:this.allSelected},(e=>{var t,n;const{itemProvider:r,selection:l}=this,c=r&&r.length;return l&&l.multiSelect&&-1!==c?i.createElement("div",{className:"flex-row flex-grow justify-center"},i.createElement(y.TriStateCheckbox,{ariaLabel:null!==(t=o.ariaLabel)&&void 0!==t?t:a.SelectAllRowsLabel,checked:e.allSelected,focuszoneId:s,onChange:this.onChangeHeader})):i.createElement("div",{className:"visually-hidden"},null!==(n=o.ariaLabel)&&void 0!==n?n:a.SelectionColumnLabel)})))),this.onChangeHeader=e=>{const{itemProvider:t,onSelect:i,selection:o}=this;if(o&&(!1!==this.allSelected.value?(o.clear(),(0,s.announce)(a.AllRowsUnselectedMessage,!0)):(o.select(0,t&&t.length),(0,s.announce)(a.AllRowsSelectedMessage,!0))),i&&t)for(let o=0;o<t.length;o++)i(e,this.getListRow(o))},this.onSelectionChange=()=>{const{itemProvider:e,selection:t}=this;if(t){const i=t.selectedCount,o=e&&e.length-t.unselectableCount;this.allSelected.value=i>0&&(i===o||void 0)}},this.updateSelection=(e,t)=>{const{onSelect:i,selection:o}=this;if(o&&(o.selected(t)?o.unselect(t):o.select(t,1,!0)),i){i(e,this.getListRow(t))}},this.getListRow=e=>({data:this.itemProvider?this.itemProvider.value[e]:{},index:e}),this.props=e}componentDidMount(e){const{itemProvider:t,selection:i}=this;i&&(i.subscribe(this.onSelectionChange),this.onSelectionChange()),t&&t.subscribe&&t.subscribe(this.onSelectionChange)}componentDidUpdate(e){let{selection:t}=this;t!==e.tableProps.selection&&(t&&t.unsubscribe(this.onSelectionChange),t=e.tableProps.selection,this.selection=t,t&&t.subscribe(this.onSelectionChange)),t&&this.onSelectionChange(),this.itemProvider!==e.tableProps.itemProvider&&(this.itemProvider&&this.itemProvider.unsubscribe&&this.itemProvider.unsubscribe(this.onSelectionChange),this.itemProvider=e.tableProps.itemProvider,this.itemProvider&&this.itemProvider.subscribe&&this.itemProvider.subscribe(this.onSelectionChange))}componentWillUnmount(){const{selection:e}=this;e&&e.unsubscribe(this.onSelectionChange),this.itemProvider&&this.itemProvider.unsubscribe&&this.itemProvider.unsubscribe(this.onSelectionChange)}}}("ComponentsTableColumnSelect"),function(e){K=t[e]={};t[e].ColumnSorting=class{constructor(e){this.initialize=(e,t,i)=>{this.props=e,this.eventDispatch=i,i.addEventListener("click",this.onClick),i.addEventListener("keydown",this.onKeyDown)},this.componentDidMount=e=>{this.props=e},this.componentDidUpdate=e=>{this.props=e},this.componentWillUnmount=()=>{this.eventDispatch&&(this.eventDispatch.removeEventListener("click",this.onClick),this.eventDispatch.removeEventListener("keydown",this.onKeyDown))},this.onClick=e=>{e.defaultPrevented||this.processSortEvent(e,!0)},this.onKeyDown=e=>{e.defaultPrevented||13!==e.which&&32!==e.which||this.processSortEvent(e)},this.onSort=e}processSortEvent(e,i){var o,n;const r=(0,S.cellFromEvent)(e);let l=e.target,c=!i&&l.classList.contains("bolt-table-header-cell-actionable");if(l.classList.contains("bolt-table-header-sizer")){let e=l.closest(".bolt-table-header-cell-actionable");e&&(e.focus(),(0,t.Util.setFocusVisible)(!0))}for(;!c&&l!==r.cellElement&&l.parentElement;)l=l.parentElement,c=l.classList.contains("bolt-table-header-cell-actionable");if(-1===r.rowIndex&&c){const t=this.props.columns[r.cellIndex];if(t&&t.sortProps){this.onSort(r.cellIndex,0===t.sortProps.sortOrder?1:0,e);const i=0===t.sortProps.sortOrder?null!==(o=t.sortProps.ariaLabelAscending)&&void 0!==o?o:a.ColumnSortedAscendingAnnouncement:null!==(n=t.sortProps.ariaLabelDescending)&&void 0!==n?n:a.ColumnSortedDescendingAnnouncement;(0,s.announce)(i,!0),e.preventDefault()}}}},t[e].sortItems=function(e,t,i,o,s){let n=i[e];n&&1===t&&(n=(t,o)=>-i[e](t,o));for(let i=0;i<o.length;i++){const s=o[i];s.sortProps&&(s.sortProps.sortOrder=i===e?t:void 0)}return n?s.sort(n):s}}("ComponentsTableColumnSorting"),function(e){W=t[e]={};class o extends i.Component{render(){return i.createElement("div",{className:"bolt-gripper-container bolt-table-cell-content-reveal"},i.createElement("div",{className:"bolt-gripper"}))}}t[e].DragAndDropGripper=o,t[e].renderGripper=function(e,t){return t?i.createElement(o,null):null}}("ComponentsTableDragAndDropGripper"),V=t.Sizer={},Object.defineProperty(t.Sizer,"Sized",{enumerable:!0,get:function(){return B.Sized}}),Object.defineProperty(t.Sizer,"Sizer",{enumerable:!0,get:function(){return B.Sizer}}),function(e){G=t[e]={},t[e].TableBreakpoint=function(e){const s=[];for(let t=0;t<e.breakpoints.length;t++)s.push(e.breakpoints[t].breakpoint);return i.createElement(t.Breakpoint.Breakpoint,{breakpoints:s,onBreakpoint:function(t,i){const{columnWidths:s}=e.breakpoints[Math.max(0,t)];for(let t=0;t<s.length;t++)o.ObservableLike.isObservable(e.columnWidths[t])&&(e.columnWidths[t].value=s[t]);e.onBreakpoint&&e.onBreakpoint(t,i)}})}}("ComponentsTableTableBreakpoint"),function(e){Z=t[e]={},t[e].ColumnFillId="_fill",t[e].ColumnFill={columnLayout:0,id:t[e].ColumnFillId,renderCell:(e,o)=>i.createElement("td",{key:"col-fill","aria-colindex":o+1,"aria-hidden":!0,className:(0,t.Util.css)("bolt-table-cell bolt-list-cell","col-"+o),"data-column-index":o,role:"presentation"}),renderHeaderCell:(e,o)=>i.createElement("th",{key:"col-fill","aria-hidden":!0,className:(0,t.Util.css)(o.headerClassName,"bolt-table-header-cell bolt-table-header-cell-empty","col-header-"+e),"data-column-index":e,role:"presentation"}),width:-100};class r extends i.Component{constructor(e){super(e),this.currentElement=i.createRef(),this.list=i.createRef(),this.onBreakpoint=()=>{const e=this.props.tableBreakpoints?c(this.props.columns).map((({originalIndex:e})=>e)).join(","):"";(this.state.renderInvisible||this.state.visibleColumnsKey!==e)&&this.setState({renderInvisible:!1,visibleColumnsKey:e})},this.onColumnsChanged=()=>(this.forceUpdate(),!1),this.renderHeader=()=>{const{columns:e,showHeader:s,renderHeader:n,spacerWidth:r}=this.props,a=[];let l=0;for(let t=0;t<e.length;t++){const i=o.ObservableLike.getValue(e[t].width);i<0&&(l+=i)}for(let t=0;t<e.length;t++){const i=o.ObservableLike.getValue(e[t].width);a[t]=i>=0?i:-i/l*100}let d=null;return!1!==s&&(d=n?n(e):i.createElement(h,{tableColumns:e})),"function"==typeof s&&(d=i.createElement(t.UtilitiesScreenSize.ScreenSizeConditional,{condition:e=>s(e)},d)),i.createElement(i.Fragment,null,i.createElement("colgroup",null,i.createElement("col",{key:"col-group-left-spacer",style:{width:0===r?r+"%":r+"px"}}),c(e).map((({column:e,originalIndex:o})=>{const{widthStyle:s=0}=e;return i.createElement(t.Observer.Observer,{key:"col-group-"+o,width:{filter:this.onColumnsChanged,observableValue:e.width}},(()=>i.createElement("col",{style:{width:Math.abs(a[o])+(a[o]<0?"%":0===s?"px":"rem")}})))})),i.createElement("col",{key:"col-group-right-spacer",style:{width:0===r?r+"%":r+"px"}})),d)},this.renderLoadingRow=(e,t)=>{var o;const{columns:s,renderLoadingRow:n}=this.props,r={ariaBusy:!0,ariaRowOffset:t.ariaRowOffset,data:t.data,eventDispatch:this.state.eventDispatch,excludeFocusZone:!0,excludeTabStop:null!==(o=this.props.excludeTabStop)&&void 0!==o?o:t.excludeTabStop,itemProvider:this.props.itemProvider,listProps:t.listProps,onFocusItem:t.onFocusItem,renderSpacer:this.props.renderSpacer,selection:this.props.selection,singleClickActivation:this.props.onActivate&&this.props.singleClickActivation};return n?n(e,r):i.createElement(b,{columns:s,details:r,rowIndex:e})},this.renderRow=(e,t,o)=>{var s;const n={selectableText:o.selectableText,ariaRowOffset:o.ariaRowOffset,eventDispatch:this.state.eventDispatch,data:o.data,excludeTabStop:null!==(s=this.props.excludeTabStop)&&void 0!==s?s:o.excludeTabStop,itemProvider:this.props.itemProvider,listProps:o.listProps,onFocusItem:o.onFocusItem,renderSpacer:this.props.renderSpacer,selection:this.props.selection,singleClickActivation:this.props.onActivate&&this.props.singleClickActivation,role:"tree"===this.props.role?"treeitem":void 0},r=t.renderRow||this.props.renderRow;return r?r(e,t,n):i.createElement(m,{details:n,index:e,linkProps:t.linkProps},l(e,this.props.columns,t,n))},this.state={columnBehaviors:[],eventDispatch:e.eventDispatch||new t.UtilitiesDispatch.EventDispatch,renderInvisible:!!e.tableBreakpoints,visibleColumnsKey:"",tableBehaviors:[],tableWidth:""};for(let t=0;t<e.columns.length;t++){const i=e.columns[t];if(i.behaviors)for(const o of i.behaviors)o&&o.initialize&&o.initialize({tableProps:e,columnIndex:t},{},this.state.eventDispatch)}if(e.behaviors)for(const t of e.behaviors)t.initialize&&t.initialize(e,this,this.state.eventDispatch)}static getDerivedStateFromProps(e,t){const i=[],o=[];for(let t=0;t<e.columns.length;t++){const i=e.columns[t];if(i.behaviors)for(const e of i.behaviors)o.push(e)}return e.behaviors&&i.splice(i.length,0,...e.behaviors),{columnBehaviors:o,tableBehaviors:i}}render(){const{eventDispatch:e,renderInvisible:s,visibleColumnsKey:n}=this.state,{selectableText:r,className:a,columns:l,containerClassName:c,enforceSingleSelect:h,focuszoneProps:u,showLines:p,id:m,itemProvider:b,maxHeight:f,onActivate:v,onFocus:g,onSelect:x,pageSize:w,role:I,rowHeight:C,rowHeights:E,scrollable:D,selection:y,singleClickActivation:M,selectRowOnClick:P,showScroll:L,tableBreakpoints:k,virtualize:O}=this.props,T=[],R=2*(this.props.spacerWidth||0);let z=R,N=R,F=R,B=!1,U=!1,A=!1,j=0,H=0;for(const e of l){const{maxWidth:t,minWidth:i,widthStyle:s=0}=e,n=o.ObservableLike.getValue(e.width);T.push(e.width),n<0?(A=!0,N+=i||0,t?(B=!0,z+=t):U=!0,j++):n>0&&(0===s?(F+=n,N+=n,z+=n):(F+=16*n,N+=16*n,z+=16*n),j++),"_fill"===e.id&&H++}const K={selectableText:r,ariaColumnCount:j-H,ariaLabel:this.props.ariaLabel,ariaRowOffset:this.props.showHeader?1:0,className:(0,t.Util.css)(a,"bolt-table",p&&"bolt-table-show-lines"),columnCount:j+2,enforceSingleSelect:h,eventDispatch:e,focuszoneProps:u,id:m,itemProvider:b,maxWidth:B&&!U?z+"px":void 0,maxHeight:f,minWidth:N!==F?N+"px":void 0,onActivate:v,onFocus:g,onSelect:x,pageSize:w,renderHeader:this.renderHeader,renderLoadingRow:this.renderLoadingRow,renderRow:this.renderRow,role:I,rowHeight:C,rowHeights:E,selection:y,selectRowOnClick:P,singleClickActivation:M,showScroll:L,virtualize:O,width:A?"100%":F+"px"};d(l)>=0&&(K.defaultTabbableRow=-1);let W=i.createElement("div",{className:(0,t.Util.css)(c,"bolt-table-container flex-grow",s&&"invisible",D&&"v-scroll-auto",k&&"h-scroll-hidden"),ref:this.currentElement},k?i.createElement(G.TableBreakpoint,{columnWidths:T,onBreakpoint:this.onBreakpoint,breakpoints:k}):void 0,i.createElement(S.List,Object.assign({},K,{key:n,ref:this.list})));return D&&(W=i.createElement(t.Intersection.Intersection,null,W)),W}componentDidMount(){for(const e of this.state.tableBehaviors)e.componentDidMount&&e.componentDidMount(this.props);for(const e of this.state.columnBehaviors)e.componentDidMount&&e.componentDidMount({tableProps:this.props})}componentDidUpdate(){for(const e of this.state.tableBehaviors)e.componentDidUpdate&&e.componentDidUpdate(this.props);for(const e of this.state.columnBehaviors)e.componentDidUpdate&&e.componentDidUpdate({tableProps:this.props})}componentWillUnmount(){for(const e of this.state.tableBehaviors)e.componentWillUnmount&&e.componentWillUnmount();for(const e of this.state.columnBehaviors)e.componentDidUpdate&&e.componentDidUpdate({tableProps:this.props})}addOverlay(e,t,i,o=0,s){if(this.list.current)return this.list.current.addOverlay(e,t,i,o,s)}removeOverlay(e){if(this.list.current)return this.list.current.removeOverlay(e)}focusRow(e,t=1){return this.list.current?this.list.current.focusRow(e,t):Promise.resolve()}getFocusIndex(){return this.list.current?this.list.current.getFocusIndex():-1}getStats(){return this.list.current?this.list.current.getStats():{firstMaterialized:-1,firstRendered:-1,lastMaterialized:-1,lastRendered:-1}}scrollIntoView(e,t){if(this.list.current)return this.list.current.scrollIntoView(e,t)}}function l(e,t,i,o){return c(t).map((({column:t},s)=>t.renderCell(e,s,t,i,e+(o.ariaRowOffset?o.ariaRowOffset:1),o.role)))}function c(e){return e.map(((e,t)=>({column:e,originalIndex:t}))).filter((({column:e})=>o.ObservableLike.getValue(e.width)))}function d(e){return e.findIndex((e=>0!==o.ObservableLike.getValue(e.width)&&(e.behaviors&&e.behaviors.length>0||!!e.sortProps)))}t[e].Table=r,r.defaultProps={role:"grid",selectRowOnClick:!0,showHeader:!0,showLines:!0,singleClickActivation:!0,spacerWidth:8},t[e].renderColumns=l;class h extends i.Component{render(){const e=d(this.props.tableColumns);return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(o=>i.createElement(t.FocusZone.FocusZone,{direction:1},i.createElement("thead",null,i.createElement(t.FocusWithin.FocusWithin,null,(s=>i.createElement("tr",{"aria-rowindex":1,className:(0,t.Util.css)("bolt-table-header-row",s.hasFocus&&"focused"),"data-row-index":-1,onBlur:s.onBlur,onFocus:s.onFocus,role:"row"},i.createElement("th",{"aria-hidden":"true",key:"left-spacer",role:"presentation",className:"bolt-table-header-border"}),c(this.props.tableColumns).map((({column:s,originalIndex:n},r)=>s.renderHeaderCell?s.renderHeaderCell(r,s,o.focuszoneId,n===e):s.iconProps||s.name?i.createElement(p,{key:"col-header-"+r,ariaLabel:s.ariaLabel||s.name,column:s,columnIndex:r,focuszoneId:o.focuszoneId,isFirstActionableHeader:n===e},i.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:s.name},i.createElement("div",{className:"bolt-table-header-cell-text text-ellipsis body-s"},s.iconProps&&(0,t.Icon.Icon)(s.iconProps),i.createElement("span",{className:s.headerTitleClassName},s.name)))):i.createElement("th",{"aria-colindex":r+1,"aria-label":s.ariaLabel||a.EmptyColumnHeaderLabel,"aria-readonly":void 0!==s.readonly?s.readonly:"true",className:"bolt-table-header-border",key:"col-header-"+r}))),i.createElement("th",{"aria-hidden":"true",key:"right-spacer",role:"presentation",className:"bolt-table-header-border"}))))))))}}let u=0;class p extends i.Component{constructor(e){super(e),this.element=i.createRef(),this.state={measuredWidth:0,isFocused:!1},this.onSize=(e,t)=>{const{column:i}=this.props;i.onSize&&i.onSize(e,this.props.columnIndex,t,i)},this.headerCellId=u++}render(){const{ariaLabel:e,column:o,columnIndex:s,focuszoneId:r,isFirstActionableHeader:l}=this.props;let c;if(o.onSize){var d=!!o.showSizerDivider;c=i.createElement(t.Observer.Observer,{width:o.width},(e=>{let t=e.width;return t<0&&(t=this.state.measuredWidth),i.createElement(V.Sizer,{ariaLabel:(0,n.format)(a.ColumnSizerLabel,o.name),className:"bolt-table-header-sizer",divider:d,maxSize:o.maxWidth,minSize:o.minWidth,onSize:this.onSize,onSizeEnd:this.props.column.onSizeEnd,orientation:0,position:0,size:t,tabIndex:this.state.isFocused?0:-1,getFocusedElement:e=>this.element})}))}return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(n=>{const a=o.behaviors&&o.behaviors.length>0||!!o.sortProps,{sortProps:d={}}=o,h=o.sortProps&&void 0!==d.sortOrder?(0,t.Icon.Icon)({className:"bolt-table-header-sort-icon body-s",iconName:0===d.sortOrder?"SortUp":"SortDown"}):null;let u;0===o.justification?u="justify-start":1===o.justification&&(u="justify-end");const p=s+1,m=(0,t.Util.getSafeId)("th-col-content-"+this.headerCellId);return i.createElement("th",{role:"columnheader","aria-colindex":p,"aria-label":e,"aria-labelledby":e?void 0:m,"aria-readonly":"true","aria-sort":void 0!==d.sortOrder?0===d.sortOrder?"ascending":"descending":void 0,className:(0,t.Util.css)(o.headerClassName,"bolt-table-header-cell","col-header-"+s,a&&"bolt-table-header-cell-actionable"),"data-column-index":s,"data-focuszone":a&&(0,t.Util.css)(l&&r,n.focuszoneId),ref:this.element,onFocus:()=>this.setState({isFocused:!0}),onBlur:()=>this.setState({isFocused:!1}),tabIndex:a||c?0:-1},i.createElement("div",{className:(0,t.Util.css)("bolt-table-header-cell-content flex-row",u)},1===o.justification&&h,i.createElement("div",{id:m,className:"scroll-hidden"},this.props.children),1!==o.justification&&h,i.createElement("div",{"aria-hidden":!this.state.isFocused},c)))}))}componentDidMount(){this.updateMeasuredWidth()}componentDidUpdate(){this.updateMeasuredWidth()}updateMeasuredWidth(){const{column:e}=this.props;if(e.onSize&&this.element.current&&o.ObservableLike.getValue(e.width)<0){const e=this.element.current.getBoundingClientRect().width;e!==this.state.measuredWidth&&this.setState({measuredWidth:e})}}}function m(e){const o=function(e){const t=e.target.nodeName;return e.defaultPrevented||"INPUT"===t||"TEXTAREA"===t||37===e.which&&r.current&&(r.current.focus(),e.preventDefault()),1},[r]=i.useState((()=>i.createRef())),{details:l,index:c,linkProps:d}=e,{selectableText:h,ariaLabel:u,ariaBusy:p,ariaDescribedBy:m,ariaPosInSet:b,ariaRowOffset:f,ariaSetSize:v,excludeFocusZone:g,id:x,renderSpacer:w,role:I,selection:C,singleClickActivation:E}=l;let D,y;"menuitemcheckbox"===I?D=C&&C.selected(c):y=C&&C.selected(c);const S=i.createElement(t.FocusOrMouseWithin.FocusOrMouseWithin,{onFocus:function(t){var i;e.details.onFocusItem(e.index,t);const o=null!==(i=e.details.ariaPosInSet)&&void 0!==i?i:e.index+f;e.details.ariaSetSize?e.linkProps?s.announce((0,n.format)(a.ClickableRowAnnouncementWithSize,o,e.details.ariaSetSize),!0):"option"==I?s.announce(a.ListItem,!0):s.announce((0,n.format)(a.RowAnnouncementWithSize,o,e.details.ariaSetSize),!0):e.linkProps?s.announce((0,n.format)(a.ClickableRowAnnouncement,o),!0):s.announce((0,n.format)(a.RowAnnouncement,o),!0)}},(s=>i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(n=>{const a={"aria-busy":p,"aria-checked":D,"aria-describedby":m,"aria-label":u,"aria-rowindex":"menuitemcheckbox"===I||"option"===I||"presentation"===I?void 0:c+f,"aria-posinset":null===b?void 0:b,"aria-selected":"presentation"===I?void 0:y,"aria-setsize":null===v?void 0:v,className:(0,t.Util.css)(e.className,"bolt-table-row bolt-list-row",0===c&&"first-row",s.hasFocus&&"focused",C&&C.selected(c)&&"selected",E&&"single-click-activation",d&&"v-align-middle",h&&"selectable-text"),"data-focuszone":g||C&&!C.selectable(c)?void 0:n.focuszoneId,"data-row-index":e.index,id:(0,t.Util.getSafeId)(x),role:I||"row",tabIndex:(0,t.UtilitiesFocus.getTabIndex)(l),onBlur:s.onBlur,onFocus:s.onFocus,onMouseEnter:s.onMouseEnter,onMouseLeave:s.onMouseLeave,ref:r},S=[i.createElement("td",{"aria-hidden":"true",key:"left-spacer",className:"bolt-table-cell-compact bolt-table-cell bolt-list-cell bolt-table-spacer-cell",role:"presentation"},w&&w(c,!0)),e.children,i.createElement("td",{"aria-hidden":"true",key:"right-spacer",className:"bolt-table-cell-compact bolt-table-cell bolt-list-cell bolt-table-spacer-cell",role:"presentation"},w&&w(c,!1))];return i.createElement(t.FocusZone.FocusZone,{direction:1,postprocessKeyStroke:o},d?i.createElement("a",Object.assign({},(0,t.Link.getDefaultLinkProps)(d),a),S):i.createElement("tr",Object.assign({},a),S))}))));return l.tooltipProps?i.createElement(t.TooltipEx.Tooltip,Object.assign({},l.tooltipProps),S):S}function b(e){return i.createElement(m,{className:"bolt-list-row-loading",details:e.details,index:e.rowIndex},c(e.columns).map((({column:e},t)=>v({columnIndex:t,children:w(e.columnLayout)}))))}function f(e){const{ariaLabel:o,ariaRowIndex:s,className:n,colspan:r,columnIndex:a,role:l,tableColumn:c}=e;let d;return c&&(0===c.justification?d="justify-cell-start":1===c.justification&&(d="justify-cell-end")),i.createElement("td",{"aria-colindex":"presentation"===l||"treeitem"===l?void 0:a+1,"aria-label":"presentation"===l||"treeitem"===l?void 0:o,"aria-readonly":"presentation"===l||"treeitem"===l?void 0:c&&c.readonly,"aria-rowindex":"presentation"===l||"treeitem"===l?void 0:s,className:(0,t.Util.css)(n,c&&c.className,"bolt-table-cell bolt-list-cell",d),colSpan:r,"data-column-index":a,key:"col-"+a,role:"treeitem"===l?"presentation":l||"gridcell"},e.children)}function v(e){const o=i.createElement("div",{className:(0,t.Util.css)(e.contentClassName,"bolt-table-cell-content flex-row flex-center")},e.children);return f({ariaLabel:e.ariaLabel,ariaRowIndex:e.ariaRowIndex,children:o,className:e.className,colspan:e.colspan,columnIndex:e.columnIndex,role:e.role,tableColumn:e.tableColumn})}function g(e,o,s,n){const{columnStyle:r}=o,a=!(!s||"string"==typeof s||"number"==typeof s||!s.href);return i.createElement(v,{ariaRowIndex:n,className:(0,t.Util.css)(2===r&&"bolt-table-cell-primary",1===r&&"bolt-table-cell-secondary",3===r&&"bolt-table-cell-tertiary"),columnIndex:e,contentClassName:a?"bolt-table-cell-content-with-link":void 0,key:e,tableColumn:o},s&&(0,S.renderListCell)(s))}function x(){return 80*Math.random()+20+"%"}function w(e){return 1===e||void 0===e?i.createElement("div",{className:"shimmer shimmer-line",style:{width:x()}}," "):2===e?i.createElement(i.Fragment,null,i.createElement("div",{className:"shimmer shimmer-circle-small flex-noshrink"}),i.createElement("div",{className:"shimmer shimmer-line",style:{width:x()}}," ")):3===e?i.createElement("div",{className:"flex-column flex-grow"},i.createElement("div",{className:"bolt-table-two-line-cell-item shimmer shimmer-line",style:{width:x()}}," "),i.createElement("div",{className:"bolt-table-two-line-cell-item shimmer shimmer-line",style:{width:x()}}," ")):4===e?i.createElement(i.Fragment,null,i.createElement("div",{className:"shimmer shimmer-circle-large flex-noshrink"}),i.createElement("div",{className:"flex-column flex-grow"},i.createElement("div",{className:"bolt-table-two-line-cell-item shimmer shimmer-line",style:{width:x()}}," "),i.createElement("div",{className:"bolt-table-two-line-cell-item shimmer shimmer-line",style:{width:x()}}," "))):null}t[e].TableHeaderCell=p,t[e].TableRow=m,t[e].TableLoadingRow=b,t[e].TableCell=f,t[e].SimpleTableCell=v,t[e].TwoLineTableCell=function(e){const o="bolt-table-two-line-cell-item flex-row scroll-hidden",s=i.createElement("div",{className:o},e.line1,e.trailingLine1IconProps&&(0,t.Icon.Icon)(Object.assign(Object.assign({},e.trailingLine1IconProps),{className:(0,t.Util.css)(e.trailingLine1IconProps.className,"flex-noshrink")}))),n=i.createElement("div",{className:o},e.line2),r=i.createElement(i.Fragment,null,s,n);let a;return a=e.iconProps?i.createElement("div",{className:(0,t.Util.css)(e.className,"bolt-table-cell-content flex-row flex-center")},(0,t.Icon.Icon)(Object.assign(Object.assign({},e.iconProps),{className:(0,t.Util.css)(e.iconProps.className,"bolt-table-two-line-cell-icon flex-noshrink")})),i.createElement("div",{className:"flex-column scroll-hidden"},r),e.trailingIconProps&&(0,t.Icon.Icon)(Object.assign(Object.assign({},e.trailingIconProps),{className:(0,t.Util.css)(e.trailingIconProps.className,"bolt-table-two-line-cell-icon flex-noshrink")}))):i.createElement("div",{className:(0,t.Util.css)(e.className,"bolt-table-cell-content flex-column")},r,e.trailingIconProps&&(0,t.Icon.Icon)(Object.assign(Object.assign({},e.trailingIconProps),{className:(0,t.Util.css)(e.trailingIconProps.className,"bolt-table-two-line-cell-icon flex-noshrink")}))),f({ariaRowIndex:e.ariaRowIndex,children:a,colspan:e.colspan,columnIndex:e.columnIndex,className:"bolt-table-two-line-cell",tableColumn:e.tableColumn})},t[e].renderEmptyCell=function(e,t){return i.createElement(f,{columnIndex:t,key:t,role:"presentation"})},t[e].renderSimpleCell=function(e,t,i,o,s){return g(t,i,o[i.id],s)},t[e].renderSimpleCellValue=g,t[e].renderLoadingCell=w}("ComponentsTableTable"),t.Table={},Object.defineProperty(t.Table,"ColumnMore",{enumerable:!0,get:function(){return j.ColumnMore}}),Object.defineProperty(t.Table,"ColumnSelect",{enumerable:!0,get:function(){return H.ColumnSelect}}),Object.defineProperty(t.Table,"ColumnSorting",{enumerable:!0,get:function(){return K.ColumnSorting}}),Object.defineProperty(t.Table,"sortItems",{enumerable:!0,get:function(){return K.sortItems}}),Object.defineProperty(t.Table,"DragAndDropGripper",{enumerable:!0,get:function(){return W.DragAndDropGripper}}),Object.defineProperty(t.Table,"renderGripper",{enumerable:!0,get:function(){return W.renderGripper}}),Object.defineProperty(t.Table,"ColumnFill",{enumerable:!0,get:function(){return Z.ColumnFill}}),Object.defineProperty(t.Table,"ColumnFillId",{enumerable:!0,get:function(){return Z.ColumnFillId}}),Object.defineProperty(t.Table,"renderColumns",{enumerable:!0,get:function(){return Z.renderColumns}}),Object.defineProperty(t.Table,"renderEmptyCell",{enumerable:!0,get:function(){return Z.renderEmptyCell}}),Object.defineProperty(t.Table,"renderLoadingCell",{enumerable:!0,get:function(){return Z.renderLoadingCell}}),Object.defineProperty(t.Table,"renderSimpleCell",{enumerable:!0,get:function(){return Z.renderSimpleCell}}),Object.defineProperty(t.Table,"renderSimpleCellValue",{enumerable:!0,get:function(){return Z.renderSimpleCellValue}}),Object.defineProperty(t.Table,"SimpleTableCell",{enumerable:!0,get:function(){return Z.SimpleTableCell}}),Object.defineProperty(t.Table,"Table",{enumerable:!0,get:function(){return Z.Table}}),Object.defineProperty(t.Table,"TableCell",{enumerable:!0,get:function(){return Z.TableCell}}),Object.defineProperty(t.Table,"TableHeaderCell",{enumerable:!0,get:function(){return Z.TableHeaderCell}}),Object.defineProperty(t.Table,"TableLoadingRow",{enumerable:!0,get:function(){return Z.TableLoadingRow}}),Object.defineProperty(t.Table,"TableRow",{enumerable:!0,get:function(){return Z.TableRow}}),Object.defineProperty(t.Table,"TwoLineTableCell",{enumerable:!0,get:function(){return Z.TwoLineTableCell}}),Object.defineProperty(t.Table,"TableBreakpoint",{enumerable:!0,get:function(){return G.TableBreakpoint}}),function(e){t[e]={};function o(e){const t=(0,S.cellFromEvent)(e);return-1===t.rowIndex?t.cellIndex:null}t[e].ColumnDragDropBehavior=class{constructor(e){this.initialize=(e,t,i)=>{this.dragDroppableUI=t,this.eventDispatch=i,this.eventDispatch.addEventListener("pointerdown",this.onPointerDown),this.eventDispatch.addEventListener("dragstart",this.onDragStart),this.eventDispatch.addEventListener("dragend",this.onDragEnd),this.eventDispatch.addEventListener("dragenter",this.onDragEnter),this.eventDispatch.addEventListener("dragexit",this.onDragExit),this.eventDispatch.addEventListener("dragover",this.onDragOver),this.eventDispatch.addEventListener("drop",this.onDrop),this.indicatorName="drop-indicator"},this.onDragEnd=e=>{const t=o(e);t&&t>=0&&this.options.onDragEnd&&this.options.onDragEnd(e),this.dragDroppableUI.removeOverlay("drag-source-item"),this.dragImageData=void 0},this.onDragStart=e=>{if(e.detail.dataTransfer&&!e.defaultPrevented){const t=o(e);null!==t&&t>=0&&(this.options.onDragStart&&this.options.onDragStart(e),"none"!==e.detail.dataTransfer.effectAllowed&&(this.dragDroppableUI.addOverlay("drag-source-item",-1,this.renderDragSourceItemOverlay,0,t),void 0===this.dragImageData&&(this.dragImageData={image:this.options.renderDragImage(e)})))}},this.onPointerDown=e=>{0===e.button&&this.beginDrag(e)},this.renderDragSourceItemOverlay=e=>i.createElement(i.Fragment,null,i.createElement("div",{className:"bolt-list-drag-source-item flex-grow"}),this.operation&&this.dragImageData&&i.createElement(t.UtilitiesDragDrop.DragImage,{operation:this.operation},this.dragImageData.image)),this.setDragImage=(e,t,i)=>{this.dragImageData={image:e,xOffset:t,yOffset:i}},this.onDragEnter=e=>{this.handlesType(e)&&(this.options.onDragEnter?this.options.onDragEnter(e):e.detail.dataTransfer.dropEffect="move")},this.onDragExit=e=>{this.handlesType(e)&&(this.options.onDragExit&&this.options.onDragExit(e),this.dragDroppableUI.removeOverlay(this.indicatorName))},this.onDragOver=e=>{if(!this.handlesType(e))return;const t=this.calculateIndex(e),i=e.detail.dataTransfer.secondaryData.index,o=e.detail.dataTransfer.secondaryData.sourceId;t>=0&&(t!==i||o!==this.options.id)&&this.options.columns[t].id!==Z.ColumnFillId?this.options.onDragOver?this.options.onDragOver(e,{index:"right"===this.listIndicatorPosition?t+1:t}):e.detail.dataTransfer.dropEffect="move":e.detail.dataTransfer.dropEffect="none","none"===e.detail.dataTransfer.dropEffect?this.dragDroppableUI.removeOverlay(this.indicatorName):this.dragDroppableUI.addOverlay(this.indicatorName,-1,this.renderDropIndicator,0,t)},this.onDrop=e=>{if(!this.handlesType(e))return;const t=this.calculateIndex(e),i=e.detail.dataTransfer.secondaryData.index,o=e.detail.dataTransfer.secondaryData.sourceId;t>=0&&(t!==i||o!==this.options.id)&&this.options.onDrop&&(e.persist(),this.options.onDrop(e,{index:"right"===this.listIndicatorPosition?t+1:t})),this.dragDroppableUI.removeOverlay(this.indicatorName)},this.renderDropIndicator=e=>{const t="right"===this.listIndicatorPosition?e.rowElement.offsetWidth:0;return i.createElement(x.ListDropIndicator,{position:this.listIndicatorPosition,xOffset:t-3,lineOffset:t})},this.options=e,this.contextMenuIndex=e.columns.findIndex((e=>"_more"===e.id))}componentWillUnmount(){var e,t,i,o,s,n,r;null===(e=this.eventDispatch)||void 0===e||e.removeEventListener("pointerdown",this.onPointerDown),null===(t=this.eventDispatch)||void 0===t||t.removeEventListener("dragstart",this.onDragStart),null===(i=this.eventDispatch)||void 0===i||i.removeEventListener("dragend",this.onDragEnd),null===(o=this.eventDispatch)||void 0===o||o.removeEventListener("dragenter",this.onDragEnter),null===(s=this.eventDispatch)||void 0===s||s.removeEventListener("dragexit",this.onDragExit),null===(n=this.eventDispatch)||void 0===n||n.removeEventListener("dragover",this.onDragOver),null===(r=this.eventDispatch)||void 0===r||r.removeEventListener("drop",this.onDrop)}updateBehaviorOptions(e){this.options=e}beginDrag(e){var i;const s=o(e);if(null!==s&&(null===(i=this.options)||void 0===i?void 0:i.columns)&&s>=0){const i=this.options.columns[s];this.operation=(0,t.UtilitiesDragDrop.beginDragOperation)(e,{data:i,dropEffect:"none",secondaryData:{index:s,sourceId:this.options.id},setDragImage:this.setDragImage,type:this.options.type})}}handlesType(e){var t;const i=(null===(t=e.detail.dataTransfer)||void 0===t?void 0:t.type)||"";return-1!==this.options.allowedTypes.indexOf(i)}calculateIndex(e){const i=(0,S.cellFromEvent)(e);let o=i.cellIndex;if(i.cellElement&&e.detail.dataTransfer.secondaryData){const s=e.detail.dataTransfer.secondaryData.index,n=e.detail.nativeEvent,r=i.cellElement.getBoundingClientRect(),a=(0,t.Util.getPointByEventType)(n),l=a?a.x<r.width/2+r.left:o<s;o<s?(this.listIndicatorPosition="left",l||o++,o===this.contextMenuIndex&&o--):o>s&&(this.listIndicatorPosition="right",l&&o--,o+1<this.options.columns.length&&o+1==this.contextMenuIndex&&o++)}return o}}}("ComponentsTableColumnDragDropBehavior"),function(e){_=t[e]={};class o extends i.Component{constructor(e){super(e),this.getTimeString=()=>t.UtilitiesDate.duration(this.props.startDate,this.props.endDate),this.getNextInterval=()=>o.durationNextInterval(this.props.startDate,this.props.endDate),this.state={tooltipProps:{}}}static getDerivedStateFromProps(e){return{tooltipProps:void 0===e.tooltipProps?{renderContent:function(){return(0,n.format)(a.Started,t.UtilitiesDate.tooltipString(e.startDate))}}:e.tooltipProps}}render(){return i.createElement(l.Time,{ariaHidden:this.props.ariaHidden,ariaLabel:this.props.ariaLabel?this.props.ariaLabel:t.UtilitiesDate.tooltipString(this.props.startDate),className:this.props.className,getNextInterval:this.getNextInterval,getTimeString:this.getTimeString,tabIndex:this.props.tabIndex,tooltipProps:this.state.tooltipProps})}static durationNextInterval(e,i,o){if(i)return-1;{const s=(i=o||new Date).getTime()-e.getTime();let n=t.UtilitiesDate.minute;return n=s<t.UtilitiesDate.day?t.UtilitiesDate.second:t.UtilitiesDate.minute-s%t.UtilitiesDate.minute,n}}}t[e].Duration=o}("ComponentsTimeDurationDuration"),function(e){X=t[e]={};let s=1;class n extends i.Component{constructor(){super(...arguments),this.toggleElement=i.createRef(),this.labelId=`toggle-${s++}-label`,this.onClick=e=>{this.props.onChange&&!this.props.disabled&&this.props.onChange(e,void 0!==this.props.checked&&!o.ObservableLike.getValue(this.props.checked))},this.onFocus=()=>{this.props.id&&this.context.onFocus(this.props.id)},this.onKeyDown=e=>{e.defaultPrevented||32===e.which&&(this.onClick(e),e.preventDefault())}}render(){const{onAriaLabel:e,offAriaLabel:o,className:s,disabled:n,excludeFocusZone:r,id:a,offText:l,onText:c,role:d,text:h,tooltipProps:u}=this.props;return i.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(p=>i.createElement(t.Observer.Observer,{checked:this.props.checked},(m=>{const b=m.checked?e||this.props.ariaLabel:o||this.props.ariaLabel,f=(0,t.Util.getSafeId)(this.labelId);let v=i.createElement("div",{className:(0,t.Util.css)(s,"bolt-toggle-button cursor-pointer",m.checked&&"checked",n?"disabled":"enabled"),onClick:this.onClick,onFocus:this.onFocus,onKeyDown:this.onKeyDown},i.createElement("div",{"aria-checked":m.checked,"aria-disabled":n,"aria-label":b,"aria-labelledby":b?void 0:f,className:"bolt-toggle-button-pill bolt-focus-treatment flex-noshrink","data-focuszone":n||r?void 0:p.focuszoneId,"data-is-focusable":!0,id:(0,t.Util.getSafeId)(a),ref:this.toggleElement,role:d||"switch",tabIndex:(0,t.UtilitiesFocus.getTabIndex)(this.props,this.context)},i.createElement("div",{className:"bolt-toggle-button-icon"})),i.createElement("div",{className:"bolt-toggle-button-text body-m",id:f},m.checked?c||h:l||h));return u&&(v=i.createElement(t.TooltipEx.Tooltip,Object.assign({},u),v)),v}))))}focus(){this.toggleElement.current&&this.toggleElement.current.focus()}}t[e].Toggle=n,n.contextType=t.FocusGroup.FocusGroupContext}("ComponentsToggleToggle"),t.Duration={},__exportStar(_,t.Duration),t.PillGroup={},Object.defineProperty(t.PillGroup,"PillGroup",{enumerable:!0,get:function(){return T.PillGroup}}),t.RadioButton={},Object.defineProperty(t.RadioButton,"RadioButton",{enumerable:!0,get:function(){return z.RadioButton}}),Object.defineProperty(t.RadioButton,"RadioButtonGroup",{enumerable:!0,get:function(){return z.RadioButtonGroup}}),t.ResizeGroup={},Object.defineProperty(t.ResizeGroup,"ResizeGroup",{enumerable:!0,get:function(){return N.ResizeGroup}}),Object.defineProperty(t.ResizeGroup,"ResizeGroupContext",{enumerable:!0,get:function(){return N.ResizeGroupContext}}),Object.defineProperty(t.ResizeGroup,"OverflowButton",{enumerable:!0,get:function(){return F.OverflowButton}}),t.SplitButton={},Object.defineProperty(t.SplitButton,"SplitButton",{enumerable:!0,get:function(){return A.SplitButton}}),t.Time={},__exportStar(l,t.Time),t.Toggle={},Object.defineProperty(t.Toggle,"Toggle",{enumerable:!0,get:function(){return X.Toggle}})}),["Resources.Widgets","Components/Time/Time/Time","Components/Time/Ago/Ago","Ago","Components/Button/Button","Components/Button/ExpandableButton","Button","Components/ButtonGroup/ButtonGroup","ButtonGroup","Components/Checkbox/Checkbox","Components/FormItem/FormItem","Components/List/FixedHeightList","Components/List/List","Components/List/ListDragSourceBehavior","Components/List/ListDropIndicator","Components/List/ListDropTargetBehavior","Components/List/ListDragDropBehavior","Components/List/ListDragImage","Components/List/ListSelection","Components/Menu/ContextMenuBehavior","Checkbox","List","Components/Menu/Menu","Components/Menu/MenuButton","Components/Menu/MoreButton","Components/Pill/Pill","Pill","Components/PillGroup/PillGroup","FormItem","Components/RadioButton/RadioButton","Components/ResizeGroup/ResizeGroup","Components/ResizeGroup/OverflowButton","Components/Sizer/Sizer","Menu","Components/SplitButton/SplitButton","Components/Table/ColumnMore","Components/Table/ColumnSelect","Components/Table/ColumnSorting","Components/Table/DragAndDropGripper","Sizer","Components/Table/TableBreakpoint","Components/Table/Table","Table","Components/Table/ColumnDragDropBehavior","Components/Time/Duration/Duration","Components/Toggle/Toggle","Duration","PillGroup","RadioButton","ResizeGroup","SplitButton","Time","Toggle"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-widgets-content"}}));