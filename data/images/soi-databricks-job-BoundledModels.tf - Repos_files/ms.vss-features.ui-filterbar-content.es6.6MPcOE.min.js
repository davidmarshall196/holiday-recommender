"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSSUI",["require","exports","react","VSS/Core/Util/Accessibility","VSS/Core/Util/String"],(function(e,t,s,i,r){var l,a,o,n;l=t.ResourcesFilterBar={},t.ResourcesFilterBar.ClearAndDismissFilterBarLinkLabel="Clear and dismiss filters",t.ResourcesFilterBar.ClearFilterBarLinkLabel="Clear filters",t.ResourcesFilterBar.FilterPageLeftAriaLabel="See previous group of filters",t.ResourcesFilterBar.FilterPageRightAriaLabel="See next group of filters",t.ResourcesFilterBar.AnnonuceVisibleFilters="Showing filters {0} through {1}",t.ResourcesFilterBar.ApplyChangesFilterBarText="Apply",function(e){a=t[e]={};let o=0;class n extends s.Component{constructor(e){if(super(e),this._firstChildIsKeywordItem=!1,this._prevContainerWidth=0,this._id=(0,t.Util.getSafeId)("filter-bar-"+o++),this._onResize=()=>{this._resizeTimeout||(this._resizeTimeout=setTimeout((()=>{if(this._resizeTimeout=null,this._isMounted){const e=this._prevContainerWidth<this._filterBarElement.clientWidth,t=(!this.state.shouldHidePlaceholderLabels||!e)&&this.state.shouldHidePlaceholderLabels,s=(!this.state.shouldHaveMaxItemWidth||!e)&&this.state.shouldHaveMaxItemWidth;this._prevContainerWidth=this._filterBarElement.clientWidth,this.setState({filtersToShowStopIndex:n.RENDER_EVERYTHING,shouldHidePlaceholderLabels:t,shouldHaveMaxItemWidth:s})}}),100))},this._onPageLeft=()=>{this._hasMadeVisibleFilterAnnouncement=!1;const e=this._startingFilterIndices.pop()||0;this._hasPagedLeft=!0,this.setState({filtersToShowStartIndex:e,filtersToShowStopIndex:n.RENDER_EVERYTHING})},this._onPageRight=()=>{this._hasMadeVisibleFilterAnnouncement=!1,this._startingFilterIndices.push(this.state.filtersToShowStartIndex),this._hasPagedRight=!0,this.setState({filtersToShowStartIndex:this.state.filtersToShowStopIndex,filtersToShowStopIndex:n.RENDER_EVERYTHING})},this._calculateFiltersToShowStopIndex=()=>{let e=this._rightElement.clientWidth;for(let t=0;t<this._childrenContainerElements.length;t++){const s=this._childrenContainerElements[t];if(e+=s.clientWidth+parseFloat(window.getComputedStyle(s).marginRight),e>this._filterBarElement.clientWidth){const e=this.state.filtersToShowStartIndex+t;return e>this.state.filtersToShowStartIndex?e:this.state.filtersToShowStartIndex+1}}return this.state.filtersToShowStartIndex+this._childrenContainerElements.length},this._onFilterChanged=e=>{this.setState({hasChangesToApply:this.props.filter.hasChangesToApply(),hasChangesToReset:this.props.filter.hasChangesToReset(),filtersToShowStopIndex:n.RENDER_EVERYTHING,shouldHidePlaceholderLabels:!1})},this._onFilterApplied=e=>{this.setState({hasChangesToApply:this.props.filter.hasChangesToApply()})},this._onClearAndDismiss=()=>{this.props.filter.hasChangesToReset()&&this.props.filter.reset(),this.props.onDismissClicked&&this.props.onDismissClicked(),this.focus()},this._onApplyChanges=()=>{this.props.filter.applyChanges(),this.focus()},!e.filter)throw new Error("Cannot create a FilterBar without a filter prop.");this._startingFilterIndices=[],this._hasMadeVisibleFilterAnnouncement=!1,this._isMounted=!1,this.state={hasChangesToReset:e.filter.hasChangesToReset(),hasChangesToApply:e.filter.hasChangesToApply(),filtersToShowStartIndex:0,filtersToShowStopIndex:n.RENDER_EVERYTHING,shouldHidePlaceholderLabels:!1,shouldHaveMaxItemWidth:!1}}focus(){this._filterItemRefs&&this._filterItemRefs.length>0&&this._filterItemRefs[0].focus()}forceUpdate(){super.forceUpdate(),this._filterItemRefs&&this._filterItemRefs.forEach((e=>e.forceUpdate()))}componentDidMount(){this.props.filter&&this.props.filter.subscribe(this._onFilterChanged,t.UtilitiesFilter.FILTER_CHANGE_EVENT),this.props.filter&&this.props.filter.subscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),window.addEventListener("resize",this._onResize);const e=this._calculateFiltersToShowStopIndex();e<s.Children.toArray(this.props.children).length-1?this.setState({shouldHidePlaceholderLabels:!0}):this.setState({filtersToShowStopIndex:e}),this._isMounted=!0,this.props.onMounted&&this.props.onMounted(this)}UNSAFE_componentWillReceiveProps(e){this.getChildKeysAsString(this.props)!==this.getChildKeysAsString(e)?this.setState({hasChangesToApply:e.filter.hasChangesToApply(),hasChangesToReset:e.filter.hasChangesToReset(),filtersToShowStartIndex:0,filtersToShowStopIndex:n.RENDER_EVERYTHING}):this.setState({hasChangesToApply:e.filter.hasChangesToApply(),hasChangesToReset:e.filter.hasChangesToReset()})}componentWillUnmount(){this.props.filter&&this.props.filter.unsubscribe(this._onFilterChanged,t.UtilitiesFilter.FILTER_CHANGE_EVENT),this.props.filter&&this.props.filter.unsubscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),window.removeEventListener("resize",this._onResize),this._isMounted=!1}componentDidUpdate(){if(this.props.onRenderComplete&&this.props.onRenderComplete(),this._hasPagedLeft&&this.state.filtersToShowStopIndex>0&&(0==this.state.filtersToShowStartIndex&&this._nextButtonElem&&this._nextButtonElem.focus(),this._hasPagedLeft=!1),this.state.filtersToShowStopIndex<0){const e=this._calculateFiltersToShowStopIndex(),t=e===s.Children.toArray(this.props.children).length;t||this.state.shouldHidePlaceholderLabels?t||this.state.shouldHaveMaxItemWidth?(this._hasPagedRight&&e===this.state.filtersToShowStartIndex+this._childrenContainerElements.length&&this._prevButtonElem&&this._prevButtonElem.focus(),this.setState({filtersToShowStopIndex:e}),this._hasPagedRight=!1):this.setState({shouldHaveMaxItemWidth:!0}):this.setState({shouldHidePlaceholderLabels:!0})}else this._hasMadeVisibleFilterAnnouncement||(i.announce((0,r.format)(l.AnnonuceVisibleFilters,this.state.filtersToShowStartIndex+1,this.state.filtersToShowStopIndex),!1),this._hasMadeVisibleFilterAnnouncement=!0);this._prevContainerWidth!=this._filterBarElement.clientWidth&&this._onResize()}render(){const{children:e,filter:i,className:r,onDismissClicked:a,searchRoleAriaLabel:o}=this.props,{hasChangesToApply:n,hasChangesToReset:h,filtersToShowStopIndex:d,filtersToShowStartIndex:p,shouldHaveMaxItemWidth:c,shouldHidePlaceholderLabels:f}=this.state;this._filterItemRefs=[],this._childrenContainerElements=[];let u=!0,m=!1;this._firstChildIsKeywordItem=!1;let _=s.Children.map(e,(e=>{if(null===e)return null;let r="vss-FilterBar--item";const l=e;l.props.isTextItem&&!m?(this._firstChildIsKeywordItem=u,m=!0,r=(0,t.Util.css)(r,"vss-FilterBar--item-keyword-container")):c&&(r=(0,t.Util.css)(r,"max-width-small")),u=!1;const a=s.cloneElement(l,{filter:l.props.filter||i,ref:e=>{e&&this._filterItemRefs.push(e)},hideSelectedItemIcon:!0,showPlaceholderAsLabel:!f&&l.props.showPlaceholderAsLabel});return s.createElement("div",{className:r,ref:e=>{e&&this._childrenContainerElements.push(e)}},a)}));const S=d<_.length,g=p>0;if(S||g){const e=d>0?d:_.length;_=_.slice(p,e)}const C=a?l.ClearAndDismissFilterBarLinkLabel:l.ClearFilterBarLinkLabel;return s.createElement(t.Surface.SurfaceContext.Consumer,null,(e=>s.createElement("div",{className:(0,t.Util.css)(r,"vss-FilterBar",1===e.background&&"bolt-filterbar-white depth-8 no-v-margin"),role:"search","aria-label":o,id:this._id},s.createElement("div",{className:(0,t.Util.css)("vss-FilterBar--list",(!this._firstChildIsKeywordItem||p>0)&&"justify-right"),ref:e=>{this._filterBarElement=e}},_,s.createElement("div",{className:"vss-FilterBar--right-items",ref:e=>{this._rightElement=e}},(g||S)&&s.createElement("div",{className:"vss-FilterBar--page-button-container"},s.createElement(t.Button.Button,{className:"filter-bar-button  vss-FilterBar-page-button",ref:e=>{this._prevButtonElem=e},onClick:this._onPageLeft,disabled:!g,ariaLabel:l.FilterPageLeftAriaLabel,iconProps:{iconName:"ChevronLeftMed"}}),s.createElement(t.Button.Button,{className:"filter-bar-button vss-FilterBar-page-button",ref:e=>{this._nextButtonElem=e},onClick:this._onPageRight,disabled:!S,ariaLabel:l.FilterPageRightAriaLabel,iconProps:{iconName:"ChevronRightMed"}})),!this.props.hideClearAction&&s.createElement("div",{className:"vss-FilterBar--action vss-FilterBar--action-clear"},s.createElement(t.Button.Button,{ariaLabel:C,className:"filter-bar-button",disabled:!h&&!a,iconProps:{iconName:"Cancel"},onClick:this._onClearAndDismiss,subtle:!0,tooltipProps:{text:C}})),i.usesApplyMode()&&s.createElement("div",{className:"vss-FilterBar--action vss-FilterBar--action-apply"},s.createElement(t.Button.Button,{className:"filter-bar-button",disabled:!n,onClick:this._onApplyChanges,iconProps:{iconName:"CheckMark"}},l.ApplyChangesFilterBarText)))))))}getChildKeysAsString(e){const t=e.children&&s.Children.map(e.children,(e=>{if(null===e)return null;return void 0===e?"":e.props.filterItemKey}))||[];return JSON.stringify(t)}}t[e].FilterBar=n,n.RENDER_EVERYTHING=-1}("ComponentsFilterBarFilterBar"),o=t[n="ComponentsFilterBarindex"]={},__exportStar(a,t[n]),t.FilterBar={},__exportStar(o,t.FilterBar)}),["Resources.FilterBar","Components/FilterBar/FilterBar","Components/FilterBar/index","FilterBar"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-filterbar-content"}}));