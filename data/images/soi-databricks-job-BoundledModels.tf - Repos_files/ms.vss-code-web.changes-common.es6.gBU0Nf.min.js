"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("Repos/ChangesCommon",["require","exports","react","VSS/Core/Observable","VSS/Platform/Context"],(function(e,i,t,s,a){i.ChangesContext={},i.ChangesContext.ChangesContext=t.createContext({}),i.ChangesContext.useChangesContext=function(){return t.useContext(i.ChangesContext.ChangesContext)},function(e){i.ChangesFilesService={};class t extends a.VssService{constructor(){super(...arguments),this.fileDiffMap={},this.fileDiffQueue=[],this.outstandingDiffRequests=[],this.repositoryId=""}_serviceStart(e){super._serviceStart(e);const i=this.pageContext.getService("IVCViewModelDataProviderService").getUserPreferences();this.diffOrientation={},this.diffOrientation[0]=new s.ObservableValue(i.diffViewerOrientation),this.diffOrientation[1]=new s.ObservableValue(i.summaryDiffOrientation)}getDiffOrientation(e){return this.diffOrientation[e]}getFileDiffPromise(e){return this.getFileDiffEntry(e).promise}setDiffOrientation(e,i){const t=this.diffOrientation[e];t.value!==i&&(t.value=i,this.setUserNavigationPreference(e,i))}getFileDiffEntry(e){var i;e.originalPath&&(null===(i=e.originalVersion)||void 0===i?void 0:i.startsWith("PS"))&&(e=Object.assign(Object.assign({},e),{originalPath:e.modifiedPath}));const t=JSON.stringify(e);let a=this.fileDiffMap[t];if(!a){let i,n;const r=new s.ObservableValue(void 0),f=new Promise(((e,t)=>{i=e,n=t}));a={observable:r,promise:f},a.process=()=>{this.pageContext.getService("IVssContributionService").getDataAsync("ms.vss-code-web.file-diff-data-provider",{repositoryId:this.repositoryId,diffParameters:e},!0).then((e=>{i(e),r.value=e,this.removeDiffQueueItem(a)}),(e=>{n(e),this.removeDiffQueueItem(a)}))},this.fileDiffMap[t]=a,this.fileDiffQueue.push(a),this.processFileDiffQueue()}return a}processFileDiffQueue(){let e;for(;this.outstandingDiffRequests.length<=2&&this.fileDiffQueue.length>0;)e=this.fileDiffQueue.splice(0,1)[0],this.outstandingDiffRequests.push(e),e.process()}removeDiffQueueItem(e){this.outstandingDiffRequests=this.outstandingDiffRequests.filter((i=>i!==e)),this.processFileDiffQueue()}setUserNavigationPreference(e,i){const t=this.pageContext.getService("IVCViewModelDataProviderService"),s=t.getUserPreferences();1===e?s.summaryDiffOrientation=i:s.diffViewerOrientation=i,t.setUserPreferences(s)}}i.ChangesFilesService.ChangesFilesService=t}(),function(e){i[e]={};class t extends a.VssService{constructor(){super(...arguments),this.onUpdatedChanges=e=>{this.diffNavigation.value=void 0,this.fileNavigation.value=void 0,this.navigateToFirstDiffOnLoad=!1,this.navigateToLastDiffOnLoad=!1,e&&(this.selectedItem?this.selectedItem.value=e.rootTreeItem.data:(this.selectedItem=new s.ObservableValue(e.rootTreeItem.data),this.selectedItem.subscribe(this.onSelectedItemChanged)))},this.onSelectedItemChanged=e=>{if(this.diffNavigation.value=void 0,!e||e.isFolder)this.fileNavigation.value=void 0;else{const e=this.findNextFile(),i=this.findPreviousFile();this.fileNavigation.value={hasNextFile:!!e,hasPreviousFile:!!i,nextFile:()=>{e&&this.setSelectedItem(e,!0,!1)},previousFile:()=>{i&&this.setSelectedItem(i,!1,!0)}}}}}_serviceStart(e){super._serviceStart(e),this.diffNavigation=new s.ObservableValue(void 0),this.fileNavigation=new s.ObservableValue(void 0),this.navigateToFirstDiffOnLoad=!1,this.navigateToLastDiffOnLoad=!1}_serviceEnd(e){super._serviceEnd(e),this.removeChangesSubscriber()}getDiffNavigation(){return this.diffNavigation}getFileNavigation(){return this.fileNavigation}getHasNextDiff(){return!!(this.diffNavigation.value&&this.diffNavigation.value.hasNextDiff||this.fileNavigation.value&&this.fileNavigation.value.hasNextFile)}getHasPreviousDiff(){return!!(this.diffNavigation.value&&this.diffNavigation.value.hasPreviousDiff||this.fileNavigation.value&&this.fileNavigation.value.hasPreviousFile)}getNavigateToFirstDiffOnLoad(){return this.navigateToFirstDiffOnLoad}getNavigateToLastDiffOnLoad(){return this.navigateToLastDiffOnLoad}getSelectedItem(){return this.selectedItem}nextDiff(){this.diffNavigation.value&&this.diffNavigation.value.hasNextDiff?this.diffNavigation.value.nextDiff():this.fileNavigation.value&&this.fileNavigation.value.hasNextFile&&this.fileNavigation.value.nextFile()}previousDiff(){this.diffNavigation.value&&this.diffNavigation.value.hasPreviousDiff?this.diffNavigation.value.previousDiff():this.fileNavigation.value&&this.fileNavigation.value.hasPreviousFile&&this.fileNavigation.value.previousFile()}setChanges(e){this.removeChangesSubscriber(),this.changes=e,e.subscribe(this.onUpdatedChanges),this.onUpdatedChanges(e.value)}removeChangesSubscriber(){this.changes&&this.changes.unsubscribe(this.onUpdatedChanges)}setDiffNavigation(e){this.diffNavigation.value=e}setSelectedItem(e,i=!1,t=!1){this.navigateToFirstDiffOnLoad=i,this.navigateToLastDiffOnLoad=t,this.selectedItem.value!==e&&(this.selectedItem.value=e)}findSelectedItemTreePath(e,i,t){return e.data==this.selectedItem.value||!!e.childItems&&e.childItems.some(((s,a)=>!!this.findSelectedItemTreePath(s,i,t)&&(i.push(e),t.push(a),!0)))}findNextFile(){if(!this.changes.value)return;let e=[],i=[];if(this.findSelectedItemTreePath(this.changes.value.rootTreeItem,e,i)){let t=0;for(;e.length>t&&e[t].childItems.length==i[t]+1;)++t;if(e.length>t){let s=e[t].childItems[i[t]+1];for(;s.data.isFolder&&s.childItems;)s=s.childItems[0];return s.data}}}findPreviousFile(){if(!this.changes.value)return;let e=[],i=[];if(this.findSelectedItemTreePath(this.changes.value.rootTreeItem,e,i)){let t=0;for(;e.length>t&&0==i[t];)++t;if(e.length>t){let s=e[t].childItems[i[t]-1];for(;s.data.isFolder&&s.childItems;)s=s.childItems[s.childItems.length-1];return s.data}}}}i[e].ChangesNavigationService=t;const n="IGitNavigationService";a.Services.add(n,{serviceFactory:class extends t{}}),i[e].getGitNavigationService=function(e){return e.getService(n)};const r="ITfvcNavigationService";a.Services.add(r,{serviceFactory:class extends t{}}),i[e].getTfvcNavigationService=function(e){return e.getService(r)}}("ChangesNavigationService")}),["ChangesContext","ChangesFilesService","ChangesNavigationService"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-code-web.changes-common"}}));