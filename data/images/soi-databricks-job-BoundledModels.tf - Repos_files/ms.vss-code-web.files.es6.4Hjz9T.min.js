"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("Repos/Files",["require","exports","VSS/Platform/Context","react","Repos/Common/Util/File","VSS/Core/Observable","VSS/Features/PlatformUI/ContributedContent","VSS/Platform/Components/Performance","VSS/Platform/Layout","VSS/Platform/Util/Url","VSSUI/Card","VSSUI/Observer","Repos/ChangesCommon/ChangesFilesService","Repos/Common/Util/Editor","Repos/Common/Util/Version","VSS/Platform/RestClientBase","VSS/Platform/Util/Serialization"],(function(e,t,n,r,o,i,s,a,c,l,d,u,h,p,m,C,g){t.Resources={},t.Resources.InlineDiff="Inline",t.Resources.SideBySideDiff="Side-by-side",function(e){t.ContentPreview={},function(e){e[e.ShowRawText=1]="ShowRawText",e[e.ShowRenderedContent=2]="ShowRenderedContent"}(t.ContentPreview.ContentPreviewDefaultBehavior||(t.ContentPreview.ContentPreviewDefaultBehavior={}));class r extends n.VssService{_serviceStart(e){super._serviceStart(e);const t=e.getService("IVssContributionService"),n=t.getContributionChildren("ms.vss-code-web.content-renderer-collection","ms.vss-code-web.content-renderer");if(this.previewContributions={},this.previewContributionExtensions={},n)for(const e of n){const n=t.getContribution(e);if(n){n.contributionId=e;for(const t of n.fileExtensions||[])this.previewContributionExtensions[t.toUpperCase()]=e,this.previewContributions[e]=n}}}getPreviewContribution(e){const t=this.getPreviewContributionId(e);if(t)return this.previewContributions[t]}getPreviewContributionId(e){const t=(e=e.toUpperCase()).split(".").slice(1);for(let e=0;e<t.length;e++){const n=t.slice(e).join("."),r=this.previewContributionExtensions[n];if(r)return r}}}const o="IContentPreviewService";n.Services.add(o,{serviceFactory:r}),t.ContentPreview.getContentPreviewService=function(e){return e.getService(o)}}(),function(e){t[e]={};class n extends c.VssComponent{constructor(){super(...arguments),this.content=new i.ObservableValue(""),this.onContentChanged=e=>{this.renderLegacyContent(e)},this.onLoaded=e=>{e.proxy&&e.proxy.getRemoteObjectProxy(this.props.contribution.registeredObjectId||"showRenderer").then((e=>{this.legacyRenderer=e,this.renderLegacyContent(this.content.value)})).catch((()=>{}))}}render(){const{className:e,contribution:t,contributionId:n,getItemContent:o,urlTransformer:i}=this.props;return r.createElement(a.PerformanceScenarioContext.Consumer,null,(a=>{const l=a.registerPendingWork("load-preview");return r.createElement(u.Observer,{content:o()},(o=>{let a;o.content&&(a=o.content.details,o.content.editContext&&(a={content:o.content.editContext.getContent(),contentTruncated:o.content.details.contentTruncated,metadata:o.content.details.metadata,objectId:o.content.details.objectId,resourceUri:o.content.details.resourceUri})),this.content.value=a?a.content:"";const u={componentProperties:{context:{content:this.content.value},linkTransformer:i.transformLink,imageUrlTransformer:i.transformImage,linkParse:i.parseFilesHubUrl,onLoaded:this.onLoaded},contribution:t,contributionId:n};return r.createElement(d.Card,{className:"flex-grow no-padding",contentProps:{contentPadding:!1}},a?r.createElement(s.ContributedContent,Object.assign({onDependenciesResolved:l&&l.complete,className:(0,c.css)(e,"flex-grow")},u)):r.createElement("div",{className:"repos-file-editor-background flex-grow"}))}))}))}componentDidMount(){this.content.subscribe(this.onContentChanged)}componentWillUnmount(){this.content.unsubscribe(this.onContentChanged),this.legacyRenderer=null}renderLegacyContent(e){this.legacyRenderer&&this.legacyRenderer.renderContent(e,{})}}t[e].ContentPreview=n;function h(e){try{return decodeURIComponent(e)}catch(t){return e}}t[e].MarkdownFilesHubUrlTransformer=class{constructor(e,t,n,r,o){this.path=e,this.isFolder=t,this.isSelectedVersion=n,this.getItemUrl=r,this.getFileDownloadUrl=o,this.transformImage=e=>{const t=new l.Uri(e);return t.scheme||t.host?e:this.getFileDownloadUrl(this.getTargetPath(e))},this.transformLink=e=>{try{const t=new l.Uri(e);return t.scheme||t.host?e:t.path?this.getItemUrl(this.getTargetPath(t.path),h(t.hashString)):t.hashString?this.getItemUrl(this.path,h(t.hashString)):e}catch(e){}return e},this.parseFilesHubUrl=e=>{const t=new l.Uri(e);if(!t.scheme||!t.host){const e=t.getQueryParam("version");if(!e||this.isSelectedVersion(e)){const e=this.path;let n=t.getQueryParam("path")||"";n===e&&(n="");const r=t.hashString||t.getQueryParam("anchor")||"";if(n||r)return{path:n,anchor:r}}}}}getTargetPath(e){if("/"===e[0])return e;const t="$"===this.path[0]?"$/":"/",n=this.isFolder?this.path:(0,o.getParentPath)(this.path,t)||"";return h((0,l.resolveRelativePath)((0,l.combineUrlPaths)(n,e)))}}}("ComponentsContentPreview"),function(e){t.GitFilesService={};class r extends h.ChangesFilesService{_serviceStart(e){super._serviceStart(e);const t=this.pageContext.getService("IVCViewModelDataProviderService").getRepository();this.repositoryId=t.id,this.projectId=t.project.id}convertDescriptorToVersion(e){return(0,m.getVersionString)(e)}convertVersionToDescriptor(e){return!e||"G"!==e[0]&&"P"!==e[0]?(0,m.commitToVersionDescriptor)(e):(0,m.gitVersionStringToVersionDescriptor)(e)}getFileDownloadUrl(e,t,n=!1){const r=this.pageContext.getService("IVssPageService").getData().hostPath,o=new l.Uri((0,l.combineUrlPaths)(r,`${this.projectId}/_apis/git/repositories/${this.repositoryId}/items`));return o.addQueryParams({path:e,"versionDescriptor[versionOptions]":t.versionOptions||0,"versionDescriptor[versionType]":t.versionType||0,"versionDescriptor[version]":t.version,resolveLfs:!0,$format:"octetStream","api-version":"5.0"}),n&&o.addQueryParam("download","true"),o.absoluteUri}getFileDiff(e){return this.getFileDiffEntry(e).observable}getItemContent(e,t){const n=new i.ObservableValue(void 0);return this.getItemContentPromise(e,t).then((e=>{n.value=e})),n}getItemContentPromise(e,t){return this.pageContext.getRestClient(s).getItemContent(this.repositoryId,e,this.projectId,t).then((n=>{const r=n.item;return{commitId:r.commitId,details:{content:r.content,contentTruncated:n.truncated,metadata:r.contentMetadata,objectId:r.objectId,resourceUri:(0,p.getGitResourceUri)(this.repositoryId,t,e)}}}),(n=>({commitId:"",details:{content:"",contentTruncated:!1,metadata:{},objectId:"",resourceUri:(0,p.getGitResourceUri)(this.repositoryId,t,e)},error:n})))}getObjectId(e){return e.objectId.full}}n.Services.add("IGitFilesService",{serviceFactory:r});class o extends C.RestClientBase{async getItemContent(e,t,n,r){const o=await this.beginRequest({apiVersion:"5.0",queryParams:{path:t,recursionLevel:0,includeContentMetadata:!0,versionDescriptor:r,includeContent:!0,resolveLfs:!0},routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Items/{*path}",routeValues:{project:n,repositoryId:e},returnRawResponse:!0});return{item:await o.text().then(g.deserializeVssJsonObject),truncated:206===o.status}}}const s="Repos.Files.Git.IGitItemContentRestClient";n.RestClients.add(s,{factory:o,options:{resourceAreaId:"4e080c62-fa21-4fbc-8fef-2a10a2b38049",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}(),function(e){t.RestClientGit={};class r extends C.RestClientBase{constructor(e){super(e)}async getFilePaths(e,t,n,r){const o={scopePath:n,versionDescriptor:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/FilePaths/{*scopepath}",routeValues:{project:e,repositoryId:t},queryParams:o})}async getItemsBatch(e,t,n){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/ItemsBatch",routeValues:{project:n,repositoryId:t},body:e})}}t.RestClientGit.GitClientName="Repos.CommitHub.Git.IGitRestClient",t.RestClientGit.getGitClient=function(e,n){return e.getRestClient(t.RestClientGit.GitClientName,n)},n.RestClients.add(t.RestClientGit.GitClientName,{factory:r,options:{resourceAreaId:"4e080c62-fa21-4fbc-8fef-2a10a2b38049",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}()}),["Resources","ContentPreview","Components/ContentPreview","GitFilesService","RestClient/Git"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-code-web.files"}}));