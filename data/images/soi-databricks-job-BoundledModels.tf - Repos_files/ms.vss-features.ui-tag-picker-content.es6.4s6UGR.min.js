"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/TimerManagement"],(function(e,t,s,i,n){var l;!function(e){l=t[e]={};class a extends s.Component{constructor(e){super(e),this.inputElement=s.createRef(),this.outerElement=s.createRef(),this.textValue=new i.ObservableValue(""),this.suggestionsVisible=new i.ObservableValue(!1),this.selectedIndex=new i.ObservableValue(-1),this.selectableTags=new i.ObservableArray([]),this.clearTagPicker=()=>{this.suggestionsVisible.value=!1,this.textValue.value="",this.selectedIndex.value=-1},this.suggestionsLoaded=()=>(-1===this.selectedIndex.value&&!i.ObservableLike.getValue(this.props.suggestionsLoading)&&this.inputElement.current&&""!==this.inputElement.current.value&&(this.updateIndexTimer&&window.cancelAnimationFrame(this.updateIndexTimer),this.updateIndexTimer=window.requestAnimationFrame((()=>{this.selectedIndex.value=0}))),!0),this.createGenericItem=(e,t)=>{if(0===e.trim().length)return;const s=this.props.createDefaultItem&&this.props.createDefaultItem(e);return s&&t.some((e=>this.props.areTagsEqual(s,e)))?void 0:s},this.onBlur=()=>{if(this.props.shouldBlurClear&&!this.props.shouldBlurClear())return;const e=this.textValue.value;this.textValue.value="",this.selectableTags.value=[],this.props.onBlur&&this.props.onBlur(e),this.onSuggestionsDismiss()},this.onFocus=()=>{this.props.onFocus&&this.props.onFocus()},this.onOuterKeyDown=e=>{switch(e.which){case 46:case 8:!e.isDefaultPrevented()&&this.selectableTags.value.length>0&&(this.props.onTagsRemoved&&this.props.onTagsRemoved(this.selectableTags.value),this.selectableTags.value=[],this.focusInput(),e.preventDefault())}},this.onKeyDown=e=>{const t=e.which,s=this.inputElement.current,n=this.suggestionsVisible.value,l=i.ObservableLike.getValue(this.props.suggestions);switch(t){case 27:this.onSuggestionsDismiss(),e.preventDefault();break;case 9:case 13:if(!e.shiftKey)if(n)this.completeSuggestion(),e.preventDefault();else if(this.props.createDefaultItem){const t=this.createGenericItem(this.textValue.value,i.ObservableLike.getValue(this.props.selectedTags));t&&(this.addItem(t),e.preventDefault())}break;case 38:n&&(this.selectedIndex.value=Math.max(0,this.selectedIndex.value-1),e.preventDefault());break;case 40:n?(this.selectedIndex.value=Math.min(l.length-1,this.selectedIndex.value+1),e.preventDefault()):""===this.textValue.value?(this.props.onEmptyInputFocus&&this.props.onEmptyInputFocus(),this.suggestionsVisible.value=!0,e.preventDefault()):(this.suggestionsVisible.value=!0,e.preventDefault());break;case 39:n&&l&&l[this.selectedIndex.value]&&this.props.onSuggestionExpanded&&s&&s.value.length===s.selectionEnd&&(this.props.onSuggestionExpanded(l[this.selectedIndex.value]),e.preventDefault())}},this.onInputClick=e=>{this.props.onEmptyInputFocus&&""===this.textValue.value&&this.props.onEmptyInputFocus(),this.suggestionsVisible.value=!0,e&&e.preventDefault()},this.onInputChange=e=>{this.textValue.value=e.target.value,this.selectedIndex.value=-1,this.onResolveInput(e),e.persist(),e.preventDefault()},this.onResolveInput=e=>{const t=this.props.deliminator&&this.textValue.value.split(this.props.deliminator);this.props.onDelimitedSearch&&this.props.deliminator&&t&&t.length>1?this.props.onDelimitedSearch(this.textValue.value.split(this.props.deliminator).filter((e=>""!==e))):(this.props.onSearchChanged(e.target.value),this.suggestionsVisible.value=!0)},this.onTagClicked=(e,t)=>{if(!e||!e.isDefaultPrevented()){const s=this.indexOfTag(t,this.selectableTags.value);if(!this.props.onTagsRemoved)return;s<0?this.selectableTags.push(t):this.selectableTags.splice(s,1),e&&e.preventDefault()}},this.onTagRemoved=e=>{const t=this.indexOfTag(e,this.selectableTags.value);t>=0&&this.selectableTags.splice(t,1),this.props.onTagRemoved(e),this.inputElement.current&&this.inputElement.current.focus()},this.onTagPickerSizeChanged=(e,t)=>{this.setState({width:e})},this.completeSuggestion=()=>{const e=i.ObservableLike.getValue(this.props.suggestions)[this.selectedIndex.value];e&&this.addItem(e)},this.onSuggestionClick=e=>{this.addItem(e.item)},this.addItem=e=>{this.suggestionsVisible.value=!1,this.props.onTagAdded(e),this.textValue.value="",this.selectedIndex.value=-1,this.focusInput()},this.focusInput=()=>{this.inputElement.current&&(this.inputElement.current.focus(),this.inputElement.current.select())},this.onSuggestionsDismiss=()=>{this.suggestionsVisible.value=!1},this.indexOfTag=(e,t)=>t.findIndex((t=>this.props.areTagsEqual(t,e))),this.state={width:296},this.timerManagement=new n.TimerManagement}render(){const{ariaLabel:e,ariaLabelledBy:i,className:n,convertItemToPill:l,noResultsFoundText:a,onTagsRemoved:o,placeholderText:r,prefixIconProps:u,renderSuggestionItem:c,selectedTags:g,suggestions:h,suggestionsLoading:d,suggestionsLoadingText:p}=this.props;return s.createElement(t.FocusWithin.FocusWithin,{onBlur:this.onBlur,onFocus:this.onFocus},(m=>s.createElement(s.Fragment,null,s.createElement(t.Observer.Observer,{suggestionsLoading:{observableValue:d,filter:this.suggestionsLoaded},suggestionsVisible:this.suggestionsVisible,selectedIndex:this.selectedIndex,selectableTags:this.selectableTags,selectedTags:g,suggestions:{observableValue:h,filter:this.suggestionsLoaded},textValue:this.textValue},(a=>{const c=this.createGenericItem(this.textValue.value,a.suggestions.concat(a.selectedTags));return c&&a.suggestions.unshift(c),s.createElement(t.Measure.Measure,{onMeasure:this.onTagPickerSizeChanged},s.createElement("div",{className:(0,t.Util.css)("bolt-tag-picker",(m.hasFocus||a.suggestionsVisible)&&"edit",n),ref:this.outerElement,onBlur:m.onBlur,onFocus:m.onFocus,onClick:this.focusInput},s.createElement("div",{className:"bolt-tag-picker-group flex-center flex-row flex-grow flex-wrap",onKeyDown:o&&this.onOuterKeyDown},0===a.selectedTags.length&&u?s.createElement(t.Icon.Icon,Object.assign({},u,{className:(0,t.Util.css)(u.className,"bolt-tag-picker-prefix-icon")})):null,a.selectedTags.map(((e,i)=>{const n=l(e,i),r=this.indexOfTag(e,a.selectableTags);return s.createElement(t.Pill.Pill,Object.assign({},n,{key:(0,t.Util.getSafeId)("bolt-tag-picker-pill"+i),className:(0,t.Util.css)(n.className,"bolt-tag-picker-pill",o&&"bolt-tag-picker-pill-selectable",r>=0&&"active"),contentClassName:"text-ellipsis scroll-hidden",onClick:t=>{this.onTagClicked(t,e),n.onClick&&n.onClick(t)},onRemoveClick:t=>{this.onTagRemoved(e),t.preventDefault()}}),n.content)})),s.createElement(t.FormItem.FormItemContext.Consumer,null,(n=>{const l=0===a.selectedTags.length||m.hasFocus?r:void 0,o=!m.hasFocus&&a.selectedTags.length>0&&!a.suggestionsVisible;let u;a.suggestionsVisible&&(u=-1===a.selectedIndex||a.suggestionsLoading?(0,t.Util.getSafeId)("sug-list-transition"):a.suggestions&&a.suggestions.length?(0,t.Util.getSafeId)(`sug-row-${a.selectedIndex}`):(0,t.Util.getSafeId)("sug-list-no-results"));const c=a.suggestionsVisible?(0,t.Util.getSafeId)("tag-picker-callout"):void 0;return s.createElement("div",{className:"bolt-tag-picker-add-icon-div flex-row flex-grow"},o&&s.createElement(t.Icon.Icon,{className:"bolt-tag-picker-add-icon cursor-pointer",iconName:"Add",size:"small"}),s.createElement("input",{"aria-activedescendant":u,"aria-autocomplete":"list","aria-controls":c,"aria-expanded":a.suggestionsVisible,"aria-haspopup":"listbox","aria-label":e||r,"aria-labelledby":(0,t.Util.getSafeId)(i||n.ariaLabelledById),className:(0,t.Util.css)("bolt-tag-picker-input flex-row flex-grow scroll-hidden",o&&!l&&"hide-input"),onBlur:m.onBlur,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onClick:this.onInputClick,placeholder:l,ref:this.inputElement,role:"combobox",type:"text",value:a.textValue}))})))))})),s.createElement(t.Observer.Observer,{suggestionsVisible:this.suggestionsVisible,suggestionsLoading:d,selectedIndex:this.selectedIndex,suggestions:h,textValue:this.textValue},(e=>e.suggestionsVisible?s.createElement(t.Callout.Callout,{anchorElement:this.outerElement.current||void 0,anchorOrigin:{horizontal:"start",vertical:"end"},calloutOrigin:{horizontal:"start",vertical:"start"},contentClassName:"bolt-tag-picker-callout-content scroll-hidden",contentShadow:!0,id:"tag-picker-callout",role:"presentation"},s.createElement(t.SuggestionsList.SuggestionsList,{isLoading:e.suggestionsLoading,loadingText:p,onBlur:m.onBlur,onFocus:m.onFocus,noResultsFoundText:e.textValue?a:void 0,onSuggestionClicked:this.onSuggestionClick,renderSuggestion:c,selectedIndex:e.selectedIndex,suggestions:e.suggestions,width:this.state.width})):null)))))}componentDidMount(){this.onResolveInput=this.timerManagement.debounce(this.onResolveInput,this.props.onSearchChangedDebounceWait)}focus(){this.inputElement.current&&this.inputElement.current.focus()}}t[e].TagPicker=a,a.defaultProps={onSearchChangedDebounceWait:250}}("ComponentsTagPickerTagPicker"),t.TagPicker={},__exportStar(l,t.TagPicker)}),["Components/TagPicker/TagPicker","TagPicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-tag-picker-content"}}));