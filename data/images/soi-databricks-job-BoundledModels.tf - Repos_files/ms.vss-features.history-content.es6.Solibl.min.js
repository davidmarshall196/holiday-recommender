"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSS/Features",["require","exports","VSS/Platform/Context","VSSUI/Utilities/Filter"],(function(e,t,i,s){var a;!function(e){a=t[e]={};class r extends i.VssService{constructor(){super(...arguments),this.maintainedFilters={},this.maintainedObservables={},this.changeQueue=[],this.commitChangesTimeoutId=void 0,this.commitChanges=()=>{for(;this.changeQueue.length>0;){let e=this.historyService.getState(),t=this.changeQueue.shift();const i=t.historyBehavior;for(e=this.generateNextState(t,e);this.changeQueue.length>0&&0===this.changeQueue[0].historyBehavior;)t=this.changeQueue.shift(),e=this.generateNextState(t,e);switch(i){case 1:this.historyService.pushState(e);break;case 0:this.historyService.replaceState(e);break;default:return}}this.commitChangesTimeoutId=void 0},this.onFilterChange=(e,t)=>{const i=this.maintainedFilters[t];this.applyFilterStateToHistory(i.filter,i.key,i.filterFields)},this.onFPS=()=>{for(const e in this.maintainedObservables)this.unregisterObservable(e);for(const e in this.maintainedFilters)this.unregisterFilter(e)},this.onNavigate=e=>{const t=e.newState;if(t){for(const e in this.maintainedObservables){const i=t.state[e]||"",s=this.maintainedObservables[e],a=s.parsingFunction?s.parsingFunction(i):i;s.observable.value!==a&&(s.observable.value=a)}for(const e in this.maintainedFilters){const i=this.maintainedFilters[e];this.applyHistoryStateToFilter(t.state,i.filter,i.key,i.filterFields)}}},this.onObservableChange=(e,t)=>{const i=this.maintainedObservables[t];if(!i)return void 0;const s=i.mappingFunction?i.mappingFunction(e):e,a=this.historyService.getState();if((a&&a[t]||"")!==(s||"")){const a="function"==typeof i.historyBehavior?i.historyBehavior(e):i.historyBehavior;this.enqueueChange({historyBehavior:a,key:t,newValue:s})}}}_serviceStart(e){super._serviceStart(e),this.historyService=this.pageContext.getService("IVssHistoryService"),this.historyService.subscribe(this.onNavigate),document.body.addEventListener("fpsLoading",this.onFPS)}_serviceEnd(){this.historyService.unsubscribe(this.onNavigate)}getProjectedState(){let e=this.historyService.getState();for(const t of this.changeQueue)e=this.generateNextState(t,e);return e}queueState(e,t){const i={state:e,historyBehavior:t};this.enqueueChange(i)}queueValueChange(e,t,i){const s={key:e,newValue:t,historyBehavior:i};this.enqueueChange(s)}registerFilter(e,t,i){this.maintainedFilters[t]||(this.applyHistoryStateToFilter(this.historyService.getState(),e,t,i),this.applyFilterStateToHistory(e,t,i,0),e.subscribe((e=>this.onFilterChange(e,t)),e.usesApplyMode()?s.FILTER_APPLIED_EVENT:s.FILTER_CHANGE_EVENT),this.maintainedFilters[t]={filter:e,filterFields:i,key:t})}registerObservable(e,t,i,s,a){if(!(s&&a||"string"==typeof e.value))return;if(this.maintainedObservables[t])return;const r=this.historyService.getState();if(r[t]){const i=a?a(r[t]):r[t],s=e;s.value!==i&&(s.value=i)}else{const i=s?s(e.value):e.value;i&&this.enqueueChange({historyBehavior:0,key:t,newValue:i})}e.subscribe((e=>this.onObservableChange(e,t))),this.maintainedObservables[t]={key:t,observable:e,historyBehavior:i,mappingFunction:s,parsingFunction:a}}unregisterFilter(e){this.maintainedFilters[e]&&(this.maintainedFilters[e].filter.unsubscribe((t=>this.onFilterChange(t,e)),s.FILTER_CHANGE_EVENT),delete this.maintainedFilters[e])}unregisterObservable(e){this.maintainedObservables[e]&&(this.maintainedObservables[e].observable.unsubscribe((t=>this.onObservableChange(t,e))),delete this.maintainedObservables[e])}applyFilterStateToHistory(e,t,i,s){const a=e.getState();for(const e of i){const i=e.filterKey,r=s||e.historyBehavior;let n=a[i];if(n){const s=n.value,a=`${t}${i}`;switch(e.dataType){case"string":this.queueValueChange(a,s,r);break;case"boolean":case"number":this.queueValueChange(a,`${s}`,r);break;case"object":this.queueValueChange(a,e.mappingFunction(s),r)}n.operator&&this.queueValueChange(`${a}_Op`,n.operator,r)}else this.queueValueChange(`${t}${i}`,"",r),this.queueValueChange(`${t}${i}_Op`,"",0)}}applyHistoryStateToFilter(e,t,i,s){const a=t.getState();let r=!1;for(const t of s){const s=`${i}${t.filterKey}`,n=`${i}${t.filterKey}_Op`;e[s]&&(a[t.filterKey]&&null!==a[t.filterKey]?a[t.filterKey].value=this.mapStringToFilterItemValue(e[s],t):a[t.filterKey]={value:this.mapStringToFilterItemValue(e[s],t)},r=!0),e[n]&&(a[t.filterKey]&&null!==a[t.filterKey]?a[t.filterKey].operator=e[n]:a[t.filterKey]={operator:e[n],value:""},r=!0)}r&&(t.setState(a),t.usesApplyMode()&&t.applyChanges())}mapStringToFilterItemValue(e,t){switch(t.dataType){case"string":return e;case"number":return Number(JSON.parse(e));case"boolean":return Boolean(JSON.parse(e));case"object":return t.parsingFunction(e)}}enqueueChange(e){this.changeQueue.push(e),this.commitChangesTimeoutId||(this.commitChangesTimeoutId=setTimeout(this.commitChanges,0))}generateNextState(e,t){if("newValue"in e){const i={};return Object.assign(i,t),""!==e.newValue?i[e.key]=e.newValue:delete i[e.key],i}return e.state}}t[e].PageStateHistoryService=r,i.Services.add("IPageStateHistoryService",{serviceFactory:r,options:2})}("PageStateHistoryServicePageStateHistoryService"),t.History={},Object.defineProperty(t.History,"PageStateHistoryService",{enumerable:!0,get:function(){return a.PageStateHistoryService}})}),["PageStateHistoryService/PageStateHistoryService","History"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.history-content"}}));