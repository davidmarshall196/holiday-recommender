"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/Util/Accessibility","VSS/Core/Util/String","VSS/Core/TimerManagement"],(function(e,t,s,i,o,n,r){var l,a,d,c,p,h,u,m,b,x,f,g,I,v,w,C,T,S;l=t.ResourcesDropdown={},t.ResourcesDropdown.AnnounceFilterCleared="Filter selection cleared",t.ResourcesDropdown.AnnounceFilterResultCount="Showing {0} filtered items.",t.ResourcesDropdown.AnnounceFinishedLoadingItems="Finished loading items",t.ResourcesDropdown.AnnounceItemCount="Showing {0} items.",t.ResourcesDropdown.AnnounceLoadingItems="Loading items",t.ResourcesDropdown.ClearText="Clear text",t.ResourcesDropdown.Close="Close",t.ResourcesDropdown.DropdownClearActionText="Clear",t.ResourcesDropdown.DropdownCalloutRoleDescription="Expanded dropdown",t.ResourcesDropdown.DropdownExpandableRoleDescription="Dropdown",t.ResourcesDropdown.HeaderAriaLabel="Header {0}",t.ResourcesDropdown.ListboxAriaLabel="Listbox",t.ResourcesDropdown.Loading="Loading...",t.ResourcesDropdown.NoFilterResults="No items matched the supplied filter",t.ResourcesDropdown.NoItemsFound="No items found",t.ResourcesDropdown.SearchAriaLabel="Search",t.ResourcesDropdown.Searching="Searching...",t.ResourcesDropdown.UseItem='Use "{0}"',function(e){a=t[e]={};let i=1;class o extends s.Component{constructor(e){super(e),this.textFieldElement=s.createRef(),this.expandable=s.createRef(),this.collapse=()=>{this.expandable.current&&this.expandable.current.collapse()},this.expand=()=>{this.expandable.current&&this.expandable.current.expand()},this.renderCallout=()=>this.props.renderCallout(this,this.dropdownId,this.props.anchorElement?this.props.anchorElement:this.props.anchorPoint?void 0:this.containerElement.current?this.containerElement.current:void 0,this.props.anchorOffset||{horizontal:0,vertical:0},this.props.anchorOrigin||{horizontal:"end",vertical:"end"},this.props.anchorPoint,this.props.dropdownOrigin||{horizontal:"end",vertical:"start"}),this.dropdownId=e.dropdownId||"dropdown-"+i++,this.containerElement=e.containerRef||s.createRef()}render(){return s.createElement(t.Expandable.Expandable,{disabled:this.props.disabled,expandKey:this.props.expandKey,onCollapse:this.props.onCollapse,onExpand:this.props.onExpand,renderCallout:this.renderCallout,ref:this.expandable},(e=>s.createElement(t.FocusWithin.FocusWithin,{onFocus:this.props.onFocus,onBlur:this.props.onBlur},(i=>s.createElement("div",{className:(0,t.Util.css)(this.props.className,"bolt-expandable-textfield"),onBlur:()=>{this.props.blurDismiss&&this.collapse(),i.onBlur&&i.onBlur()},onFocus:e=>{i.onFocus&&i.onFocus(e),e.target===this.containerElement.current&&this.focus()},onMouseDown:e.onMouseDown,onKeyDown:e.onKeyDown,ref:this.containerElement,tabIndex:-1},s.createElement(t.TextField.TextField,Object.assign({ariaHasPopup:"dialog"},this.props,{ariaActiveDescendant:e.expanded?this.props.ariaActiveDescendant:void 0,role:this.props.editable?"combobox":void 0,ariaExpanded:e.expanded,ariaControls:e.expanded?this.dropdownId:void 0,className:"",onClick:e.onClick,ref:this.textFieldElement,suffixIconProps:this.props.hideDropdownIcon?void 0:{key:"dropdown-icon",className:(0,t.Util.css)("bolt-expandable-textfield-icon icon-right",this.props.disabled&&"disabled"),iconName:"ChevronDownMed",onClick:e.onClick,size:"small"}})))))))}focus(){this.textFieldElement.current&&this.textFieldElement.current.focus()}select(){this.textFieldElement.current&&this.textFieldElement.current.select()}}t[e].ExpandableTextField=o,o.defaultProps={expandKey:[40,13]}}("ComponentsExpandableTextFieldExpandableTextField"),d=t.ExpandableTextField={},Object.defineProperty(t.ExpandableTextField,"ExpandableTextField",{enumerable:!0,get:function(){return a.ExpandableTextField}}),function(e){c=t[e]={};class s extends t.List.ListSelection{constructor(){super({selectOnFocus:!1})}}t[e].DropdownSelection=s;class i extends t.List.ListSelection{constructor(){super({alwaysMerge:!0,multiSelect:!0,selectOnFocus:!1})}}t[e].DropdownMultiSelection=i}("UtilitiesDropdownSelection"),function(e){p=t[e]={},t[e].DefaultListBoxWidth=-100;class r extends s.Component{constructor(e){super(e),this.tabbableIndex=-1,this.positions=[],this.count=0,this.table=s.createRef(),this.tree=s.createRef(),this.getItemWidth=()=>{const{width:e}=this.props;return this.multiSelect&&e&&e>0?e-40:e},this.loadingChanged=()=>{if(i.ObservableLike.getValue(this.props.loading))o.announce(l.AnnounceLoadingItems);else{o.announce(l.AnnounceFinishedLoadingItems);const e=this.props.items.length;o.announce((0,n.format)(e>0?(0,n.format)(l.AnnounceItemCount,e):l.NoFilterResults),!0)}return!0},this.searchingChanged=()=>{if(i.ObservableLike.getValue(this.props.searching))o.announce(l.Searching);else if(!1===i.ObservableLike.getValue(this.props.searching)){const e=this.props.items.length;o.announce(e>0?(0,n.format)(l.AnnounceFilterResultCount,e):l.NoFilterResults,!0)}return!0},this.onItemsChanged=()=>{const e=x(this.wrappedItems||this.props.items);this.tabbableIndex=-1,this.positions=[],this.count=0;for(const t of e){const e=i.ObservableLike.getValue(t);e&&!u(e)?this.positions.push(-1):(-1===this.tabbableIndex&&this.selection.selectable(this.positions.length)&&(this.tabbableIndex=this.positions.length),this.positions.push(++this.count))}return!0},this.onActivate=(e,t)=>{this.props.onActivate&&this.props.onActivate(e,t.data)},this.onSelect=(e,t)=>{this.props.onSelect&&this.props.onSelect(e,t.data)},this.onTreeActivate=(e,t)=>{const s=this.getListBoxItems();if(this.props.onActivate&&s){const i=t.data.underlyingItem,o=s.find((e=>e.id===i.id));o&&this.props.onActivate(e,o)}},this.onTreeSelect=(e,t)=>{const s=this.getListBoxItems();if(this.props.onSelect&&s){const i=t.data.underlyingItem,o=s.find((e=>e.id===i.id));o&&this.props.onSelect(e,o)}},this.renderListBoxRow=(e,i,o)=>{const{excludeFocusZone:n,excludeTabStop:r}=this.props,l=(x(this.wrappedItems||this.props.items),!n&&this.selection.selectable(e)),a=Object.assign(Object.assign({tooltipProps:i.tooltipProps||{text:i.text,overflowOnly:!0,overflowDetected:d}},o),{ariaDescribedBy:3!==i.type&&2!==i.type?`header-${i.groupId}`:void 0,ariaPosInSet:this.positions[e]>=0?this.positions[e]:null,ariaSetSize:this.positions[e]>=0?this.count:null,excludeTabStop:r||this.tabbableIndex!==e,excludeFocusZone:!l,id:i.id,singleClickActivation:!1,role:2===i.type||3===i.type?"presentation":"option"});return s.createElement(t.Observer.Observer,{key:i.id||e,item:i},(()=>s.createElement(t.Table.TableRow,{key:i.id||e,index:e,details:a,className:(0,t.Util.css)("bolt-list-box-row",2===i.type&&"bolt-list-box-header-row",3===i.type&&"bolt-list-box-divider-row",4===i.type&&"bolt-list-box-loading-row",this.multiSelect&&"bolt-list-box-multi-select-row",2!==i.type&&3!==i.type&&"cursor-pointer",i.disabled&&"bolt-list-box-item-disabled")},this.columns.map(((s,o)=>{if(this.multiSelect&&0===o){if(3===i.type||4===i.type)return null;if(2===i.type)return(0,t.Table.renderEmptyCell)(e,o)}return s.renderCell(e,o,s,i)})))))},this.renderListBoxTreeRow=(e,i,o)=>{const{excludeFocusZone:n,excludeTabStop:r}=this.props,l=!n&&this.selection.selectable(e),a=i.underlyingItem.data,c=Object.assign(Object.assign({tooltipProps:{text:i.underlyingItem.text,overflowOnly:!0,overflowDetected:d}},o),{ariaPosInSet:this.positions[e]>=0?this.positions[e]:null,ariaSetSize:this.positions[e]>=0?this.count:null,excludeTabStop:r||this.tabbableIndex!==e,excludeFocusZone:!l,id:i.underlyingItem.id,singleClickActivation:!1,role:2===a.type||3===a.type?"row":"treeitem"});return s.createElement(t.Observer.Observer,{key:`observer-${i.underlyingItem.id||e}`,item:i},(()=>s.createElement(t.TreeEx.TreeRow,{key:`row-${i.underlyingItem.id||e}`,index:e,details:c,className:(0,t.Util.css)("bolt-list-box-row",2===a.type&&"bolt-list-box-header-row",3===a.type&&"bolt-list-box-divider-row",4===a.type&&"bolt-list-box-loading-row",this.multiSelect&&"bolt-list-box-multi-select-row",2!==a.type&&3!==a.type&&"cursor-pointer",a.disabled&&"bolt-list-box-item-disabled")},this.columns.map(((t,s)=>t.renderCell(e,s,t,i))))))},this.renderListBoxCell=(e,t,s,i)=>a(e,t,s,i,this.multiSelect);const{selection:r,renderItem:p,items:h}=this.props;this.selection=r||new c.DropdownSelection,this.multiSelect=!this.props.enforceSingleSelect&&!this.props.showTree&&this.selection.multiSelect,this.props.columns?this.columns=this.props.columns:(this.columns=[],this.multiSelect&&!1!==this.props.showChecksColumn?this.columns.push(new t.Table.ColumnSelect({role:"presentation",excludeFocusZone:!0})):this.multiSelect||!0!==this.props.showChecksColumn||this.columns.push({id:"column-check",width:24,renderCell:(e,i)=>s.createElement(t.Table.SimpleTableCell,{columnIndex:i,key:"column-check",role:"presentation"},s.createElement(t.Icon.Icon,{className:(0,t.Util.css)(!this.selection.selected(e)&&"invisible"),iconName:"CheckMark"})),readonly:!0}),this.columns.push({id:"text",width:this.getItemWidth(),renderCell:p||this.renderListBoxCell,className:(0,t.Util.css)("bolt-list-box-text",this.multiSelect?"bolt-list-box-text-multi-select":"bolt-list-box-text-single-select"),readonly:!0})),this.wrappedItems=m(h),this.onItemsChanged()}componentDidUpdate(){this.props.didUpdate&&this.props.didUpdate()}render(){const{ariaLabel:e,className:i,containerClassName:o,enforceSingleSelect:n,focuszoneProps:r,getUnselectableRanges:a,items:d,loading:c,searching:p,searchResultsLoadingText:h,showItemsWhileSearching:u,width:m}=this.props,x={observableValue:d,filter:this.onItemsChanged},f=this.getListBoxItems(),g=f?this.props.showTree?new t.UtilitiesTreeItemProvider.TreeItemProvider(b(f)):new t.UtilitiesProvider.ArrayItemProvider(f):d;return this.props.columns||(this.columns[this.columns.length-1].width=this.getItemWidth()),s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:a,items:d,selection:this.selection},s.createElement(t.Observer.Observer,{items:x,loading:{observableValue:c||!1,filter:this.loadingChanged},searching:{observableValue:p||!1,filter:this.searchingChanged}},(a=>{if(a.searching&&!u)return s.createElement("div",{className:"bolt-list-box-loading",style:{width:m}},s.createElement(t.Spinner.Spinner,{size:"medium",label:h||l.Searching}));if(this.props.showTree){const n=g;return s.createElement(t.TreeEx.Tree,{ariaLabel:e||l.ListboxAriaLabel,className:(0,t.Util.css)(i,"bolt-list-box"),columns:this.columns,containerClassName:o,focuszoneProps:r,itemProvider:n,onActivate:this.onTreeActivate,onSelect:this.onTreeSelect,onToggle:(e,t)=>{e.target.className.includes("bolt-tree-expand-button")&&(n.toggle(t.underlyingItem),this.props.onToggle&&this.props.onToggle(e,t.underlyingItem.data))},ref:this.tree,renderRow:this.renderListBoxTreeRow,role:"listbox",scrollable:!0,singleClickActivation:!1,selection:this.selection,showHeader:!1,showLines:!1})}return s.createElement(t.Table.Table,{ariaLabel:e||l.ListboxAriaLabel,className:(0,t.Util.css)(i,"bolt-list-box"),columns:this.columns,containerClassName:o,enforceSingleSelect:n,focuszoneProps:r,itemProvider:g,onActivate:this.onActivate,onSelect:this.onSelect,renderRow:this.renderListBoxRow,ref:this.table,role:"listbox",scrollable:!0,singleClickActivation:!1,selection:this.selection,showHeader:!1,showLines:!1,spacerWidth:0})})))}scrollIntoView(e,t){return this.table.current?this.table.current.scrollIntoView(e,t):this.tree.current?this.tree.current.scrollIntoView(e,t):void 0}getListBoxItems(){var e,t;return null!==(t=null!==(e=this.wrappedItems)&&void 0!==e?e:this.props.items&&(Array.isArray(this.props.items)?this.props.items:this.props.items.value))&&void 0!==t?t:void 0}}function a(e,i,o,r,a){return r.render?r.render(e,i,o,r):3===r.type?s.createElement(t.Table.SimpleTableCell,{className:(0,t.Util.css)(o.className,r.className,a&&"bolt-list-box-divider-multi-select"),columnIndex:i,colspan:a?2:1,key:r.id,role:"presentation",tableColumn:o},s.createElement("div",{className:"bolt-list-box-divider flex-grow"})):4===r.type?s.createElement(f,{columnIndex:i,key:r.id,tableColumn:o,tableItem:r}):s.createElement(t.Table.SimpleTableCell,{className:(0,t.Util.css)(o.className,r.className,2===r.type&&"bolt-list-box-header"),columnIndex:i,key:r.id,role:"presentation",tableColumn:o},s.createElement("div",{id:2===r.type?`header-${r.groupId}`:void 0,"aria-label":2===r.type?(0,n.format)(l.HeaderAriaLabel,r.text):void 0,className:"bolt-list-box-cell-container"},r&&(0,t.List.renderListCell)(r,!1)))}function d(e){const t=e.querySelector(".text-ellipsis");return!!t&&t.scrollWidth>Math.ceil(t.offsetWidth)}function h(e,t=u){const s=[];let i=-1;for(let o=0;o<e.length;o++)!t(e[o])&&i<0?i=o:t(e[o])&&i>=0&&(s.push({beginIndex:i,endIndex:o-1}),i=-1);return i>=0&&s.push({beginIndex:i,endIndex:e.length-1}),s}function u(e){return 2!==e.type&&3!==e.type&&4!==e.type&&!e.disabled}function m(e){if(Array.isArray(e)&&e.length&&"string"==typeof e[0])return e.map((e=>({id:e,text:e})))}function b(e){const t=[],s=new Map;for(const i of e){const e=s.get(i.id),o={childItems:null==e?void 0:e.childItems,expanded:i.expanded,data:i,id:i.id,text:i.text};if(i.parent){const e=s.get(i.parent.id);e?e.childItems?e.childItems.push(o):e.childItems=[o]:s.set(i.parent.id,{childItems:[o]})}else t.push(o);s.set(o.id,o)}return t}function x(e){return(0,t.UtilitiesProvider.getItemsValue)(e)}t[e].ListBox=r,r.defaultProps={getUnselectableRanges:h,width:t[e].DefaultListBoxWidth},t[e].renderListBoxCell=a,t[e].getUnselectableRanges=h,t[e].listBoxItemSelectable=u,t[e].wrapListBoxItems=m,t[e].convertListBoxItemsToTreeItems=b,t[e].getListBoxItemsValue=x;class f extends s.Component{componentDidMount(){this.props.onMount&&this.props.onMount()}render(){const{columnIndex:e,tableColumn:i,tableItem:o}=this.props;return s.createElement(t.Table.SimpleTableCell,{className:(0,t.Util.css)(i.className,o.className),columnIndex:e,colspan:2,contentClassName:"justify-center",key:e,tableColumn:i},s.createElement("div",{className:"bolt-list-box-loading"},s.createElement(t.Spinner.Spinner,{size:"medium",label:l.Loading})))}}t[e].LoadingCell=f,t[e].isListBoxItemVisible=function(e){let t=e.parent;for(;t;){if(!t.expanded)return!1;t=t.parent}return!0}}("ComponentsListBoxListBox"),h=t.ListBox={},Object.defineProperty(t.ListBox,"DefaultListBoxWidth",{enumerable:!0,get:function(){return p.DefaultListBoxWidth}}),Object.defineProperty(t.ListBox,"getListBoxItemsValue",{enumerable:!0,get:function(){return p.getListBoxItemsValue}}),Object.defineProperty(t.ListBox,"getUnselectableRanges",{enumerable:!0,get:function(){return p.getUnselectableRanges}}),Object.defineProperty(t.ListBox,"isListBoxItemVisible",{enumerable:!0,get:function(){return p.isListBoxItemVisible}}),Object.defineProperty(t.ListBox,"ListBox",{enumerable:!0,get:function(){return p.ListBox}}),Object.defineProperty(t.ListBox,"listBoxItemSelectable",{enumerable:!0,get:function(){return p.listBoxItemSelectable}}),Object.defineProperty(t.ListBox,"LoadingCell",{enumerable:!0,get:function(){return p.LoadingCell}}),Object.defineProperty(t.ListBox,"renderListBoxCell",{enumerable:!0,get:function(){return p.renderListBoxCell}}),Object.defineProperty(t.ListBox,"wrapListBoxItems",{enumerable:!0,get:function(){return p.wrapListBoxItems}}),function(e){u=t[e]={};const o=256;t[e].DropdownCallout=function(e){return s.createElement(r,Object.assign({},e))};class r extends s.Component{constructor(e){super(e),this.callout=s.createRef(),this.calloutContent=s.createRef(),this.filterBox=s.createRef(),this.initFocusElement=s.createRef(),this.updateLayout=()=>(setTimeout((()=>{this.callout.current&&this.callout.current.updateLayout()}),0),!0),this.onMouseDown=e=>{this.props.ignoreMouseDown&&"INPUT"!==e.target.tagName&&(0,t.Util.preventDefault)(e)},this.listBoxDidUpdate=()=>{this.getScrollWidth()},this.getScrollWidth=()=>{window.requestAnimationFrame((()=>{if(this.calloutContent.current&&this.props.width>=0){const e=this.calloutContent.current.offsetWidth-this.props.width;Math.abs(e)>1&&this.setState({scrollBarWidth:e+this.state.scrollBarWidth})}}))},this.state={scrollBarWidth:0}}componentDidMount(){this.getScrollWidth()}focus(){this.filterBox.current?this.filterBox.current.focus():this.initFocusElement.current&&this.initFocusElement.current.focus()}render(){const{actions:e,anchorElement:r,anchorOffset:a,anchorOrigin:d,anchorPoint:c,ariaLabel:p,blurDismiss:u=!0,calloutContentClassName:m,columns:b,containerClassName:x,contentLocation:f,dropdownOrigin:g,enforceSingleSelect:I,excludeFocusZone:v,excludeTabStop:w,filteredItems:C,filteredNoResultsText:T,filteredResultsLoadingText:S,filterPlaceholderText:E,filterText:D,focusOnMount:y,getUnselectableRanges:O,id:F,items:L,lightDismiss:B,listBoxClassName:P,listBoxRef:N,loading:R,onActivate:k,onFilterKeyDown:M,onFilterTextChanged:A,onSelect:U,onToggle:V,renderBeforeContent:j,renderItem:W,searching:H,selection:G,showCloseButton:z,showFilterBox:K,showItemsWhileSearching:Z,showTree:$,title:q,updateFilteredItems:J,userFilteredItems:_}=this.props;let{width:Q=o}=this.props;Q>0&&(Q-=this.state.scrollBarWidth);const X=`bolt-dropdown-textfield-${F}`,Y=()=>{D.value="",A&&A(null,""),J&&J()},ee=()=>{this.props.onDismiss&&this.props.onDismiss(),Y()};return s.createElement(t.Callout.Callout,{anchorElement:r,anchorOffset:a,anchorOrigin:d,anchorPoint:c,role:"presentation",blurDismiss:u,calloutOrigin:g,contentClassName:(0,t.Util.css)(m,"bolt-dropdown flex-column custom-scrollbar v-scroll-auto h-scroll-hidden"),contentLocation:f,contentRef:this.calloutContent,contentShadow:!0,contentSize:3,escDismiss:!0,id:F,lightDismiss:B,focuszoneProps:{postprocessKeyStroke:e=>9!==e.which||e.defaultPrevented?1:(e.preventDefault(),ee(),3)},onDismiss:ee,ref:this.callout},s.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:K||void 0===K&&L.length>10?(0,t.Util.getSafeIdSelector)(X):".bolt-dropdown-init-focus",direction:2,focusOnMount:void 0===y||y,preventScrollOnFocus:window.self!==window.top},s.createElement("div",{className:"bolt-dropdown-container no-outline",onMouseDown:this.onMouseDown,onKeyDown:M,style:{width:Q>=0?Q:void 0}},s.createElement("div",{"aria-hidden":"true","aria-roledescription":l.DropdownCalloutRoleDescription,className:"bolt-dropdown-init-focus no-outline",tabIndex:w?void 0:-1,ref:this.initFocusElement,role:"menuitem"}),s.createElement(t.Observer.Observer,{items:{observableValue:L,filter:this.updateLayout}},(()=>{const e=void 0===K?L.length>10:K;return e||q||z?s.createElement("div",{className:"bolt-dropdown-header-container"},(q||z)&&s.createElement("div",{className:"bolt-dropdown-header flex-row flex-center"},s.createElement("div",{className:"bolt-dropdown-header-text flex-grow font-weight-semibold"},q),z&&s.createElement(t.Button.Button,{className:"bolt-dropdown-header-button",ariaLabel:l.Close,iconProps:{iconName:"Cancel"},onClick:ee,subtle:!0})),e&&s.createElement("div",{key:"bolt-dropdown-filter-container",className:"bolt-dropdown-filter-container"},s.createElement(t.Observer.Observer,{filterText:D},(e=>s.createElement(t.TextField.TextField,{key:"bolt-dropdown-filter",ariaLabel:l.SearchAriaLabel,className:"bolt-dropdown-filter",excludeTabStop:!0,inputId:X,onChange:A,placeholder:E,prefixIconProps:{iconName:"Search"},ref:this.filterBox,value:D,maxWidth:this.props.width-16-27,suffixIconProps:e.filterText.length>0?{ariaLabel:l.ClearText,iconName:"ChromeClose",onClick:Y,size:"small",tooltipProps:{text:l.ClearText},role:"button"}:void 0}))))):null})),j&&j(),s.createElement(t.Observer.Observer,{filteredItems:C,filteredNoResultsText:T,listBoxItems:{observableValue:L,filter:J},userFilteredItems:{observableValue:_,filter:J}},(e=>{let i=null,o="";return(C&&0===C.length||0===L.length)&&!H&&(o=""===D.value?this.props.noItemsText:(0,n.format)(e.filteredNoResultsText||l.NoFilterResults,D.value),o&&(i=s.createElement("div",{className:"bolt-dropdown-no-items"},o))),s.createElement(s.Fragment,null,i,s.createElement(h.ListBox,{ariaLabel:p,className:P,columns:b,containerClassName:(0,t.Util.css)("bolt-dropdown-list-box-container",x),didUpdate:this.listBoxDidUpdate,enforceSingleSelect:I,excludeFocusZone:v,excludeTabStop:!0,searchResultsLoadingText:S,focuszoneProps:null,getUnselectableRanges:O,items:C?C.value:L,loading:R,onActivate:k,onSelect:U,onToggle:V,renderItem:W,ref:N,searching:H,selection:G,showChecksColumn:!0,showItemsWhileSearching:Z,showTree:$}))})),s.createElement(t.Observer.Observer,{actions:e},(e=>{const o=this.props.actions;return o&&o.length?s.createElement("div",{className:"bolt-actions-container flex-column"},i.ObservableLike.getValue(o).map(((e,i)=>s.createElement(t.Button.Button,Object.assign({key:e.id||i,subtle:!0,excludeTabStop:!0},e))))):null})))))}}t[e].DropdownCalloutComponent=r,r.defaultProps={width:o,ignoreMouseDown:!0}}("ComponentsDropdownDropdownCallout"),function(e){function i(e){const{wordBreak:t,whiteSpace:s}=e.style,i=e.clientHeight;e.style.wordBreak="break-all",e.style.whiteSpace="normal";const o=i<e.clientHeight;return e.style.wordBreak=t,e.style.whiteSpace=s,o}m=t[e]={},t[e].DropdownExpandableTextField=function(e){var o;const{editable:n,expandableRef:r,items:a,inputClassName:c,renderSelectedItems:p,selection:h,showPrefix:u=!0}=e,m=__rest(e,["editable","expandableRef","items","inputClassName","renderSelectedItems","selection","showPrefix"]);let b,x;return n||(x=e.placeholder,h.selectedCount>0&&(x=p(h,a))),u&&1===h.selectedCount&&(b=null===(o=a[h.value[0].beginIndex])||void 0===o?void 0:o.iconProps),s.createElement(d.ExpandableTextField,Object.assign({ariaHasPopup:"menu",ariaRoleDescription:n?void 0:l.DropdownExpandableRoleDescription,autoComplete:n,ariaAutoComplete:n?"list":void 0,focusTreatment:n?0:1,inputType:n?void 0:"button",editable:n,ref:r,value:x},m,{className:(0,t.Util.css)(e.className,"bolt-dropdown-expandable-text-field",m.disabled&&"disabled"),inputClassName:(0,t.Util.css)(c,"bolt-dropdown-expandable-textfield-input text-ellipsis"),onClick:e=>r.current&&r.current.expand(),prefixIconProps:e.prefixIconProps||b,tooltipProps:Object.assign({text:x,overflowOnly:!0,overflowDetected:i},e.tooltipProps),required:e.required}))}}("ComponentsDropdownDropdownExpandableTextField"),function(e){b=t[e]={};class a extends s.Component{constructor(e){super(e),this.expandable=s.createRef(),this.expandableContainer=s.createRef(),this.filterText=new i.ObservableValue(""),this.collapse=()=>{this.expandable.current&&this.expandable.current.collapse()},this.expand=()=>{this.expandable.current&&this.expandable.current.expand()},this.onDismiss=()=>{this.expandable.current&&this.expandable.current.collapse()},this.onExpand=()=>{this.props.onExpand&&this.props.onExpand(),this.updateFilteredItems(),this.state.expanded.value=!0},this.onCollapse=()=>{this.props.onCollapse&&this.props.onCollapse(),this.state.expanded.value=!1},this.onActivate=(e,t)=>{if(!e.defaultPrevented&&"keydown"===e.type){const s=!this.props.enforceSingleSelect&&this.state.filteredSelection.multiSelect;s?this.state.filteredSelection.toggle(this.state.filteredItems.value.indexOf(t),this.state.filteredSelection.alwaysMerge,s):this.state.filteredSelection.select(this.state.filteredItems.value.indexOf(t),1,this.state.filteredSelection.alwaysMerge,s),this.onSelect(e,t)}},this.onFilterTextChanged=(e,t)=>{this.filterText.value=t,this.debouncedUpdateFilteredItems()},this.onSelect=(e,t)=>{const{dismissOnSelect:s,onSelect:i}=this.props,o=this.parentSelection;i&&i(e,t),(void 0!==s?s:o.value.length>0&&(this.props.enforceSingleSelect||!o.multiSelect)&&!o.selectOnFocus)&&this.onDismiss()},this.selectionChanged=(e,t)=>(this.state.filteredSelection.selectionChanged(e,t),!0),this.renderCallout=(e,t,s,i,o,n,r)=>{var l;const{actions:a,calloutContentClassName:d,columns:c,containerClassName:p,filterPlaceholderText:h,filteredNoResultsText:u,getUnselectableRanges:m,items:b,loading:x,noItemsText:f,onToggle:g,renderItem:I,renderBeforeContent:v,searching:w,showFilterBox:C,showItemsWhileSearching:T,showTree:S,userFilteredItems:E}=this.props;let D=this.props.width;if(void 0===D&&this.expandableContainer.current){const e=null!==(l=this.props.minCalloutWidth)&&void 0!==l?l:100;D=Math.max(this.expandableContainer.current.clientWidth,e)}const{filteredItems:y,filterText:O,filteredSelection:F}=this.state,L={actions:a,anchorElement:s,anchorOffset:i,anchorOrigin:o,anchorPoint:n,calloutContentClassName:d,columns:c,containerClassName:p,dropdownOrigin:r,filteredItems:y,filteredNoResultsText:u,selection:F,filterPlaceholderText:h,filterText:O,getUnselectableRanges:m,id:t,items:b,loading:x,noItemsText:f,onActivate:this.onActivate,onFilterTextChanged:this.onFilterTextChanged,onDismiss:this.onDismiss,onSelect:this.onSelect,onToggle:g,renderBeforeContent:v,renderItem:I,searching:w,showItemsWhileSearching:T,showFilterBox:C,showTree:S,updateFilteredItems:this.updateFilteredItems,userFilteredItems:E,width:D};return this.props.renderCallout(L)},this.updateFilteredItems=()=>(x(this.props,this.state),!0),this.debouncedUpdateFilteredItems=()=>{x(this.props,this.state)},this.parentSelection=e.selection||new c.DropdownSelection;const o=(0,h.wrapListBoxItems)(e.items),n=(0,h.getListBoxItemsValue)(o||e.items);this.timerManagement=new r.TimerManagement,this.state={expanded:new i.ObservableValue(!1),filteredItems:new i.ObservableArray([...n]),filteredSelection:new t.List.FilteredListSelection(this.parentSelection),filterText:this.filterText,props:e,wrappedItems:o}}static getDerivedStateFromProps(e,t){return e.userFilteredItems===t.props.userFilteredItems&&e.items===t.props.items||x(e,t),Object.assign(Object.assign({},t),{props:e,wrappedItems:(0,h.wrapListBoxItems)(e.items)})}componentDidMount(){this.props.filterThrottleWait&&(this.debouncedUpdateFilteredItems=this.timerManagement.debounce(this.debouncedUpdateFilteredItems,this.props.filterThrottleWait))}render(){const{ariaLabel:e,ariaLabelledBy:i,autoSelect:o,className:n,disabled:r,enforceSingleSelect:l,excludeTabStop:a,inputId:d,items:c,placeholder:p,renderExpandable:u,renderSelectedItems:m,showPrefix:b,required:x}=this.props,f={observableValue:this.parentSelection,filter:this.selectionChanged};return s.createElement(t.Observer.ItemsObserver,{getUnselectableRanges:this.props.getUnselectableRanges,items:c,selection:this.parentSelection},s.createElement(t.Observer.Observer,{selection:f},(()=>u({ariaLabel:e,ariaLabelledBy:i,autoSelect:o,className:(0,t.Util.css)(n,"bolt-dropdown-expandable"),containerRef:this.expandableContainer,disabled:r,enforceSingleSelect:l,excludeTabStop:a,inputId:d,placeholder:p,onCollapse:this.onCollapse,onExpand:this.onExpand,expandableRef:this.expandable,renderCallout:this.renderCallout,items:(0,h.getListBoxItemsValue)(this.state.wrappedItems||c),renderSelectedItems:m,selection:this.parentSelection,showPrefix:b,required:x}))))}focus(){this.expandable.current&&this.expandable.current.focus()}}function d(e,t){return!(!t.text||2===t.type||3===t.type||4===t.type)&&-1!==t.text.toLowerCase().indexOf(e.toLowerCase())}function p(e,t){const s=t[e.value[0].beginIndex];let i=s&&s.text||"";return e.selectedCount>1&&(i=`${i} (+${e.selectedCount-1})`),i}function x(e,s){const{filteredSelection:r,filterText:a}=s;let d=[];const c=(0,h.getListBoxItemsValue)(s.wrappedItems||e.items);let p=c;if(e.userFilteredItems){p=(0,t.UtilitiesProvider.getItemsValue)(e.userFilteredItems);const s=e.userFilteredItemsIndexMap&&e.userFilteredItemsIndexMap.value;if(s)d=s;else for(let t=0;t<e.userFilteredItems.length;t++){const e=c.findIndex((e=>e.id===p[t].id));0,d.push(e)}}if(e.filterByText&&a.value){const t=f(p,a.value,d,e.filterItem);p=t.filteredItems,d=t.filteredIndexMap}for(;p.length&&3===p[0].type;)p.shift(),d.shift();if(!i.ObservableLike.getValue(e.searching)&&!i.ObservableLike.getValue(e.loading)&&s.expanded.value)if(a.value){let t=l.NoFilterResults;e.filteredNoResultsText&&(t=i.ObservableLike.getValue(e.filteredNoResultsText)),o.announce(p.length>0?(0,n.format)(l.AnnounceFilterResultCount,p.length):t,!0)}else 0===p.length&&e.noItemsText?o.announce(e.noItemsText,!0):p.length>0&&o.announce((0,n.format)(l.AnnounceItemCount,p.length));return r.updateFilteredSelection(d,!e.enforceSingleSelect&&void 0),s.filteredItems.value=p,!0}function f(e,t,s=[],i=d){const o=[],n=[],r=[];if(t){let l,a,d=-1,c=-1;for(let p=0,h=e.length;p<h;p++){const h=e[p],u=s.length?s[p]:p;if(2===h.type)l=h,d=u;else if(3===h.type)a=h,c=u;else{const s=i(t,h,e);(s||4===h.type)&&(a&&a.groupId===h.groupId&&(o.push(a),n.push(c),a=void 0),l&&l.groupId===h.groupId&&(o.push(l),n.push(d),l=void 0),o.push(h),n.push(u),r.push(Array.isArray(s)?s:[]))}}}return{filteredItems:o,filteredIndexMap:n,filterMatches:r}}function g(e){return!e.type||1===e.type}function I(e,t,i){const o=[];let n=-1;for(let s=0;s<e.length;s++)-1!==t.indexOf(s)?o&&o[o.length-1]&&o[o.length-1].bold?o[n].text+=e.charAt(s):o[++n]={text:e.charAt(s),bold:!0}:o&&o[o.length-1]&&!o[o.length-1].bold?o[n].text+=e.charAt(s):o[++n]={text:e.charAt(s),bold:!1};const r=[];for(let t=0;t<o.length;t++){const i=o[t];i.bold?r.push(s.createElement("span",{className:"font-weight-heavy",key:`${e}-${t}`},i.text)):r.push(i.text)}return s.createElement("span",{className:i},r)}t[e].Dropdown=a,a.defaultProps={filterByText:!0,filterItem:d,getUnselectableRanges:h.getUnselectableRanges,renderCallout:u.DropdownCallout,renderExpandable:m.DropdownExpandableTextField,renderSelectedItems:p},t[e].filterItemByText=d,t[e].renderDropdownSelectedItemText=p,t[e].filterItems=f,t[e].filterTreeItems=function(e,t,s=[],i=d,o=g){const n=f(e,t,s,i),r=n.filteredIndexMap,l=n.filteredItems.find(o),a={};for(const t of r){const s=e[t];let i=s.parent;for(;i;){a[e.indexOf(i)]=i,i.expanded=!0,i=i.parent}a[t]=s}const c=[],p=[];for(const e of Object.keys(a)){const t=Number(e),s=a[t];c.push(t),p.push(s)}return[{filteredIndexMap:c,filteredItems:p,filterMatches:[]},l?e.indexOf(l):-1]},t[e].filterMatchedItemByListboxType=g,t[e].renderHighlightedText=function(e,i,o,r,a){let d=r;return a&&r.text&&(d=Object.assign(Object.assign({},r),{textNode:I(r.text,a)})),s.createElement(t.Table.SimpleTableCell,{className:(0,t.Util.css)(o.className,r.className,2===r.type&&"bolt-list-box-header"),columnIndex:i,key:i,tableColumn:o},s.createElement("div",{id:2===r.type?`header-${r.id}`:void 0,"aria-label":2===r.type?(0,n.format)(l.HeaderAriaLabel,r.text):void 0},(0,t.List.renderListCell)(d)))},t[e].getHighlightedText=I}("ComponentsDropdownDropdown"),function(e){function i(e){const t=e.querySelector(".bolt-dropdown-expandable-button-label");return!!t&&t.scrollWidth>Math.ceil(t.offsetWidth)}x=t[e]={},t[e].DropdownExpandableButton=function(e){const{expandableRef:o,items:n,placeholder:r,renderSelectedItems:l,selection:a,tooltipProps:d}=e,c=__rest(e,["expandableRef","items","placeholder","renderSelectedItems","selection","tooltipProps"]);let p=r;return a.selectedCount>0&&(p=l(a,n)),s.createElement(t.Button.ExpandableButton,Object.assign({ref:o},c,{tooltipProps:Object.assign({overflowOnly:!0,overflowDetected:i},e.tooltipProps)}),s.createElement("div",{className:"bolt-dropdown-expandable-button-label justify-start flex-grow text-ellipsis"},e.children,p))}}("ComponentsDropdownDropdownExpandableButton"),f=t[S="UtilitiesDropdownFilter"]={},t[S].updateFilterToSelection=function(e,s,i,o){const n=[];for(let t=0;t<e.length;t++)for(let i=e[t].beginIndex;i<=e[t].endIndex;i++)n.push(void 0!==s[i].data?s[i].data:s[i].id);const r=i.getFilterItemState(o);let l=!1;l=r?!(0,t.Util.arrayEquals)(r.value,n)&&(n.length||r.value):!!n.length,l&&("keyword"===o?i.setFilterItemState(o,{value:n[0]}):i.setFilterItemState(o,{value:n,operator:null==r?void 0:r.operator}))},function(e){g=t[e]={};class n extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.dropdown=s.createRef(),this.componentDidMount=()=>{var e;if(super.componentDidMount(),this.props.filter){const t=null===(e=this.props.filter)||void 0===e?void 0:e.getFilterItemState(this.props.filterItemKey);this.onFilterChanged(t)}},this.selectDefaultFilterItem=()=>{if(this.props.filter){const e=this.props.filter.getFilterItemState(this.props.filterItemKey);if(e&&e.value){const s=(0,h.getListBoxItemsValue)(this.wrappedItems||this.props.items),i=new t.List.ListSelection(this.selection.multiSelect);for(let t=0;t<e.value.length;t++){const o=s.findIndex((s=>s.id===e.value[t]||s.data===e.value[t]||JSON.stringify(s.data)===JSON.stringify(e.value[t])));o>-1&&i.select(o,1,!0)}this.selection.value=i.value}}},this.onFilterChanged=e=>{super.onFilterChanged(e);const s=(0,h.getListBoxItemsValue)(this.wrappedItems||this.props.items);if(e&&e.value){const i=new t.List.ListSelection(this.selection.multiSelect);for(let t=0;t<e.value.length;t++){const o=s.findIndex((s=>s.id===e.value[t]||s.data===e.value[t]||JSON.stringify(s.data)===JSON.stringify(e.value[t])));o>-1&&i.select(o,1,!0)}(0,t.UtilitiesSelection.compareSelectionRanges)(this.selection.value,i.value).length&&(this.selection.value=i.value)}else this.selection.clear()},this.onSelectionChanged=e=>{const t=(0,h.getListBoxItemsValue)(this.wrappedItems||this.props.items);return this.props.filter&&(0,f.updateFilterToSelection)(e,t,this.props.filter,this.props.filterItemKey),!0},this.renderExpandableButton=e=>{const{className:i,renderExpandable:o}=this.props,n=Object.assign(Object.assign({},e),{className:(0,t.Util.css)(i,"bolt-dropdown-filter-bar-item"),subtle:!0,renderSelectedItems:this.renderSelectedItems});return o?o(n):s.createElement(x.DropdownExpandableButton,Object.assign({},n))},this.onClearClick=()=>{this.selection.clear(),this.props.toggleFilterBar&&this.props.toggleFilterBar(),o.announce(l.AnnounceFilterCleared)},this.renderSelectedItems=(e,t)=>{let i=t[e.value[0].beginIndex].text||"";e.selectedCount>1&&(i=`${i} (+${e.selectedCount-1})`);const o=s.createElement("span",{className:"bolt-dropdown-filter-bar-item-selected-text"},i);return this.props.showPlaceholderAsLabel?s.createElement(s.Fragment,null,s.createElement("span",{className:"bolt-dropdown-filter-bar-item-placeholder"},`${this.props.placeholder}: `),o):o},this.wrappedItems=(0,h.wrapListBoxItems)(e.items),this.selection=e.selection||new c.DropdownSelection,this.selectDefaultFilterItem()}focus(){this.dropdown.current&&this.dropdown.current.focus()}render(){return s.createElement(t.Observer.SelectionObserver,{selection:this.selection,onSelectionChanged:this.onSelectionChanged},(()=>{const e=[...i.ObservableLike.getValue(this.props.actions||[])];return this.props.hideClearAction||e.push({className:"bolt-dropdown-action-right-button",disabled:0===this.selection.selectedCount,iconProps:{iconName:"Clear"},text:l.DropdownClearActionText,onClick:this.onClearClick}),s.createElement(t.Observer.Observer,{dropdownItems:{observableValue:this.props.items,filter:this.selectDefaultFilterItem}},(()=>s.createElement(t.UtilitiesScreenSize.ScreenSizeObserver,null,(t=>{const i=t.screenSize<=0;return s.createElement(b.Dropdown,Object.assign({width:i?void 0:256,renderExpandable:this.renderExpandableButton},this.props,{actions:e,selection:this.selection,ref:this.dropdown}))}))))}))}}t[e].DropdownFilterBarItem=n}("ComponentsDropdownDropdownFilterBarItem"),function(e){I=t[e]={},t[e].WithPivots=function(e){const o=o=>s.createElement(u.DropdownCallout,Object.assign({},o,e.calloutProps,{onFilterTextChanged:(t,s)=>{o.onFilterTextChanged&&o.onFilterTextChanged(t,s),e.calloutProps&&e.calloutProps.onFilterTextChanged&&e.calloutProps.onFilterTextChanged(t,s)},renderBeforeContent:()=>function(e){if(e.pivots.length<2)return null;return s.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(o=>s.createElement(t.FocusZone.FocusZone,{direction:1},s.createElement("div",{role:"tablist"},s.createElement(t.FocusWithin.FocusWithin,null,(n=>e.pivots.map(((r,l)=>{const a=void 0!==e.selectedPivot&&r.id===i.ObservableLike.getValue(e.selectedPivot);return s.createElement(t.Button.Button,{ariaSelected:a,ariaSetSize:e.pivots.length,ariaPosInSet:l+1,className:"bolt-dropdown-pivot",key:r.id,subtle:!0,onBlur:n.onBlur,onClick:()=>function(e,t){t.onPivotClicked&&t.onPivotClicked(e)}(r,e),onFocus:n.onFocus,role:"tab",focusZoneId:0!==l||n.hasFocus?void 0:o.focuszoneId},s.createElement("span",{className:(0,t.Util.css)(e.selectedPivot&&r.id===i.ObservableLike.getValue(e.selectedPivot)&&"bolt-dropdown-pivot-selected")},r.name||r.id))}))))))))}(e)}));return s.createElement(t.Observer.Observer,{selectedPivot:e.selectedPivot},(()=>{const n=function(e){let t;if(e.selectedPivot){const s=i.ObservableLike.getValue(e.selectedPivot);t=e.pivots.find((e=>e.id===s))}return t||e.pivots[0]}(e);return s.createElement(t.Observer.Observer,{userFilteredItems:n.userFilteredItems},(()=>{const t={actions:n.actions,filterByText:n.filterByText,userFilteredItems:n.userFilteredItems||n.items,filteredNoResultsText:n.filteredNoResultsText,filterPlaceholderText:n.filterPlaceholderText,noItemsText:n.noItemsText,renderCallout:o,showFilterBox:n.showFilterBox};return e.children(t)}))}))}}("ComponentsDropdownWithPivots"),v=t.Dropdown={},Object.defineProperty(t.Dropdown,"Dropdown",{enumerable:!0,get:function(){return b.Dropdown}}),Object.defineProperty(t.Dropdown,"filterItemByText",{enumerable:!0,get:function(){return b.filterItemByText}}),Object.defineProperty(t.Dropdown,"filterItems",{enumerable:!0,get:function(){return b.filterItems}}),Object.defineProperty(t.Dropdown,"filterTreeItems",{enumerable:!0,get:function(){return b.filterTreeItems}}),Object.defineProperty(t.Dropdown,"getHighlightedText",{enumerable:!0,get:function(){return b.getHighlightedText}}),Object.defineProperty(t.Dropdown,"renderDropdownSelectedItemText",{enumerable:!0,get:function(){return b.renderDropdownSelectedItemText}}),Object.defineProperty(t.Dropdown,"renderHighlightedText",{enumerable:!0,get:function(){return b.renderHighlightedText}}),Object.defineProperty(t.Dropdown,"DropdownCallout",{enumerable:!0,get:function(){return u.DropdownCallout}}),Object.defineProperty(t.Dropdown,"DropdownCalloutComponent",{enumerable:!0,get:function(){return u.DropdownCalloutComponent}}),Object.defineProperty(t.Dropdown,"DropdownExpandableButton",{enumerable:!0,get:function(){return x.DropdownExpandableButton}}),Object.defineProperty(t.Dropdown,"DropdownExpandableTextField",{enumerable:!0,get:function(){return m.DropdownExpandableTextField}}),Object.defineProperty(t.Dropdown,"DropdownFilterBarItem",{enumerable:!0,get:function(){return g.DropdownFilterBarItem}}),Object.defineProperty(t.Dropdown,"WithPivots",{enumerable:!0,get:function(){return I.WithPivots}}),function(e){w=t[e]={};t[e].EditableDropdownItemProvider=class{constructor(e,t){this.itemCollection=new i.ObservableCollection,i.ObservableLike.isObservable(e)?this.listItems=e:this.listItems=new i.ObservableArray((0,h.wrapListBoxItems)(e)||e),this.itemCollection.push(this.listItems),this.extraItem=new i.ObservableArray,this.itemCollection.push(this.extraItem),this.selection=t}get length(){return this.itemCollection.length}get value(){return this.itemCollection.value}get hasExtraItem(){return this.extraItem.length>0}subscribe(e,t){return this.itemCollection.subscribe(e,t)}unsubscribe(e,t){return this.itemCollection.unsubscribe(e,t)}setTextValue(s){if(this.hasExtraItem&&this.extraItem.splice(0,1),s){const i=this.listItems.value.findIndex((e=>e.text===s));-1!==i&&this.selection.selectable(i)||this.extraItem.push({id:s,text:(0,n.format)(l.UseItem,s),className:t[e].editableDropdownExtraItemClassName})}}},t[e].editableDropdownExtraItemClassName="editable-dropdown-extra-item"}("UtilitiesEditableDropdownItemProvider"),function(e){C=t[e]={};class o extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.listBox=s.createRef(),this.filteredIndexMap=new i.ObservableValue([]),this.filterMatches=[],this.collapse=()=>{this.dropdown.current&&this.dropdown.current.collapse()},this.expand=()=>{this.dropdown.current&&this.dropdown.current.expand()},this.renderItem=(e,t,s,i)=>this.wrapWithFocusedIndexObserver(e,t,s,i,((e,t,s,i)=>{const o=i,n=s,r=this.filterMatches[e];return!o.render&&r&&r.length&&(o.render=(e,t,s,i)=>(0,b.renderHighlightedText)(e,t,s,i,r)),this.props.renderItem(e,t,n,o)})),this.wrapWithFocusedIndexObserver=(e,i,o,n,r)=>s.createElement(t.Observer.Observer,{focusedIndex:{observableValue:this.focusedIndex,filter:()=>{const t=this.filteredIndexMap.value[e];return t===this.focusedIndex.value||t===this.previousFocusedIndex}},key:`focused-observer-${e}-${i}`},(()=>{var s;const l=this.filteredIndexMap.value[e]===this.focusedIndex.value&&4!==(null===(s=n)||void 0===s?void 0:s.type)?Object.assign(Object.assign({},n),{className:(0,t.Util.css)(n.className,"bolt-editable-dropdown-focused-item")}):Object.assign({},n);return r(e,i,o,l)})),this.onCollapse=()=>{var e,t;const{allowFreeform:s,autoAccept:o,onCollapse:n,onValueChange:r,showTree:l,text:a}=this.props;if(n&&n(),!this.selectedItemInList){const e=this.itemProvider.value.findIndex(((e,t)=>this.selection.selectable(t)&&e.text===i.ObservableLike.getValue(a||"")));e>-1&&this.selectIndex(e)}const d=this.itemProvider.length-1;if(!s||this.selection.value.length&&this.selection.value[0].beginIndex!==d&&this.selectedItemInList||!this.itemProvider.hasExtraItem){if(l&&this.lastSelectedItem)r&&r(this.lastSelectedItem);else if(this.selection.value.length){const e=this.itemProvider.value[this.selection.value[0].beginIndex];r&&r(e)}}else{if(o||this.selectedItemInList||this.selectedFreeform){const e=this.itemProvider.value[d].id;r&&r({id:e,text:e})}this.selectedFreeform=!1,this.selection.clear()}null===(t=(e=this.props).onTextChange)||void 0===t||t.call(e,null,""),this.isExpanded=!1,this.selectedItemInList=!1,this.lastSelectedItem=void 0,l&&(this.focusedIndex.value=-1)},this.onItemsChange=(e,t)=>{this.isExpanded&&("change"!==t&&this.filterItems(),this.selectSelectedTextItem())},this.selectSelectedTextItem=()=>{if(this.props.selectedText){const e=i.ObservableLike.getValue(this.props.selectedText);if(e){const t=this.itemProvider.value.findIndex((t=>t.text===e));t>-1&&this.selection.select(t)}}},this.onSelect=(e,t)=>{this.selectedItemInList=!0,this.lastSelectedItem=t},this.renderExpandable=e=>s.createElement(t.Observer.Observer,{focusedIndex:this.focusedIndex,selectedText:this.props.selectedText,text:this.props.text},(t=>{var s,i;const{allowTextSelection:o,inputId:n}=this.props,{selectedText:r,text:l}=t,a=this.getFocusedIndex();let d;a>-1&&this.itemProvider.value[a]&&(d=this.itemProvider.value[a].id);const c=o&&r&&!this.isExpanded?r:l,p=Object.assign(Object.assign({},e),{ariaActiveDescendant:d,editable:!0,showPrefix:!l,blurDismiss:!0,inputId:n,onChange:this.onTextChange,onKeyDown:this.onKeyDown,value:c});return null===(i=(s=this.props).renderExpandable)||void 0===i?void 0:i.call(s,p)})),this.renderCallout=e=>{const t=Object.assign(Object.assign({},e),{focusOnMount:!1,excludeTabStop:!0,excludeFocusZone:!0,ignoreMouseDown:!0,listBoxRef:this.listBox});return this.props.renderCallout(t)},this.onExpand=()=>{if(this.props.onExpand&&this.props.onExpand(),this.props.filterItems){const e=this.props.filterItems("",this.itemProvider.value),t=this.updateFilteredIndexMap(e.filteredIndexMap);this.filteredItems.value=e.filteredItems,this.focusItem(t)}else{this.filteredItems.value=this.itemProvider.value;const e=this.updateFilteredIndexMap(this.filteredItems.value.map(((e,t)=>t)));this.focusItem(e)}this.isExpanded=!0},this.onTextChange=(e,t)=>{var s,i,o,n,r,l,a,d;if(null===(i=(s=this.props).onTextChange)||void 0===i||i.call(s,e,t),this.props.allowFreeform)this.itemProvider.hasExtraItem&&this.filteredItems.pop(),this.itemProvider.setTextValue(t),this.props.allowClear&&""===t&&(this.selection.clear(),null===(n=(o=this.props).onValueChange)||void 0===n||n.call(o));else if(""===t&&this.props.allowClear)this.selection.clear(),null===(l=(r=this.props).onValueChange)||void 0===l||l.call(r);else{const e=this.itemProvider.value.findIndex((e=>e.text===t));e>-1&&this.selection.selectable(e)&&(this.selection.select(e),null===(d=(a=this.props).onValueChange)||void 0===d||d.call(a,this.itemProvider.value[e]))}return this.isExpanded&&this.filterItems(),!1},this.filterItems=()=>{const e=this.itemProvider.value,t=i.ObservableLike.getValue(this.props.text||"");let s,o;if(this.props.filterItems)s=this.props.filterItems(t,e);else if(t)if(this.props.showTree){const[i,n]=(0,b.filterTreeItems)(e,t,[],this.props.filterItem,this.props.filterMatchedItem);s=i,o=n}else s=(0,v.filterItems)(e,t,[],this.props.filterItem),o=e.findIndex((e=>{var s;return(0,n.equals)(null!==(s=e.text)&&void 0!==s?s:"",t,!0)})),o<0&&(o=e.findIndex((e=>{var s;return(0,n.startsWith)(null!==(s=e.text)&&void 0!==s?s:"",t,!0)})));else s={filteredItems:e,filteredIndexMap:e.map(((e,t)=>t)),filterMatches:[]};this.filterMatches=s.filterMatches;const r=this.updateFilteredIndexMap(s.filteredIndexMap);this.filteredItems.value=s.filteredItems;const l=o&&o>-1?o:r;this.focusItem(l)},this.onKeyDown=e=>{const t=e.which,s=this.isExpanded;switch(t){case 27:this.isExpanded&&(this.collapse(),e.preventDefault());break;case 13:this.isExpanded||(this.expand(),e.preventDefault());case 9:if(s&&!e.shiftKey&&(this.filteredItems.length||this.props.allowFreeform)){const t=this.getFocusedIndex();t>=0?this.selectIndex(t):this.selectedFreeform=!0,this.collapse(),e.preventDefault()}break;case 38:this.isExpanded&&(this.focusPreviousItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.value.indexOf(this.focusedIndex.value),{block:"nearest"})),e.preventDefault();break;case 39:if(this.isExpanded&&this.props.showTree){const t=this.getFocusedIndex(),s=this.itemProvider.value[t];s.expanded||(this.props.onToggle&&this.props.onToggle(e,s),this.focusNextItem(),this.focusPreviousItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.value.indexOf(t),{block:"nearest"}))}break;case 40:this.isExpanded?(this.focusNextItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.value.indexOf(this.focusedIndex.value),{block:"nearest"})):this.isExpanded||this.expand(),e.preventDefault();break;case 37:if(this.isExpanded&&this.props.showTree){const t=this.getFocusedIndex(),s=this.itemProvider.value[t];s.expanded&&(this.props.onToggle&&this.props.onToggle(e,s),this.focusPreviousItem(),this.focusNextItem(),this.listBox.current&&this.listBox.current.scrollIntoView(this.filteredIndexMap.value.indexOf(t),{block:"nearest"}))}break;case 46:case 8:this.props.allowClear&&!i.ObservableLike.getValue(this.props.text||"")?(this.selection.clear(),this.props.onValueChange&&this.props.onValueChange()):this.expand();break;case 17:break;default:this.expand()}},this.selection=e.selection||new c.DropdownSelection,this.itemProvider=new w.EditableDropdownItemProvider(e.items,this.selection),this.filteredItems=new i.ObservableArray([...this.itemProvider.value]),this.focusedIndex=new i.ObservableValue(-1),this.previousFocusedIndex=-1,this.timerManagement=new r.TimerManagement,this.filteredIndexMap.value=this.itemProvider.value.map(((e,t)=>t)),this.selectSelectedTextItem(),this.props.columns&&(this.columns=this.props.columns.map((e=>Object.assign(Object.assign({},e),{renderCell:(t,s,i,o)=>this.wrapWithFocusedIndexObserver(t,s,i,o,e.renderCell)}))))}render(){const{actions:e,allowTextSelection:i,ariaLabel:o,ariaLabelledBy:n,autoSelect:r,calloutContentClassName:a,className:d,disabled:c,filterByText:p,getUnselectableRanges:h,inputId:u,noItemsText:m,onToggle:b,selectedText:x,showTree:f,text:g,minCalloutWidth:I,required:w}=this.props;return s.createElement(t.Observer.Observer,{text:g,items:{observableValue:this.itemProvider,filter:this.onItemsChange},selection:this.selection,selectedText:x},(x=>{let g=this.props.placeholder;if(!i)if(x.selectedText)g=x.selectedText;else if(x.selection.length){const e=x.selection[0].beginIndex;e>-1&&(g=this.itemProvider.value[e].text)}return s.createElement(v.Dropdown,{ariaLabelledBy:n,actions:e,ariaLabel:o,autoSelect:null!=r&&r,calloutContentClassName:a,className:(0,t.Util.css)("bolt-editable-dropdown",(x.selection.length>0||!!x.selectedText)&&"bolt-editable-dropdown-with-selection",d),columns:this.columns,disabled:c,getUnselectableRanges:h,filterByText:p,inputId:u,items:this.itemProvider,noItemsText:m||l.NoItemsFound,onCollapse:this.onCollapse,onExpand:this.onExpand,onSelect:this.onSelect,onToggle:b,placeholder:g,ref:this.dropdown,renderCallout:this.renderCallout,renderExpandable:this.renderExpandable,renderItem:this.renderItem,selection:this.selection,showFilterBox:!1,showTree:f,userFilteredItems:this.filteredItems,userFilteredItemsIndexMap:this.filteredIndexMap,minCalloutWidth:I,required:w})}))}componentDidMount(){this.props.filterThrottleWait&&(this.filterItems=this.timerManagement.debounce(this.filterItems,this.props.filterThrottleWait))}focus(){this.dropdown.current&&this.dropdown.current.focus()}selectIndex(e){e>-1&&(this.selection.select(e),this.selectedItemInList=!0)}focusItem(e){void 0!==e&&e>-1&&this.isFocusable(e)&&(this.previousFocusedIndex=this.focusedIndex.value,this.focusedIndex.value=e)}updateFilteredIndexMap(e){const t=this.filteredIndexMap.value.indexOf(this.focusedIndex.value);this.filteredIndexMap.value=e;let s=e[t];return(!s||s<0||!this.selection.selectable(s)||-1===this.filteredIndexMap.value.indexOf(s))&&(s=this.props.showTree?-1:this.filteredIndexMap.value.find((e=>this.selection.selectable(e)))),s}focusNextItem(){let e;for(let t=this.filteredIndexMap.value.indexOf(this.focusedIndex.value)+1;t<this.filteredIndexMap.value.length;t++)if(this.selection.selectable(this.filteredIndexMap.value[t])){e=this.filteredIndexMap.value[t];break}this.focusItem(e)}focusPreviousItem(){let e;for(let t=this.filteredIndexMap.value.indexOf(this.focusedIndex.value)-1;t>=0;t--)if(this.selection.selectable(this.filteredIndexMap.value[t])){e=this.filteredIndexMap.value[t];break}this.focusItem(e)}getFocusedIndex(){if(!this.props.showTree)return this.focusedIndex.value;let e=this.focusedIndex.value;for(let t=0;t<=Math.min(e,this.itemProvider.value.length-1);t++)(0,h.isListBoxItemVisible)(this.itemProvider.value[t])||e++;return e}isFocusable(e){if(!this.props.showTree)return!0;return e<this.itemProvider.value.filter((e=>(0,h.isListBoxItemVisible)(e))).length}}t[e].CustomEditableDropdown=o,o.defaultProps={allowClear:!0,autoAccept:!0,renderExpandable:v.DropdownExpandableTextField,renderCallout:v.DropdownCallout,renderItem:h.renderListBoxCell}}("ComponentsEditableDropdownCustomEditableDropdown"),function(e){T=t[e]={};class o extends s.Component{constructor(e){super(e),this.dropdown=s.createRef(),this.collapse=()=>{this.dropdown.current&&this.dropdown.current.collapse()},this.expand=()=>{this.dropdown.current&&this.dropdown.current.expand()},this.onExpand=()=>{const{allowTextSelection:e,onExpand:t}=this.props;t&&t(),e&&(this.text.value=this.selectedText.value)},this.onTextChange=(e,t)=>{this.props.onTextChange&&this.props.onTextChange(e,t),this.text.value=t},this.onValueChange=e=>{this.props.onValueChange&&this.props.onValueChange(e),this.selectedText.value=e&&e.text||""},this.text=i.ObservableLike.isObservable(e.text)?e.text:new i.ObservableValue(e.text||""),this.selectedText=i.ObservableLike.isObservable(e.selectedText)?e.selectedText:new i.ObservableValue(e.selectedText)}focus(){this.dropdown.current&&this.dropdown.current.focus()}render(){return s.createElement(C.CustomEditableDropdown,Object.assign({},this.props,{onExpand:this.onExpand,onTextChange:this.onTextChange,onValueChange:this.onValueChange,ref:this.dropdown,selectedText:this.selectedText,text:this.text}))}}t[e].EditableDropdown=o}("ComponentsEditableDropdownEditableDropdown"),t.EditableDropdown={},Object.defineProperty(t.EditableDropdown,"CustomEditableDropdown",{enumerable:!0,get:function(){return C.CustomEditableDropdown}}),Object.defineProperty(t.EditableDropdown,"EditableDropdown",{enumerable:!0,get:function(){return T.EditableDropdown}}),function(e){t[e]={};class s extends i.Observable{constructor(){super(...arguments),this.internalCollections=[],this.items=[]}get length(){return this.items.length}get value(){return this.items}get collections(){return this.internalCollections}push(e){let t;if(i.ObservableLike.isObservable(e)){const s=e,o=this.getSubscriber(this.internalCollections.length);t={items:s.value,provider:s,subscriber:o},this.subscriberCount&&i.ObservableLike.subscribe(t.provider,o)}else e.value?t={items:e.value,provider:e}:e.length&&(t={items:e});t&&(this.internalCollections.push(t),t.items.length&&(this.items.push(...t.items),this.subscriberCount&&this.notify({addedItems:t.items,index:this.items.length-t.items.length},"push")))}getItem(e){let t=0;for(;t<this.internalCollections.length&&0+(this.internalCollections[t].provider?this.internalCollections[t].provider.length:this.internalCollections[t].items.length)<e;)t++;if(t<this.internalCollections.length)return this.internalCollections[t].provider&&this.internalCollections[t].provider.getItem?this.internalCollections[t].provider.getItem(e):this.internalCollections[t].items[e]}subscribe(e,t){const s=super.subscribe(e,t);if(1===this.subscriberCount){for(const e of this.internalCollections)e.subscriber&&e.provider&&e.provider.subscribe&&e.provider.subscribe(e.subscriber);const e=[];for(const t of this.internalCollections)e.push(...t.items);this.items.splice(0,this.items.length,...e)}return s}unsubscribe(e,t){if(super.unsubscribe(e,t),0===this.subscriberCount)for(const e of this.internalCollections)e.subscriber&&e.provider&&e.provider.unsubscribe&&e.provider.unsubscribe(e.subscriber)}getSubscriber(e){return t=>{let s=t.index;for(let t=0;t<e;t++)s+=this.internalCollections[t].items.length;if(t.changedItems)this.items.splice(s,t.changedItems.length,...t.changedItems),this.notify({changedItems:t.changedItems,index:s},"change");else{const e=t.removedItems||[],i=t.addedItems||[];this.items.splice(s,e.length,...i),this.notify({removedItems:e,addedItems:i,index:s},"splice")}}}}t[e].AggregateItemProvider=s}("UtilitiesAggregateItemProvider"),function(e){t[e]={};t[e].GroupedItemProvider=class{constructor(e,t,s){this.listItems=new i.ObservableArray,this.internalGroups=[...t],this.groupedItems=[[]];for(let e=0;e<this.internalGroups.length;e++)this.groupedItems.push([]);this.addItems(e);for(let e=0;e<this.internalGroups.length;e++)this.internalGroups[e].loading&&this.setGroupLoading(this.internalGroups[e].id,!0,this.internalGroups[e].loadingItem);s&&this.addHeaders(1,this.groups.length),this.manageHeaders=!!s}get groups(){return this.internalGroups}get length(){return this.listItems.length}get value(){return this.listItems.value}subscribe(e,t){return this.listItems.subscribe(e,t)}unsubscribe(e,t){return this.listItems.unsubscribe(e,t)}push(...e){return this.addItems(e),e.length}pushGroups(...e){return this.addGroups(this.internalGroups.length,...e),this.internalGroups.length}pop(){const e=this.listItems.pop();return e&&this.removeItems([e]),e}removeAll(e){const t=this.listItems.removeAll(e);return this.removeItems(t,!1),t}splice(e,t,...s){const i=this.listItems.splice(e,t);return this.removeItems(i,!1),this.addItems(s,!0,e),i}change(e,...t){const s=this.listItems.value.slice(e,t.length);return this.removeItems(s,!1),this.addItems(t,!1),this.listItems.change(e,...t),t.length}spliceGroups(e,t,...s){for(let s=0;s<t;s++){const t=e+s+1;if(this.groupedItems.length>t){if(this.removeItems([...this.groupedItems[t]]),this.manageHeaders){const e=this.groupedItems.findIndex((e=>e.length>0));e>0&&3===this.groupedItems[e][0].type&&this.removeItems([this.groupedItems[e][0]])}this.groupedItems.splice(t,1)}}const i=this.internalGroups.splice(e,t);return this.addGroups(e,...s),i}setGroupLoading(e,t,s){let i=this.groups.findIndex((t=>t.id===e));if(i<0)return void 0;i++;const o=this.groupedItems[i],n=o.findIndex((e=>4===e.type));if(!t&&o.length&&n>-1)this.removeItems([o[n]]);else if(t&&-1===n){const t=s||{id:e+"-loading",type:4,groupId:e};this.addItems([t])}this.groups[i-1].loading=t}addHeaders(e,t=1){for(let s=e;s<e+t;s++){let e=this.groups[s-1];if(this.groupedItems[s].length>0){this.groupedItems[s].find((e=>2===e.type))||this.addItems([{id:e.id+"-header",text:e.name||e.id,type:2,groupId:e.id}]),this.groupedItems.some(((e,t)=>t<s&&e.length>0))&&!this.groupedItems[s].find((e=>3===e.type))&&this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]);const t=this.groupedItems.findIndex(((e,t)=>t>s&&e.length>0));t>0&&!this.groupedItems[t].find((e=>3===e.type))&&(e=this.groups[t-1],this.addItems([{id:e.id+"-divider",type:3,groupId:e.id}]))}}}addGroups(e,...t){this.internalGroups.splice(e,0,...t);const s=[];for(let i=0;i<t.length;i++){this.groupedItems.splice(e+i+1,0,[]);for(let e=this.groupedItems[0].length-1;e>=0;e--)if(this.groupedItems[0][e].groupId===t[i].id){const t=this.groupedItems[0].splice(e,1)[0];this.listItems.splice(e,1),s.unshift(t)}}this.addItems(s),this.manageHeaders&&this.addHeaders(e+1,t.length);for(let e=0;e<t.length;e++)t[e].loading&&this.setGroupLoading(t[e].id,!0,t[e].loadingItem)}addItems(e,t=!0,s){if(void 0!==s)for(let t=e.length-1;t>=0;t--)this.addItem(e[t],s);else for(let t=0;t<e.length;t++)this.addItem(e[t],s);t&&this.addToListItems()}addToListItems(){const e=[];for(let t=0;t<this.groupedItems.length;t++)e.push(...this.groupedItems[t]);let t,s=0;const i={};for(let o=0;o<e.length;o++)this.listItems.value[s]===e[o]?(s++,t=void 0):void 0!==t?i[t].push(e[o]):(t=s,i[s]=[e[o]]);const o=Object.keys(i);for(let e=o.length-1;e>=0;e--)this.listItems.splice(parseInt(o[e]),0,...i[parseInt(o[e])])}addItem(e,t){let s=0,i=0;const o=e.groupId;void 0!==o&&(s=this.internalGroups.findIndex((e=>e.id===o))+1);for(let e=0;e<s;e++)i+=this.groupedItems[e].length;if(3===e.type)this.groupedItems[s].unshift(e);else if(2===e.type)this.groupedItems[s].length&&3===this.groupedItems[s][0].type?(this.groupedItems[s].splice(1,0,e),i++):this.groupedItems[s].unshift(e);else{let o=this.groupedItems[s].length;void 0!==t&&t>=i&&t<=i+this.groupedItems[s].length?(o=t-i,i=t):void 0!==t&&t<i?o=0:i+=this.groupedItems[s].length,this.groupedItems[s].splice(o,0,e),s>0&&1===this.groupedItems[s].length&&this.manageHeaders&&this.addHeaders(s)}}removeItems(e,t=!0){for(let s=0;s<e.length;s++){let i=0,o=0;const n=e[s].groupId;void 0!==n&&(i=this.internalGroups.findIndex((e=>e.id===n))+1);for(let e=0;e<i;e++)o+=this.groupedItems[e].length;const r=this.groupedItems[i],l=r.indexOf(e[s]);r.splice(l,1),t&&this.listItems.splice(o+l,1)}}}}("UtilitiesGroupedItemProvider")}),["Resources.Dropdown","Components/ExpandableTextField/ExpandableTextField","ExpandableTextField","Utilities/DropdownSelection","Components/ListBox/ListBox","ListBox","Components/Dropdown/DropdownCallout","Components/Dropdown/DropdownExpandableTextField","Components/Dropdown/Dropdown","Components/Dropdown/DropdownExpandableButton","Utilities/DropdownFilter","Components/Dropdown/DropdownFilterBarItem","Components/Dropdown/WithPivots","Dropdown","Utilities/EditableDropdownItemProvider","Components/EditableDropdown/CustomEditableDropdown","Components/EditableDropdown/EditableDropdown","EditableDropdown","Utilities/AggregateItemProvider","Utilities/GroupedItemProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-dropdown-content"}}));