"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("Mention/Autocomplete",["require","exports","react","VSS/Core/Util/Accessibility","Mention/AutocompleteResolver/AutocompleteContributionResolverService","VSS/Core/Observable","VSS/Core/Util/String","VSS/Platform/Layout","VSSUI/Callout","VSSUI/SuggestionsList","VSSUI/Util"],(function(t,e,s,i,n,o,r,u,l,a,h){var c,d,p;c=e.Resources={},e.Resources.AutocompleteAriaLabel="Autocomplete text area",e.Resources.StatusTextTemplate="Showing {0} suggestions",e.Resources.SearchButtonText="Search",e.Resources.NoResultFound="No results found",e.Resources.Loading="Loading...",function(t){d=e[t]={},e[t].isAutoCompleteInputProxy=function(t){return!!t&&"object"==typeof t&&["getSelection","insertCalloutAnchor","insertText","addKeyDownListener","addKeyUpListener","addInputListener","addBlurListener","addPasteListener","isTargetedByEvent","setInputAttribute","removeInputAttribute","focus"].reduce(((e,s)=>e&&"function"==typeof t[s]),!0)},e[t].createAutocompleteInputProxy=function(t,e){if(t instanceof HTMLTextAreaElement)return new i(t,e);if(t instanceof HTMLDivElement)return new n(t);throw new Error("Unsupported input element")};class s{constructor(t){this._listeners=[],this.getElementForAnchor=()=>this._inputElement,this.getClientWidth=()=>this._inputElement.clientWidth,this.setInputAttribute=(t,e)=>this._inputElement.setAttribute(t,e),this.getInputAttribute=t=>this._inputElement.getAttribute(t),this.removeInputAttribute=t=>this._inputElement.removeAttribute(t),this.focus=()=>this._inputElement.focus(),this._inputElement=t}addKeyDownListener(t){this._listeners.push({eventName:"keydown",listener:t}),this._inputElement.addEventListener("keydown",t)}addKeyUpListener(t){this._listeners.push({eventName:"keyup",listener:t}),this._inputElement.addEventListener("keyup",t)}addInputListener(t){this._listeners.push({eventName:"input",listener:t}),this._inputElement.addEventListener("input",t)}addBlurListener(t){this._listeners.push({eventName:"blur",listener:t}),this._inputElement.addEventListener("blur",t)}addPasteListener(t){this._listeners.push({eventName:"paste",listener:t}),this._inputElement.addEventListener("paste",t)}removeListeners(){for(const{eventName:t,listener:e}of this._listeners)this._inputElement.removeEventListener(t,e)}isTargetedByEvent(t){return!!t&&t.target===this._inputElement}}class i extends s{constructor(t,e){super(t),this._shadowInput=document.createElement("div"),this._onInputChange=e,this._setShadowStyle(),this._inputElement.insertAdjacentElement("beforebegin",this._shadowInput)}getSelection(){const{selectionStart:t,selectionEnd:e,value:s}=this._inputElement;return{selectionStart:t,selectionEnd:e,value:s}}insertCalloutAnchor(t){this._shadowInput.innerHTML=this._inputElement.innerHTML,this._setShadowStyle();const{selectionStart:e,selectionEnd:s}=this.getSelection(),i=document.createRange();i.setStart(this._shadowInput.childNodes[0],e),i.setEnd(this._shadowInput.childNodes[0],s);const n=i.getBoundingClientRect();t.style.top=n.top+"px",t.style.left=n.left+"px",t.style.height=n.height+"px",t.style.position="absolute",document.body.insertAdjacentElement("afterbegin",t),this._inputElement.selectionStart=e,this._inputElement.selectionEnd=s,this._inputElement.focus()}insertText(t,e){const{value:s,selectionStart:i}=this.getSelection();if(this._browserSupportsInsertText())this._inputElement.selectionEnd=this._inputElement.selectionStart,this._inputElement.selectionStart=e,document.execCommand("insertText",!1,t);else{const n=`${s.substr(0,e)}${t}${s.substr(i)}`;this._onInputChange?this._onInputChange(n):this._inputElement.value=n,this._inputElement.selectionEnd=this._inputElement.selectionStart=e+t.length}}_browserSupportsInsertText(){return!(this._isFirefox()||!document.queryCommandSupported("insertText"))}_isFirefox(){const t=window.navigator.userAgent.toLowerCase();return!!/mozilla.*rv:([\d+.]+)/i.exec(navigator.userAgent)&&-1===t.indexOf("trident")}_setShadowStyle(){const t=getComputedStyle(this._inputElement);this._shadowInput.style.cssText=t.cssText,this._shadowInput.scrollLeft=this._inputElement.scrollLeft,this._shadowInput.scrollTop=this._inputElement.scrollTop,this._shadowInput.style.position="absolute",this._shadowInput.style.visibility="hidden"}}class n extends s{constructor(t){super(t)}getSelection(){const t=window.document.getSelection();if(t){const e=t.focusNode?t.focusNode.textContent:"";return{selectionStart:t.anchorOffset,selectionEnd:t.anchorOffset,value:e||""}}return{selectionStart:0,selectionEnd:0,value:this._inputElement.innerText}}insertCalloutAnchor(t){const e=window.getSelection();if(e){this._mentionRow=e.focusNode||void 0;e.getRangeAt(0).insertNode(t)}}insertText(t,e){const{selectionStart:s}=this.getSelection();let i=this._mentionRow||this._inputElement.childNodes[0];const n=i.textContent||"";i.textContent=`${n.substr(0,e)}${t}${n.substr(s)}`;const o=window.document.getSelection();if(o){const s=document.createRange();s.setStart(i,e+t.length-1),s.collapse(!0),o.removeAllRanges(),o.addRange(s)}}}}("AutocompleteInputProxy"),function(t){e.AutocompleteUtility={};var s;function i(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function n(t){const e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}e.AutocompleteUtility.getMultiTerms=function(t,e){return t.split(/\s+/).filter((t=>!!t)).map((t=>e?n(t):t))},function(t){t[t.Contains=0]="Contains",t[t.Prefix=1]="Prefix"}(s=e.AutocompleteUtility.SearchBehavior||(e.AutocompleteUtility.SearchBehavior={})),e.AutocompleteUtility.searchString=function(t,e,n,o){if(null==t||null===e||!e.length)return{found:{},highlightedSource:t};e=e.slice(0,10);const r=t.toUpperCase(),u=e.map((t=>i(t)));let l=null;const a={};let h=!1;n===s.Prefix?(e.forEach((t=>{a[t]=0===r.indexOf(t.toUpperCase()),h=h||a[t]})),l=new RegExp("^("+u.join("|")+")","ig")):n===s.Contains&&(e.forEach((t=>{a[t]=r.indexOf(t.toUpperCase())>=0,h=h||a[t]})),l=new RegExp(u.join("|"),"ig"));let c="";return c=h&&o&&l?t.replace(l,o):t,{found:a,highlightedSource:c}},e.AutocompleteUtility.escapeRegExp=i,e.AutocompleteUtility.htmlEncode=n}(),e.Constants={},e.Constants.MentionCssClasses||(e.Constants.MentionCssClasses={}),function(t){p=e[t]={};e[t].AutocompleteFooter=t=>{const{statusText:e}=t;return(0,s.useEffect)((()=>{(0,i.announce)(e,!0,200)}),[e]),s.createElement("div",{className:"autocomplete-footer-footer"},s.createElement("div",{className:"autocomplete-footer-status"},s.createElement("span",{className:"autocomplete-footer-status-text"},e)))}}("ComponentsAutocompleteFooter"),function(t){e[t]={};const i="aria-activedescendant",_="aria-autocomplete",g="aria-label",m="aria-controls",v="autocomplete-callout",x=/\s/;class S extends u.VssComponent{constructor(t,e){super(t,e),this._pasting=!0,this._suggestions=new o.ObservableArray,this._currentIndex=new o.ObservableValue(0),this._anchorOrigin={horizontal:"start",vertical:"end"},this._calloutOrigin={horizontal:"start",vertical:"start"},this._onClick=t=>{this._selectedItem=t.item;const{onSuggestionClick:e}=this.state;e&&e()},this._onBlur=()=>{this._setIsSuggesting(!1)},this._onPaste=t=>{if(this._isSuggesting.value&&t.clipboardData&&this._inputProxy){t.preventDefault();let e=t.clipboardData.getData("text/plain").trim();const{value:s,selectionEnd:i}=this._inputProxy.getSelection(),{startIndex:n,startCharacter:o}=this._suggestionInfo;let r=i<=n?"":s.substring(n,i);r+=e,document.execCommand("insertText",!1,e),this._updateSuggestions(r,o)}this._pasting=!0},this._onCalloutDismiss=t=>{this.state.onDismiss&&this.state.onDismiss(t)||this.closeCallout()},this._onInput=()=>{var t;const{value:e,startIndex:s}=this._getWordAtCursor();if(!this._isSuggesting.value&&e)return void this._onValueChange(e.substr(0,1));const i=!e&&s===(null===(t=this._suggestionInfo)||void 0===t?void 0:t.startIndex);this._isSuggesting.value&&i&&this._setIsSuggesting(!1)},this._onKeyDown=t=>{var e;this._eventHandledOnKeyDown=!1,this._isSuggesting.value&&this._onKeyDownForSuggestions(t),(null===(e=this._currentProvider)||void 0===e?void 0:e.onKeyDown)&&this._currentProvider.onKeyDown(t,this._inputProxy.getElementForAnchor(),this._selectedItem)},this._onKeyUp=t=>{if(this._isModifierKey(t.key))this._lastKeyWasModifier=!0;else if(this._eventHandledOnKeyDown)this._lastKeyWasModifier=!1;else{if(this._isSuggesting.value)return this._onKeyUpForSuggestions(t),void(this._lastKeyWasModifier=!1);this._onValueChange(t.key),this._lastKeyWasModifier=!1}},this._onValueChange=t=>{const{value:e,startIndex:s}=this._getWordAtCursor();this._currentProvider=(0,n.getProviderForShortcutCharacter)(this.context.pageContext,t),!this._currentProvider&&this._lastKeyWasModifier&&(t=e.substr(0,1),this._currentProvider=(0,n.getProviderForShortcutCharacter)(this.context.pageContext,t)),this._currentProvider&&e.substr(0,1)===t&&(this._suggestionInfo={startIndex:s,startCharacter:t},this._setIsSuggesting(!0))},this._updateSuggestions=(t,e)=>{t.substr(0,1)===e?this._timer=window.setTimeout((()=>{if(this._currentProvider){const e=t.substr(1);this._currentProvider.search(e,!1).then((t=>{const s=this._getStatusText(t.length);this._suggestions.value=t,this._updateIndexTimer&&window.cancelAnimationFrame(this._updateIndexTimer),this._updateIndexTimer=window.requestAnimationFrame((()=>{this._currentIndex.value=0,this._suggestions.length?this._selectedItem=this._suggestions.value[this._currentIndex.value]:this._selectedItem=void 0,this.setState({searchTerm:e,statusText:s})}))})),this._timer=void 0}}),200):this._setIsSuggesting(!1)},this._onRenderSuggestion=t=>{var e;let i=null;return this._currentProvider&&(i=this._currentProvider.renderSuggestion(t.item,null===(e=this._inputProxy)||void 0===e?void 0:e.getElementForAnchor())),s.createElement("div",{className:"mention-suggestions-row flex-grow"},i)},this._onDismiss=t=>{var e;return t&&"focus"===t.type&&(null===(e=this._inputProxy)||void 0===e?void 0:e.isTargetedByEvent(t))?(t.preventDefault(),!0):(this._setIsSuggesting(!1),!1)},this._handleSelect=()=>{if(this._currentProvider&&this._currentProvider.onSelect&&this._selectedItem){const t=this._currentProvider.onSelect(this._selectedItem,this.props.insertAsHtml);t.value?this._updateSelection({value:t.value}):(this._selectedObservable&&this._selectedObservable.unsubscribe(this._handleSelectedLoaded),this._selectedObservable=t,t.subscribe(this._handleSelectedLoaded))}else this._updateSelection(null)},this._handleSelectedLoaded=t=>{this._selectedObservable&&(this._selectedObservable.unsubscribe(this._handleSelectedLoaded),this._selectedObservable=null),t&&this._updateSelection({value:t})},this._updateSelection=t=>{var e,s;if(!this._inputProxy)return;if(null===t&&(t=this._currentProvider?this.getSelectedItem():null),null===t)return void(null===(e=this._inputProxy)||void 0===e||e.focus());if(void 0===t)return void this._setIsSuggesting(!1);null===(s=this._inputProxy)||void 0===s||s.focus();const i=`${t.value} `;this._setIsSuggesting(!1);requestAnimationFrame((()=>{this._inputProxy&&this._inputProxy.insertText(i,this._suggestionInfo.startIndex)}))},this._handleEventOnKeyDown=t=>{this._eventHandledOnKeyDown=!0,t.preventDefault(),t.stopImmediatePropagation()},this._setIsSuggesting=t=>{if(this._isSuggesting.value!==t)if(this._isSuggesting.value=t,this._isSuggesting.value){const{_inputProxy:t,_currentProvider:e}=this;if(!t||!e)return;this._openCallout(this._handleSelect,this._onDismiss),setTimeout((()=>{var t,e,s,n,o;null===(t=this._inputProxy)||void 0===t||t.setInputAttribute(_,"list"),null===(e=this._inputProxy)||void 0===e||e.setInputAttribute(m,null!==(s=(0,h.getSafeId)(v))&&void 0!==s?s:""),null===(n=this._inputProxy)||void 0===n||n.setInputAttribute(g,c.AutocompleteAriaLabel);const r=this._getElementIdByIndex(0);r&&(null===(o=this._inputProxy)||void 0===o||o.setInputAttribute(i,r))}),0)}else this._removeAutocompleteAriaAttributes(),this.closeCallout(),this._currentProvider&&(this._currentProvider=void 0)},this._isSuggesting=t.isSuggesting||new o.ObservableValue(!1),(0,n.getAutocompleteProviders)(e.pageContext),this.state={isVisible:!1,onDismiss:void 0,statusText:this._getStatusText(this._suggestions.value.length)}}bind(t){this._inputProxy=(0,d.isAutoCompleteInputProxy)(t)?t:(0,d.createAutocompleteInputProxy)(t,this.props.onInputChange),this._inputProxy.addKeyDownListener(this._onKeyDown),this._inputProxy.addKeyUpListener(this._onKeyUp),this._inputProxy.addBlurListener(this._onBlur),this._inputProxy.addInputListener(this._onInput),this._inputProxy.addPasteListener(this._onPaste)}dispose(){this._inputProxy&&(this.unbind(),this._inputProxy=void 0)}componentDidMount(){this.props.inputElement&&this.props.inputElement.current&&this.bind(this.props.inputElement.current)}componentWillUnmount(){this._selectedObservable&&this._selectedObservable.unsubscribe(this._handleSelectedLoaded)}render(){var t,e;const{isVisible:i}=this.state;return i?s.createElement(l.Callout,{id:v,className:"mention-autocomplete-component-callout",anchorOrigin:this._anchorOrigin,anchorElement:null===(t=this._inputProxy)||void 0===t?void 0:t.getElementForAnchor(),onDismiss:this._onCalloutDismiss,calloutOrigin:this._calloutOrigin,contentShadow:!0,contentSize:3},s.createElement(a.SuggestionsList,{className:"autocomplete-suggestion-list",loadingText:c.Loading,noResultsFoundText:c.NoResultFound,onSuggestionClicked:this._onClick,renderSuggestion:this._onRenderSuggestion,selectedIndex:this._currentIndex,suggestions:this._suggestions,width:null===(e=this._inputProxy)||void 0===e?void 0:e.getClientWidth()}),s.createElement(p.AutocompleteFooter,{statusText:this.state.statusText})):null}_getStatusText(t){return t>0?r.format(c.StatusTextTemplate,t):""}_openCallout(t,e){if(!this._currentProvider)return;const s=s=>{if(!this._isSuggesting.value)return;this._suggestions.value=s;const i=this._getStatusText(s.length);this.setState({isVisible:!0,onSuggestionClick:t,onDismiss:e,statusText:i,isSearchEnabled:!1})},{value:i,startIndex:n}=this._getWordAtCursor();i.length>1?this._currentProvider.search(i.substr(1),!1).then(s):this._currentProvider.getSuggestions().then(s)}closeCallout(){this._currentIndex.value=0,this.setState({isVisible:!1})}unbind(){var t;null===(t=this._inputProxy)||void 0===t||t.removeListeners()}_isModifierKey(t){return["Shift","Control","Alt","Command"].indexOf(t)>-1}_onKeyUpForSuggestions(t){if(!this._inputProxy||this._pasting)return void(this._pasting=!1);(1===t.key.length&&" "!==t.key||"Backspace"===t.key)&&(window.clearTimeout(this._timer),this._timer=void 0);const{value:e,selectionEnd:s}=this._inputProxy.getSelection(),{startIndex:i,startCharacter:n}=this._suggestionInfo,o=s<=i?"":e.substring(i,s);this._updateSuggestions(o,n)}_onKeyDownForSuggestions(t){if(this._inputProxy)switch(t.key){case"Enter":case"Tab":this._handleSelect(),this._handleEventOnKeyDown(t);break;case"Down":case"Up":case"ArrowUp":case"ArrowDown":if(!this._currentProvider)break;const e="Up"===t.key.substr(-2)?this.previousSuggestion():this.nextSuggestion();e>=0&&this._inputProxy.setInputAttribute(i,this._getElementIdByIndex(e)),this._handleEventOnKeyDown(t);break;case"Escape":this._setIsSuggesting(!1),this._handleEventOnKeyDown(t)}}getId(){return(0,h.getSafeId)("suggestion-list")||""}nextSuggestion(){const t=this._suggestions.value.length;let e=this._currentIndex.value;return e++,e>=t&&(e=0),this._selectedItem=this._suggestions.value[e],this._currentIndex.value=e,this.forceUpdate(),this._currentIndex.value}previousSuggestion(){const t=this._suggestions.value.length;let e=this._currentIndex.value;return e--,e<0&&(e=t-1),this._selectedItem=this._suggestions.value[e],this._currentIndex.value=e,this.forceUpdate(),this._currentIndex.value}getSelectedItem(){if(!this._currentProvider)return null;if(!this._selectedItem&&this._suggestions.length&&(this._selectedItem=this._suggestions.value[this._currentIndex.value]),this._selectedItem){const t=this.props.insertAsHtml?this._currentProvider.getReplacementHtml(this._selectedItem):this._currentProvider.getReplacementText(this._selectedItem);return this._selectedItem=void 0,{value:t}}}_getElementIdByIndex(t){var e;return null!==(e=(0,h.getSafeId)("sug-row-"+t))&&void 0!==e?e:""}_getWordAtCursor(){if(!this._inputProxy)throw Error("input element is null");const{selectionStart:t,selectionEnd:e,value:s}=this._inputProxy.getSelection();let i=t,n=e+1;for(;i>0&&!x.test(s[i-1]);)--i;for(;n<s.length&&!x.test(s[n]);)++n;return{value:s.substring(i,n),startIndex:i}}_removeAutocompleteAriaAttributes(){var t,e,s,n,o;(null===(t=this._inputProxy)||void 0===t?void 0:t.getInputAttribute(g))||null===(e=this._inputProxy)||void 0===e||e.setInputAttribute(g,c.AutocompleteAriaLabel),null===(s=this._inputProxy)||void 0===s||s.removeInputAttribute(_),null===(n=this._inputProxy)||void 0===n||n.removeInputAttribute(m),null===(o=this._inputProxy)||void 0===o||o.removeInputAttribute(i)}}e[t].AutocompleteComponent=S,u.VssComponent.register("autocomplete-component",S)}("ComponentsAutocompleteComponent")}),["Resources","AutocompleteInputProxy","AutocompleteUtility","Constants","Components/AutocompleteFooter","Components/AutocompleteComponent"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-mention.mention-autocomplete"}}));