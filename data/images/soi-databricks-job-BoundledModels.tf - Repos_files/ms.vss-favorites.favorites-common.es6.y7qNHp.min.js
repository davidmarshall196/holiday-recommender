"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("Favorites/Common",["require","exports","VSS/Platform/Context","VSS/Platform/RestClientBase","VSS/Core/Observable"],(function(e,t,i,r,o){var s,a;t.Resources={},t.Resources.FavoriteItemPickerBrowseAllText="Browse all items",t.Resources.FavoriteItemPickerLoadingMessage="Loading favorites...",t.Resources.FavoriteStarFavoritedTitle="Remove from favorites",t.Resources.FavoriteStarUnfavoritedTitle="Add to favorites",t.Resources.FavoriteItemPickerAriaDescription="Use right arrow to toggle favorite status.",t.Resources.FavoriteServiceCouldNotBeQueried="Favorites could not load favorites from service at {0} \n {1}",t.Constants={},(a=t.Constants.FavoriteStorageScopes||(t.Constants.FavoriteStorageScopes={})).Collection="Collection",a.Project="Project",a.Organization="Organization",(s=t.Constants.OwnerScopeTypes||(t.Constants.OwnerScopeTypes={})).Team="Team",s.User="User",t.ContractsService={},function(e){t.RestClientFavorite={};class o extends r.RestClientBase{constructor(e){super(e)}async getFavoriteProviders(e){const t={faultInMissingHost:e};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/FavoriteProviders",queryParams:t})}async createFavorite(e){return this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",body:e})}async createFavoriteOfOwner(e,t,i){const r={ownerScopeType:t,ownerScopeId:i};return this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:r,body:e})}async deleteFavoriteById(e,t,i,r){const o={artifactType:t,artifactScopeType:i,artifactScopeId:r};return this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:e},queryParams:o})}async deleteFavoriteOfOwnerById(e,t,i,r,o,s){const a={ownerScopeType:t,ownerScopeId:i,artifactType:r,artifactScopeType:o,artifactScopeId:s};return this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:e},queryParams:a})}async getFavoriteByArtifact(e,t,i,r,o){const s={artifactType:e,artifactId:t,artifactScopeType:i,artifactScopeId:r,includeExtendedDetails:o};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:s})}async getFavoriteById(e,t,i,r,o){const s={artifactScopeType:t,artifactType:i,artifactScopeId:r,includeExtendedDetails:o};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:e},queryParams:s})}async getFavoriteOfOwnerById(e,t,i,r,o,s,a){const n={ownerScopeType:t,ownerScopeId:i,artifactScopeType:r,artifactType:o,artifactScopeId:s,includeExtendedDetails:a};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:e},queryParams:n})}async getFavorites(e,t,i,r){const o={artifactType:e,artifactScopeType:t,artifactScopeId:i,includeExtendedDetails:r};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:o})}async getFavoritesOfOwner(e,t,i,r,o,s){const a={ownerScopeType:e,ownerScopeId:t,artifactType:i,artifactScopeType:r,artifactScopeId:o,includeExtendedDetails:s};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:a})}}t.RestClientFavorite.FavoriteClientName="IFavoriteRestClient",t.RestClientFavorite.getFavoriteClient=function(e,i){return e.getRestClient(t.RestClientFavorite.FavoriteClientName,i)},i.RestClients.add(t.RestClientFavorite.FavoriteClientName,{factory:o})}(),function(e){t.FavoritesService={};class r extends o.ObservableArray{constructor(e,t,i,r,o){super(t),this.pageContext=e,this.artifactType=i,this.artifactScopeType=r,this.artifactScopeId=o,this.onFavoriteAdded=e=>{this.isAssociatedFavorite(e)&&this.push(e)},this.onFavoriteRemoved=e=>{this.isAssociatedFavorite(e)&&this.removeAll((t=>t.id===e.id))};const s=this.pageContext.getService("IFavoritesService");s.subscribe(this.onFavoriteAdded,"favoriteAdded"),s.subscribe(this.onFavoriteRemoved,"favoriteRemoved")}dispose(){const e=this.pageContext.getService("IFavoritesService");e.unsubscribe(this.onFavoriteAdded,"favoriteAdded"),e.unsubscribe(this.onFavoriteRemoved,"favoriteRemoved")}isAssociatedFavorite(e){return!(this.artifactType&&e.artifactType!==this.artifactType||this.artifactScopeId&&(e.artifactScope.type!==this.artifactScopeType||e.artifactScope.id!==this.artifactScopeId))}}class s extends i.VssObservableService{constructor(){super(...arguments),this.favoriteCollections={}}canUseFavorites(){this.pageContext.getService("IVssSecurityService");return this.pageContext.getService("IVssSecurityService").hasPermission("fa557b48-b5bf-458a-bb2b-1b680426fe8b","/Favorites",3)}canFetchExtendedDetails(){return!0}getFavorites(e,t,i,o){if(!this.canUseFavorites()){const o=new r(this.pageContext,[],e,t,i);return Promise.resolve(o)}const s=`${e}:${t}:${i}:${o}`,a=this.favoriteCollections[s];if(a)return a;const n=this.getProvider(e).then((s=>this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:s.serviceIdentifier}).getFavorites(e,t,i,o).then((o=>new r(this.pageContext,o,e,t,i)))));return this.favoriteCollections[s]=n,n}getTeamFavorites(e,t,i,o,s){if(!this.canUseFavorites()){const e=new r(this.pageContext,[],t,i,o);return Promise.resolve(e)}const a=`${t}:${i}:${o}:${s}:${e}`,n=this.favoriteCollections[a];if(n)return n;const c=this.getProvider(t).then((a=>this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:a.serviceIdentifier,rootPath:a.serviceUri}).getFavoritesOfOwner("Team",e,t,i,o,s).then((e=>new r(this.pageContext,e,t,i,o)))));return this.favoriteCollections[a]=c,c}getFavoritesForScope(e,t,i){if(!this.canUseFavorites()){const i=new r(this.pageContext,[],void 0,e,t);return Promise.resolve(i)}const o=`${e}:${t}:${i}`,s=this.favoriteCollections[o];if(s)return s;const a=this.getProviders().then((o=>{const s={};for(const r in o){const a=o[r];if(!s[a.serviceUri]){const r=this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:a.serviceIdentifier}).getFavorites(void 0,e,t,i);s[a.serviceUri]=r}}const a=[];return Object.keys(s).map((e=>s[e])).forEach((e=>{a.push(e.then((e=>e),(e=>(this.pageContext.getService("IVssTelemetryService").publishEvent("Favorites","FavoritesService",e),[]))))})),Promise.all(a).then((i=>new r(this.pageContext,[].concat(...i),void 0,e,t)))}));return this.favoriteCollections[o]=a,a}addFavorite(e){return this.canUseFavorites()?this.getProvider(e.artifactType).then((t=>this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:t.serviceIdentifier}).createFavorite(e).then((e=>(this._notify(e,"favoriteAdded"),e)),(e=>{throw this._notify(e,"favoriteError"),e}))),(e=>{throw this._notify(e,"favoriteError"),e})):(this.logNoEditPermissionError(),Promise.resolve(e))}addTeamFavorite(e,t){return this.canUseFavorites()?this.getProvider(t.artifactType).then((i=>this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:i.serviceIdentifier}).createFavoriteOfOwner(t,"Team",e).then((e=>(this._notify(e,"favoriteAdded"),e)),(e=>{throw this._notify(e,"favoriteError"),e}))),(e=>{throw this._notify(e,"favoriteError"),e})):(this.logNoEditPermissionError(),Promise.resolve(t))}removeFavorite(e){return this.canUseFavorites()?this.getProvider(e.artifactType).then((t=>this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:t.serviceIdentifier}).deleteFavoriteById(e.id,e.artifactType,e.artifactScope.type,e.artifactScope.id).then((()=>{this._notify(e,"favoriteRemoved")}),(e=>{throw this._notify(e,"favoriteError"),e}))),(e=>{throw this._notify(e,"favoriteError"),e})):(this.logNoEditPermissionError(),Promise.resolve())}removeTeamFavorite(e,t){return this.canUseFavorites()?this.getProvider(t.artifactType).then((i=>this.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:i.serviceIdentifier}).deleteFavoriteOfOwnerById(t.id,"Team",e,t.artifactType,t.artifactScope.type,t.artifactScope.id).then((()=>{this._notify(t,"favoriteRemoved")}),(e=>{throw this._notify(e,"favoriteError"),e}))),(e=>{throw this._notify(e,"favoriteError"),e})):(this.logNoEditPermissionError(),Promise.resolve())}getProvider(e){if(!this.canUseFavorites())return this.logNoEditPermissionError(),Promise.resolve(null);const t=this.pageContext.getService("IVssContributionService").getSharedData("_favoriteProviders");if(t){const i=t[e];if(i)return Promise.resolve(i)}return this.getProviders().then((t=>t[e]))}getProviders(){if(!this.canUseFavorites())return this.logNoEditPermissionError(),Promise.resolve({});if(!this.providersPromise){const e=this.pageContext.getRestClient("IFavoriteRestClient");this.providersPromise=e.getFavoriteProviders().then((e=>e.reduce(((e,t)=>(e[t.artifactType]=t,e)),{})))}return this.providersPromise}logNoEditPermissionError(){console.error("Favorites client UI should not expose or allow write operations with Favorites, when the active user does not have neccessary permission.")}}i.Services.add("IFavoritesService",{serviceFactory:s})}(),function(e){t.Telemetry={};class r extends i.VssService{publishNavigateEvent(e,t){this.publishEvent("onclick",{favoriteType:e,source:t})}publishEvent(e,t){this.pageContext.getService("IVssTelemetryService").publishEvent("Favorites",e,t)}}i.Services.add("IFavoritesTelemetryService",{serviceFactory:r}),t.Telemetry.publishNavigateEvent=function(e,t,i){return e.getService("IFavoritesTelemetryService").publishNavigateEvent(t,i)}}()}),["Resources","Constants","Contracts/Service","RestClient/Favorite","FavoritesService","Telemetry"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-favorites.favorites-common"}}));