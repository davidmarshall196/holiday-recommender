"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("TFS/Admin/OrganizationAadCommon",["require","exports","TFS/Admin/Common/RestClient/Organization","VSS/Core/Util/String","TFS/Admin/Common/Constants/DataProviderConstants","TFS/Admin/Common/RestClient/EnterpriseCatalog","VSS/Platform/Authentication","TFS/Admin/Common/Constants/Generated/Constants"],(function(e,t,n,i,o,r,s,a){!function(e){t[e]={};var l;t[e].OrganizationAadSource=class{updateAadTenant(e,t){e=e||i.EmptyGuidString;return this.getCollectionClient(t).updateOrganization((()=>{let t=[];return t.push({from:"",op:2,path:o.DataProviders.TenantId,value:e}),t})(),o.DataProviders.Me)}getDisconnectedUsers(e,t){return this.getOrganizationSettingsClient(t).getDisconnectedUsers(e)}downloadConnectedOrgs(e,t,n){return this.getEnterpriseCatelogClient(t,n).getCollectionsByTenantId(e)}mapUnresolvedUsers(e,t){let n=this.getGraphClient(e),i={originId:t.mappingOriginId,storageKey:""};return n.updateUser(i,t.currentUserDescriptor)}sendInvitations(e,t){const n={attributes:{},invitationType:2,invitees:t};return this.getInvitationClient(e).sendInvitations(n)}updateOrgCreationPolicy(e,t){let n=this.getTenantPolicyClient(e),i=[];t.properties&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds]&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds].forEach((e=>{i.push(e.objectId)}));const o={name:a.PolicyNames.OrganizationCreationRestriction,value:t.isPolicyEnabled,properties:{[a.PolicyProperties.AllowedUsersAndGroupObjectIds]:JSON.stringify(i),[a.PolicyProperties.ErrorMessage]:t.properties?t.properties[a.PolicyProperties.ErrorMessage]:""}};return n.setPolicy(o,t.policyName)}updateGlobalPatCreationPolicy(e,t){let n=this.getTenantPolicyClient(e),i=[];t.properties&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds]&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds].forEach((e=>{i.push(e.objectId)}));const o={name:a.PolicyNames.RestrictGlobalPersonalAccessToken,value:t.isPolicyEnabled,properties:{[a.PolicyProperties.AllowedUsersAndGroupObjectIds]:JSON.stringify(i)}};return n.setPolicy(o,a.PolicyNames.RestrictGlobalPersonalAccessToken)}updateFullScopePatCreationPolicy(e,t){let n=this.getTenantPolicyClient(e),i=[];t.properties&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds]&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds].forEach((e=>{i.push(e.objectId)}));const o={name:a.PolicyNames.RestrictFullScopePersonalAccessToken,value:t.isPolicyEnabled,properties:{[a.PolicyProperties.AllowedUsersAndGroupObjectIds]:JSON.stringify(i)}};return n.setPolicy(o,a.PolicyNames.RestrictFullScopePersonalAccessToken)}updateTokenLifespanPolicy(e,t){let n=this.getTenantPolicyClient(e),i=[];t.properties&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds]&&t.properties[a.PolicyProperties.AllowedUsersAndGroupObjectIds].forEach((e=>{i.push(e.objectId)}));const o={name:a.PolicyNames.RestrictPersonalAccessTokenLifespan,value:t.isPolicyEnabled,properties:{[a.PolicyProperties.MaxPatLifespanInDays]:t.properties?t.properties[a.PolicyProperties.MaxPatLifespanInDays]:"30",[a.PolicyProperties.AllowedUsersAndGroupObjectIds]:JSON.stringify(i)}};return n.setPolicy(o,a.PolicyNames.RestrictPersonalAccessTokenLifespan)}updateTokenAutoRevocationPolicy(e,t){let n=this.getTenantPolicyClient(e);const i={name:a.PolicyNames.EnableLeakedPersonalAccessTokenAutoRevocation,value:t.isPolicyEnabled,properties:{}};return n.setPolicy(i,a.PolicyNames.EnableLeakedPersonalAccessTokenAutoRevocation)}getCollectionClient(e){return(0,n.getOrganizationClient)(e.pageContext)}getOrganizationSettingsClient(e){return e.getRestClient("IOrganizationSettingsRestClient")}getGraphClient(e){return e.getRestClient("IGraphRestClient")}getInvitationClient(e){return e.getRestClient("IInvitationRestClient")}getEnterpriseCatelogClient(e,t){return(0,r.getEnterpriseCatalogClient)(e,{hostType:1,serviceInstanceType:l.ServiceInstanceTypeAex,authTokenProvider:t&&t.deploymentLevelSessionToken?new s.BearerTokenProvider(t.deploymentLevelSessionToken.token):void 0})}getTenantPolicyClient(e){return e.getRestClient("ITenantPolicyRestClient")}},function(e){e.ServiceInstanceTypeAex="00000041-0000-8888-8000-000000000000"}(l=t[e].OrganizationServiceInstanceTypes||(t[e].OrganizationServiceInstanceTypes={}))}("SourcesOrganizationAadSource")}),["Sources/OrganizationAadSource"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-admin-web.admin-organization-aad-common-content"}}));