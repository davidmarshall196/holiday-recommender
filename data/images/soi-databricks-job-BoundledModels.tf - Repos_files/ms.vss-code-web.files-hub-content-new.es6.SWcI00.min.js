"use strict"; if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WORKER&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         /* eslint-disable */
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=26110&type=WINDOW&McasTsid=26110&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
         /* eslint-enable */
     }
}define("Repos/Views/FilesHub",["require","exports","VSS/Platform/Context","VSS/Platform/RestClientBase","Repos/Common/Util/Commit","Repos/Common/Util/Editor","Repos/Common/Util/File","Repos/Common/Util/Ref","Repos/Common/Util/Version","Repos/Common/VCViewModelDataProviderService","Repos/Files/Components/ContentPreview","Repos/FilesHubCommon/Annotate","Repos/FilesHubCommon/FileEditContext","Repos/FilesHubCommon/FilesHubMenuItems","Repos/FilesHubCommon/FilesHubTabs","Tfs/Platform/Page","VSS/Core/Observable","VSS/Core/Util/String","VSS/Features/PlatformUI/ContributedMenu","VSS/Features/PlatformUI/MessageDialog","VSS/Platform/Feature","VSS/Platform/FPS","VSS/Platform/Util/Storage","VSS/Platform/UserClaims","VSS/Platform/Util/Url","react","VSS/Features/MonacoWidgets/Registration","VSS/Platform/Components/Performance","VSS/Platform/Layout","VSSUI/Card","VSSUI/HeaderCommandBar","VSSUI/Observer","Repos/ChangesCommon/ChangesContext","Repos/ChangesCommon/ChangesNavigationService","VSSUI/Button","VSSUI/Callout","VSSUI/Pill","VSSUI/ResponsiveLayout","VSSUI/TooltipEx","VSSUI/Util","Repos/Common/ReposActionService","Repos/FilesHubCommon/Components/FilesEditableBreadcrumb","Repos/FilesHubCommon/Components/FilesHeaderCommandBar","Repos/VersionDropdown/Components/VersionDropdown","VSS/Platform/Location","VSSUI/Clipboard","VSSUI/Header","VSSUI/Resources.Clipboard","VSSUI/Utilities/ScreenSize","Repos/FilesHubCommon/Components/FolderListing","VSSUI/ZeroData","Repos/Files/ContentPreview","Repos/FilesHubCommon/Components/FileExplorerTree","Repos/Messages/Components/ReposMessages","VSSUI/Page","VSSUI/Splitter","VSSUI/Surface","VSSUI/Tabs","VSSUI/MessageCard"],function(e,t,i,o,n,s,r,a,l,c,d,m,h,u,g,p,v,C,f,S,b,I,F,x,w,P,V,y,T,E,R,N,D,H,B,O,U,L,k,A,M,G,j,z,W,_,q,Q,K,$,Z,Y,J,X,ee,te,ie,oe,ne){var se,re,ae,le,ce;se=t.Resources={},t.Resources.Blame="Blame",t.Resources.BranchNotFound="Branch not found",t.Resources.Clone="Clone",t.Resources.Compare="Compare",t.Resources.Commit="Commit",t.Resources.Commits="Commits",t.Resources.Contents="Contents",t.Resources.DefaultCollection="DefaultCollection/",t.Resources.Discard="Discard",t.Resources.Download="Download",t.Resources.DownloadAsZip="Download as Zip",t.Resources.FilesShortcutGroup="Files",t.Resources.GoToRepositoryRoot="Go to repository root",t.Resources.GoToDefaultBranch="Go to default branch",t.Resources.Head="head",t.Resources.InvalidFileTitle="File not found or you do not have permission",t.Resources.InvalidFileMessageFormat="No item exists at path '{0}' at version '{1}'",t.Resources.Files="Files",t.Resources.Filter="Filter",t.Resources.Fork="Fork",t.Resources.HighlightChanges="Highlight changes",t.Resources.History="History",t.Resources.InlineDiff="Inline",t.Resources.InlineDiffTooltip="Show diff inline",t.Resources.LinesAddedTooltip="{0} total lines added",t.Resources.LinesRemovedTooltip="{0} total lines removed",t.Resources.Name="Name",t.Resources.NextDiff="show next diff",t.Resources.NoPreviousVersion="no previous changes",t.Resources.OpenInVsCodeForTheWeb="Open in VS Code for the Web",t.Resources.Preview="Preview",t.Resources.Previous="previous",t.Resources.PreviousDiff="show previous diff",t.Resources.README="README",t.Resources.SelectBranchShortcutDescription="Select branch",t.Resources.SetupBuild="Set up build",t.Resources.ShowExplorerPane="Show files tree",t.Resources.SideBySideDiff="Side-by-side",t.Resources.SideBySideDiffTooltip="Show diff side-by-side",t.Resources.UnsavedChanges="Unsaved changes",t.Resources.UnsavedFileFormat='You have unsaved changes made to file "{0}" which will be lost if you navigate away. Are you sure you wish to discard these changes?',t.Resources.VsCodeUrl="https://vscode.dev/",t.Resources.IndexingButtonInitialText="Fetching file indexing information",t.Resources.IndexingInitialOnClickRef="https://aka.ms/FileBug",(function(e){re=t.RestClientGit={};class n extends o.RestClientBase{constructor(e){super(e);}async getCommitsBatch(e,t,i,o,n,s){const r={$skip:o,$top:n,includeStatuses:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/CommitsBatch",routeValues:{project:i,repositoryId:t},queryParams:r,body:e});}async getFilePaths(e,t,i,o){const n={scopePath:i,versionDescriptor:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/FilePaths/{*scopepath}",routeValues:{project:e,repositoryId:t},queryParams:n});}async getItemsBatch(e,t,i){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/ItemsBatch",routeValues:{project:i,repositoryId:t},body:e});}}t.RestClientGit.GitClientName="Repos.FilesHub.Git.IGitRestClient",t.RestClientGit.getGitClient=function(e,i){return e.getRestClient(t.RestClientGit.GitClientName,i);},i.RestClients.add(t.RestClientGit.GitClientName,{factory:n,options:{resourceAreaId:"4e080c62-fa21-4fbc-8fef-2a10a2b38049",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}});}()),(function(e){ae=t.FilesHubViewService={};const o="Repos.FilesHub.ExplorerPane";class P extends i.VssService{constructor(){super(...arguments),this.sortItems=(e,t)=>(e.isFolder===t.isFolder?(0,C.localeIgnoreCaseComparer)(e.name,t.name):e.isFolder?-1:1);}_serviceStart(e){super._serviceStart(e),this.itemsByPath={},this.itemsByPathLowercase={},this.itemsByParentPath={},this.loadedFolders=new v.ObservableArray(),this.foldersWithLastCommits={},this.explorerCollapsed=new v.ObservableValue("collapsed"===(0,F.tryGetLocalStorageValue)(o));const t=this.pageContext.getService("IVssContributionService"),i=this.pageContext.getService("IPageStateHistoryService"),n=this.pageContext.getService("IVCViewModelDataProviderService");this.repository=n.getRepository();const s=n.getUserPreferences();this.diffOrientation=new v.ObservableValue(s.diffViewerOrientation||1);const r=(0,p.getTFSPageData)(this.pageContext).project;this.projectId=r.id,this.projectName=r.name;const a=i.getProjectedState(),c=this.fixPath(a.path||"/"),d=a.version,m="true"===a.createIfNew;m&&i.queueValueChange("createIfNew","",0);const h=t.getData("ms.vss-code-web.source-explorer-tree-file-listing-data-provider"),u=n.getDefaultGitBranchName()||"";h?(this.version={version:h.descriptor.version,versionOptions:h.descriptor.versionOptions,versionType:h.descriptor.versionType},this.versionString=(0,l.getVersionString)(this.version),this.processItems(h.items.items)):(this.version=(0,l.gitVersionStringToVersionDescriptor)(d||"GB"+u),this.versionString=(0,l.getVersionString)(this.version),this.getChildItems(c,!1,m)),0===this.version.versionType&&(this.refName="refs/heads/"+this.version.version);let g=__WRAPPED_get(this.itemsByPath,c);g||(g=this.createGitItem({path:c,isFolder:!1,isInvalid:!0})),g.isInvalid&&m&&(g.isNewItem=!0,__WRAPPED_set(this.itemsByPath,g.path,'=',g)),this.selectedItem=new v.ObservableValue(g),this.editMode=new v.ObservableValue(!!g.isNewItem),i.registerObservable(this.selectedItem,"path",1,e=>("/"===e.path?"":e.path),e=>{e=this.fixPath(e);const t=this.getItem(e,!0);return this.setSelectedItem(t),t;}),this.pageContext.getService("IUnsavedChangesService").register({isDirty:()=>(!!(this.editMode.value&&this.selectedItemContent&&this.selectedItemContent.value&&this.selectedItemContent.value.editContext&&(this.selectedItemContent.value.editContext.getIsDirty().value||this.selectedItem.value.isNewItem))),getDirtyMessage:()=>((0,C.format)(se.UnsavedFileFormat,this.selectedItem.value.path))}),0===this.version.versionType&&u!==this.version.version&&n.setUserDefaultBranch(this.version.version);}dropFiles(e,t){this.executeFileActionCommand("upload",e,t.files);}getDiffOrientation(){return this.diffOrientation;}getEditMode(){return this.editMode;}setEditMode(e){e!==this.editMode.value&&(this.editMode.value=e);}getVersion(){return this.version;}setDiffOrientation(e){if(this.diffOrientation.value!==e){this.diffOrientation.value=e;const t=this.pageContext.getService("IVCViewModelDataProviderService");t.setUserPreferences(Object.assign(Object.assign({},t.getUserPreferences()),{diffViewerOrientation:e}));}}getSelectedItem(){return this.selectedItem;}setSelectedItem(e,t){e!==this.selectedItem.value?this.pageContext.getService("IUnsavedChangesService").triggerNavigateAway(()=>{!!t!==this.editMode.value&&(this.editMode.value=!!t),this.updateSelectedItem(e);},()=>{this.selectedItem.value=this.selectedItem.value;}):void 0!==t&&t!==this.editMode.value&&(this.editMode.value=t);}setSelectedPath(e){e=this.fixPath(e);const t=this.getItem(e,!1);if(t)this.setSelectedItem(t);else{this.getChildItems(e).ready.subscribe(()=>{const t=this.getItem(e,!0);this.setSelectedItem(t);});}}getLoadedFolders(){return this.loadedFolders;}getChildItems(e,t,i){let o=__WRAPPED_get(this.itemsByParentPath,e);if(o)t&&this.ensureCommitDetailsFetched(e);else{o=new v.ReadyableObservableArray(),__WRAPPED_set(this.itemsByParentPath,e,'=',o);const n=[e];let s=(0,r.getParentPath)(e);for(;s&&!__WRAPPED_get(this.itemsByParentPath,s);)n.push(s),s=(0,r.getParentPath)(s);(0,re.getGitClient)(this.pageContext).getItemsBatch({includeContentMetadata:!1,itemDescriptors:n.map(e=>(Object.assign({path:e,recursionLevel:4},this.version)))},this.repository.id,this.projectId).then(o=>{const s={};let r;for(let e=0,t=n.length;e<t;e++){const t=__WRAPPED_get(n,e);let a,l=__WRAPPED_get(o,e);0===l.length&&(a={path:t,isFolder:e>0,isInvalid:!0,isNewItem:i},l=[a]),i&&r&&l.push(r),r=a,__WRAPPED_set(s,t,'=',l);}this.processItems(s),t&&this.ensureCommitDetailsFetched(e);},()=>{this.processItems({[e]:[{path:e,isFolder:!1,commitId:"",objectId:"",isInvalid:!0}]});});}return o;}getCloneMenuItems(){const e=[{groupKey:"header-items",iconProps:{iconName:"CloneToDesktop"},id:"clone",onActivate:this.getCommandExecutor("clone"),text:se.Clone}];return(0,x.userHasClaim)(this.pageContext,"member")&&e.push({groupKey:"header-items",iconProps:{iconName:"GitFork"},id:"fork",onActivate:this.getCommandExecutor("fork"),text:se.Fork}),e;}getItemMenuItems(e,t){const o=new v.ObservableCollection();let n=(0,b.isFeatureFlagEnabled)(this.pageContext,"WebAccess.VersionControl.Editing",!0);if(n){const e=this.pageContext.getService("IReposPermissionsService");e.hasPermission(4,this.version)||e.hasPermission(16)||(n=!1);}let s=!1;if(e.path===this.selectedItem.value.path&&(s=!(!this.selectedItemContent||!this.selectedItemContent.value||!this.selectedItemContent.value.details.metadata.isBinary&&!this.selectedItemContent.value.details.contentTruncated)),!e.isInvalid&&(n&&o.push((0,u.getItemCommonMenuItems)(e.isFolder,"/"===e.path,s,t=>(this.getCommandExecutor(t,e)))),o.push([{groupKey:"item-download",iconProps:{iconName:"Download"},id:"download",onActivate:()=>{window.open(this.getDownloadUrlForItem(e.path,this.version,e.isFolder,!0),"_blank","noopener");},text:e.isFolder?se.DownloadAsZip:se.Download}]),t)){const n={gitRepository:this.repository,item:{sourceProvider:"Git",path:e.path,isFolder:e.isFolder,isSymLink:e.isSymLink,item:{isFolder:e.isFolder,serverItem:e.path,version:this.versionString,gitObjectType:e.isFolder?2:3,commitId:e.commitId?{full:e.commitId,short:e.commitId.substr(0,8)}:void 0,objectId:e.objectId?{full:e.objectId,short:e.objectId.substr(0,8)}:void 0},url:this.getItemUrl(e.path)},version:this.version.version};n.getSourceItemContext=()=>(n),(0,i.setRemoteSerializationSettings)(n,{proxyFunctions:!0});for(const e of t)(0,f.addMenuItems)(this.pageContext,o,e,n);}return o;}getDiffOrientationMenuItem(){const e=this.getDiffOrientation().value,t=1===e?se.SideBySideDiffTooltip:se.InlineDiffTooltip;return{ariaLabel:t,iconProps:{iconName:1===e?"DiffSideBySide":"DiffInline"},id:"diffOrientation",subMenuProps:{id:"diffOrientationSubMenu",items:[{iconProps:{iconName:"DiffSideBySide"},id:"diffOrientationSideBySide",onActivate:()=>{this.setDiffOrientation(1);},text:se.SideBySideDiff},{iconProps:{iconName:"DiffInline"},id:"diffOrientationInline",onActivate:()=>{this.setDiffOrientation(2);},text:se.InlineDiff}]},subtle:!0,text:1===e?se.SideBySideDiff:se.InlineDiff,tooltipProps:{text:t}};}getAllFiles(){return this.allFilePaths||(this.allFilePaths=new v.ReadyableObservableArray(),(0,re.getGitClient)(this.pageContext).getFilePaths(this.projectId,this.repository.id,void 0,this.version).then(e=>{const t=[],i=new Set();for(const o of e.paths){const e=(0,r.getParentPath)(o);e&&(i.has(e)||(t.push(this.createGitItem({path:e,isFolder:!0})),i.add(e))),t.push(this.createGitItem({path:"/"+o,isFolder:!1}));}this.allFilePaths.value=t,this.allFilePaths.ready.value=!0;})),this.allFilePaths;}getRootItem(){return this.createGitItem({path:"/",isFolder:!0});}getSelectedItemContent(){if(!this.selectedItemContent){const e=new v.ObservableValue(void 0);this.selectedItemContent=e;const t=this.selectedItem.value;if(t.isNewItem){const i=(0,r.getFileName)(t.path);e.value={commitId:"",details:{content:"",contentTruncated:!1,objectId:"",metadata:{contentType:"text/plain",extension:(0,r.getFileExtension)(i),fileName:(0,r.getFileName)(i)},resourceUri:(0,s.getGitResourceUri)(this.repository.id,this.version,t.path)},editContext:this.createFileEditContext(t,"")};}else t.isFolder||this.getItemContentPromise(t.path,this.version).then(i=>{i.details.metadata.isBinary||(i.editContext=this.createFileEditContext(t,i.details.content)),e.value=i;});}return this.selectedItemContent;}getSelectedItemAnnotationBlocks(){if(!this.selectedItemAnnotationBlocks){const e=this.selectedItem.value.path;this.selectedItemAnnotationBlocks=new v.ReadyableObservableArray();const t=this.pageContext.getService("IVssContributionService");(0,re.getGitClient)(this.pageContext).getCommitsBatch({$top:1e3,excludeDeletes:!0,itemPath:e,itemVersion:this.version},this.repository.id,this.projectId).then(i=>{if(this.selectedItem.value.path===e){let o;0===this.version.versionType&&(o=(0,a.branchNameToRef)(this.version.version));const n=this.pageContext.getService("IReposRoutingService"),s=i.map((t,s)=>({annotatePreviousUrl:i.length>s+1?n.getFilesBlameUrl(this.repository.name,this.projectName,e,(0,l.commitToVersionDescriptor)(i[s+1].commitId)):void 0,authorName:t.author.name,authorEmail:t.author.email,changeUrl:n.getCommitUrl(this.repository.name,this.projectName,t.commitId,o,e),comment:t.comment,date:t.author.date,shortId:(0,a.getShortCommitId)(t.commitId)})),r=(o,n)=>(t.getDataAsync("ms.vss-code-web.annotate-git-diffs-data-provider",{path:e,repositoryId:this.repository.id,versions:i.slice(o,o+n).map(e=>("GC"+e.commitId))},!0));(0,m.loadAnnotationBlocks)(this.selectedItem,this.selectedItemAnnotationBlocks,s,r);}});}return this.selectedItemAnnotationBlocks;}getItemContent(e,t){if(this.selectedItemContent&&this.selectedItem&&this.selectedItem.value&&this.selectedItem.value.path===e&&(!t||this.versionString===(0,l.getVersionString)(t)))return this.selectedItemContent;const i=new v.ObservableValue(void 0);return this.getItemContentPromise(e,t||this.version).then(e=>{i.value=e;}),i;}getFileDownloadUrl(e,t,i){return this.getDownloadUrlForItem(e,t||this.version,!1,!!i);}getScrollToPosition(){return this.scrollToPosition;}getItemUrl(e,{version:t,absoluteUrl:i,tabId:o,anchor:n}={}){const s=[{name:"path",value:e},{name:"version",value:t||this.versionString}];o&&s.push({name:"_a",value:o}),n&&s.push({name:"anchor",value:n});const r="?"+(0,w.toQueryString)(s);let a=r;return i&&(a=__WRAPPED_get(window,'location').origin+__WRAPPED_get(window,'location').pathname+r),a;}getExplorerCollapsed(){return this.explorerCollapsed;}setExplorerCollapsed(e){this.explorerCollapsed.value=e,(0,F.trySetLocalStorageValue)(o,e?"collapsed":void 0);}setScrollToPosition(e){this.scrollToPosition=e;}getUrlTransformer(e){return new d.MarkdownFilesHubUrlTransformer(e,!1,e=>(e===this.versionString),(e,t)=>(this.getItemUrl(e,{anchor:t})),e=>(this.getDownloadUrlForItem(e,this.version,!1,!1)));}updateSelectedItem(e){if(this.selectedItemContent=void 0,this.selectedItemAnnotationBlocks=void 0,this.scrollToPosition=void 0,this.selectedItem.value.isNewItem){let t=e.path;for(;t&&"/"!==t;){const e=this.getItem(t,!1);if(!e||!e.isNewItem)break;t=(0,r.getParentPath)(t);}(0,I.FastPageSwitch)(this.pageContext,this.getItemUrl(t),!1);}else this.selectedItem.value=e;}getItemContentPromise(e,t){return this.pageContext.getService("IGitFilesService").getItemContentPromise(e,t);}getDownloadUrlForItem(e,t,i,o){const n=this.pageContext.getService("IVssPageService").getData().hostPath,s=new w.Uri((0,w.combineUrlPaths)(n,`${this.projectId}/_apis/git/repositories/${this.repository.id}/items`));return s.addQueryParams({path:e,"versionDescriptor[versionOptions]":t.versionOptions||0,"versionDescriptor[versionType]":t.versionType||0,"versionDescriptor[version]":t.version,resolveLfs:!0,$format:i?"zip":"octetStream","api-version":"5.0"}),o&&s.addQueryParam("download","true"),s.absoluteUri;}createFileEditContext(e,t){const i=new h.FileEditContext(t,()=>{(0,S.showMessageDialog)(this.pageContext,{message:(0,C.format)(se.UnsavedFileFormat,e.path),onClose:o=>{o&&(i.setContent(t),this.setEditMode(!1),this.updateSelectedItem(e));},okButtonProps:{danger:!0,primary:!1,text:se.Discard},title:se.UnsavedChanges});},t=>{this.executeFileActionCommand("commit",e,t);});return i;}getCommandExecutor(e,...t){return"edit"===e?()=>(this.setSelectedItem(t[0],!0)):()=>{this.executeFileActionCommand(e,...t);};}executeFileActionCommand(e,...t){this.pageContext.getService("IVssContributionService").executeCommandEx("ms.vss-code-web.files-hub-actions-command",{dependencies:["ms.vss-code-web.files-hub-actions-content"],serviceName:"IFilesHubActionsService",methodName:e},...t);}getItem(e,t){let i=__WRAPPED_get(this.itemsByPath,e);return i||(i=__WRAPPED_get(this.itemsByPathLowercase,e.toLocaleLowerCase()),!i&&t&&(i=this.createGitItem({path:e,isFolder:!1,isInvalid:!0}))),i;}processItems(e){const t=[],i=[];for(const o in e){const n=this.processChildItems(o,__WRAPPED_get(e,o));if(n){i.push(n);const e=this.getItem(o,!1);e&&e.isFolder&&t.push({path:o,children:n.value});}}t.sort((e,t)=>(e.path.length-t.path.length)),this.loadedFolders.push(...t);for(const e of i)e.ready.value||(e.ready.value=!0);}processChildItems(e,t){const i=[],o="/"===e[e.length-1]?e:e+"/";for(const e of t){const t=this.createGitItem(e);if(t.path===o+t.name)if(t.isFolder&&i.length&&i[i.length-1].isFolder&&t.path.startsWith(i[i.length-1].path+"/")){const e=i.pop();i.push(Object.assign(Object.assign({},t),{name:t.path.substr(o.length),lastCommit:e.lastCommit}));}else i.push(t);}i.sort(this.sortItems);let n=__WRAPPED_get(this.itemsByParentPath,e);return n||(n=new v.ReadyableObservableArray(),__WRAPPED_set(this.itemsByParentPath,e,'=',n)),n.value=i,n;}createGitItem(e){const t=__WRAPPED_get(this.itemsByPath,e.path);if(t)return t;const i=(0,r.getFileName)(e.path),o={commitId:e.commitId,iconProps:"/"===e.path?{iconName:"GitLogo"}:e.isFolder?{iconName:"FabricFolderFill",className:"repos-folder-icon"}:e.isSymLink?{iconName:"PageArrowRight"}:{iconName:(0,r.getIconNameForFile)(i)},isInvalid:e.isInvalid,isFolder:e.isFolder,isNewItem:e.isNewItem,isSymLink:e.isSymLink,lastCommit:new v.ObservableValue(void 0),linkProps:{href:this.getItemUrl(e.path)},name:"/"===e.path?(0,c.getGitRepository)(this.pageContext).name:i,objectId:e.objectId,path:e.path};if(e.commitId||e.isNewItem){__WRAPPED_set(this.itemsByPath,e.path,'=',o);const t=e.path.toLocaleLowerCase();t===e.path||__WRAPPED_get(this.itemsByPathLowercase,t)||__WRAPPED_set(this.itemsByPathLowercase,t,'=',o);}return o;}ensureCommitDetailsFetched(e){if(!__WRAPPED_get(this.foldersWithLastCommits,e)){__WRAPPED_set(this.foldersWithLastCommits,e,'=',!0);this.pageContext.getService("IVssContributionService").getDataAsync("ms.vss-code-web.git-last-change-tree-items-data-provider",{allowPartial:!0,includeCommits:!0,path:e,repositoryId:this.repository.id,version:this.versionString}).then(t=>{const i={};if(t.commits)for(const e of t.commits)__WRAPPED_set(i,e.commitId,'=',e);const o=this.pageContext.getService("IReposRoutingService");for(const s of t.items){const t=this.getItem((0,w.combineUrlPaths)(e,s.path),!1),r=__WRAPPED_get(i,s.commitId);t&&r&&(t.lastCommit.value={comment:(0,n.getShortCommitComment)(r.comment),date:r.author.date,commitId:r.commitId,name:r.author.name,href:o.getCommitUrl(this.repository.name,this.projectName,r.commitId,this.refName),shortCommitId:(0,a.getShortCommitId)(r.commitId)});}});}}fixPath(e){return"/"+(0,r.trimTrailingSlash)((0,r.trimLeadingSlash)((e||"").replace(/\\/g,"/")));}}function V(e){return e.getService("IFilesHubViewService");}t.FilesHubViewService.getFilesHubViewService=V,i.Services.add("IFilesHubViewService",{serviceFactory:P});class y extends g.FilesHubTabsServiceBase{getTabRegistrations(){return T;}getFilesHubService(e){return V(e);}}const T=[];t.FilesHubViewService.registerFilesHubTab=function(e){T.push(e);},t.FilesHubViewService.getFilesHubTabsService=function(e){return e.getService("IFilesHubTabsService");},i.Services.add("IFilesHubTabsService",{serviceFactory:y});}()),(function(e){le=__WRAPPED_set(t,e,'=',{});class i extends T.VssComponent{constructor(){super(...arguments),this.onContentChanged=e=>{const t=this.context.pageContext.getService("IFilesHubViewService").getSelectedItemContent();t.value&&t.value.editContext&&t.value.editContext.setContent(e);},this.getCodeSelectionLinkUrl=e=>{const t=this.context.pageContext.getService("IFilesHubViewService"),i=new w.Uri(t.getItemUrl(t.getSelectedItem().value.path,{absoluteUrl:!0}));return i.addQueryParams({line:e.startLineNumber,lineEnd:e.endLineNumber,lineStartColumn:e.startColumn,lineEndColumn:e.endColumn,lineStyle:"plain",_a:"contents"}),i.absoluteUri;};}render(){return P.createElement(y.PerformanceScenarioContext.Consumer,null,e=>{e.getScenario().addProperties({editor:!0});const t=this.context.pageContext.getService("IFilesHubViewService"),i=e.registerPendingWork("load-file-editor"),o=this.getSelectionFromQueryParams();let n;return this.props.showBlame&&(n=t.getSelectedItemAnnotationBlocks()),P.createElement(N.Observer,{content:t.getSelectedItemContent()},e=>{var s;let r;e.content&&(r=e.content.details,e.content.editContext&&(r={content:e.content.editContext.getContent(),contentTruncated:e.content.details.contentTruncated,metadata:e.content.details.metadata,objectId:e.content.details.objectId,resourceUri:e.content.details.resourceUri}));const a=r&&!r.metadata.isBinary;return P.createElement(E.Card,{className:(0,T.css)("no-padding",a&&"flex-grow v-scroll-hidden"),contentProps:{className:"relative",contentPadding:!1}},r?P.createElement("div",{className:(0,T.css)("flex-row flex-grow scroll-hidden",a&&"absolute-fill")},P.createElement(T.WrappedComponent,{dependencies:["ms.vss-code-web.code-editor"],wrappedType:"repos-file-viewer",wrappedProps:{annotationBlocks:n,className:"flex-row flex-grow",content:r,editable:t.getEditMode(),editorClassName:"repos-file-editor-background scroll-hidden",editorWidgets:[(0,V.getLinkWidgetRegistration)(this.getCodeSelectionLinkUrl,this.context.pageContext,null===(s=e.content)||void 0===s?void 0:s.details.metadata.extension)],getCodeSelectionLinkUrl:this.getCodeSelectionLinkUrl,getDownloadUrl:e=>(t.getFileDownloadUrl(t.getSelectedItem().value.path,void 0,e)),initialScrollPosition:t.getScrollToPosition(),initialSelectedText:o,onContentChanged:this.onContentChanged,onLoaded:i.complete,onScrollChanged:e=>{t.setScrollToPosition(e);}}})):P.createElement("div",{className:"repos-file-editor-background flex-grow"}));});});}getSelectionFromQueryParams(){const e=this.context.pageContext.getService("IPageStateHistoryService"),t=e.getProjectedState();if(t.line&&t.lineStartColumn){const i={startLineNumber:parseInt(t.line),endLineNumber:parseInt(t.lineEnd||t.line),startColumn:parseInt(t.lineStartColumn),endColumn:parseInt(t.lineEndColumn||t.lineStartColumn)};return delete t.line,delete t.lineEnd,delete t.lineStartColumn,delete t.lineEndColumn,delete t.lineStyle,e.queueState(t,0),i;}}}__WRAPPED_get(t,e).FileContent=i,(0,ae.registerFilesHubTab)({getTab:(e,t,o)=>{if(!t.isFolder&&(!t.isInvalid||t.isNewItem)){const t=e.getService("IFilesHubFilterActionsService");return{id:"contents",name:se.Contents,order:10,render:()=>(P.createElement(i,null)),renderFilterBar:e=>(e?P.createElement(R.HeaderCommandBar,{items:t.getActions()}):void 0)};}},dependencies:["ms.vss-code-web.code-editor"]});}("ComponentsFileContent")),t.ComponentsBlameContent={},(0,ae.registerFilesHubTab)({getTab:(e,t,i)=>{if(!t.isFolder&&!t.isInvalid&&!i){const t=e.getService("IFilesHubFilterActionsService");return{id:"blame",name:se.Blame,order:40,render:()=>(P.createElement(le.FileContent,{showBlame:!0})),renderFilterBar:e=>(e?P.createElement(R.HeaderCommandBar,{items:t.getActions()}):void 0)};}},dependencies:["ms.vss-code-web.code-editor"]}),(function(e){__WRAPPED_set(t,e,'=',{});class o extends T.VssComponent{render(){const e=this.context.pageContext.getService("IFilesHubViewService"),t=this.context.pageContext.getService("ICompareContentService");return P.createElement(y.PerformanceScenarioContext.Consumer,null,i=>{i.getScenario().addProperties({editor:!0});const o=i.registerPendingWork("load-file-diff-viewer");return P.createElement(N.Observer,{modifiedPath:t.getModifiedPath(),modifiedVersion:t.getModifiedVersion(),originalPath:t.getOriginalPath(),originalVersion:t.getOriginalVersion()},i=>((this.modifiedCompareVersion&&this.modifiedCompareVersion.path===i.modifiedPath&&(0,l.getVersionString)(this.modifiedCompareVersion.version)===(0,l.getVersionString)(i.modifiedVersion)||(this.modifiedCompareVersion={content:e.getItemContent(i.modifiedPath,i.modifiedVersion),path:i.modifiedPath,version:i.modifiedVersion}),this.originalCompareVersion&&this.originalCompareVersion.path===i.originalPath&&(0,l.getVersionString)(this.originalCompareVersion.version)===(0,l.getVersionString)(i.originalVersion)||(this.originalCompareVersion={content:e.getItemContent(i.originalPath,i.originalVersion),path:i.originalPath,version:i.originalVersion}),P.createElement(P.Fragment,null,P.createElement(s,{modifiedVersion:this.modifiedCompareVersion,originalVersion:this.originalCompareVersion,onModifiedVersionChanged:(e,i)=>{t.setModifiedVersion(e,i);},onOriginalVersionChanged:(e,i)=>{t.setOriginalVersion(e,i);},pageContext:this.context.pageContext}),P.createElement(n,{modifiedVersion:this.modifiedCompareVersion,originalVersion:this.originalCompareVersion,pageContext:this.context.pageContext,onLoaded:o&&o.complete})))));});}}__WRAPPED_get(t,e).CompareContent=o;const n=e=>{const t=e.pageContext.getService("IFilesHubViewService"),i=(0,H.getGitNavigationService)(e.pageContext);return P.createElement(N.Observer,{originalContent:e.originalVersion.content,modifiedContent:e.modifiedVersion.content},o=>{const n=()=>(t.getFileDownloadUrl(e.modifiedVersion.path,e.modifiedVersion.version));let s=()=>(t.getFileDownloadUrl(e.originalVersion.path,e.originalVersion.version));const r=o.modifiedContent;let a=o.originalContent;a&&a.error&&(a=r,s=n);const l=o.modifiedContent&&!o.modifiedContent.details.metadata.isBinary;return P.createElement(D.ChangesContext.Provider,{value:{navigationService:i}},P.createElement(E.Card,{className:(0,A.css)("no-padding",l&&"flex-grow flex-noshrink v-scroll-hidden"),contentProps:{className:"relative",contentPadding:!1}},a&&r?P.createElement("div",{className:(0,A.css)("flex-row flex-grow scroll-hidden",l&&"absolute-fill")},P.createElement(T.WrappedComponent,{wrappedType:"repos-diff-viewer",dependencies:["ms.vss-code-web.code-editor"],wrappedProps:{addDiffKeyboardShortcuts:!1,className:"flex-row flex-grow",diffOrientation:t.getDiffOrientation(),editable:!1,editorClassName:"repos-file-editor-background scroll-hidden",getModifiedDownloadUrl:n,getOriginalDownloadUrl:s,isPixelDiff:!1,modifiedContent:r.details,onLoaded:e.onLoaded,originalContent:a.details}})):P.createElement("div",{className:"repos-file-editor-background flex-grow"})));});},s=e=>{const t=e.pageContext.getService("IFilesHubViewService"),i=(0,H.getGitNavigationService)(e.pageContext);return P.createElement(E.Card,{className:"no-padding",contentProps:{contentPadding:!1,className:"repos-file-compare-toolbar"}},P.createElement("div",{className:"rhythm-horizontal-8 flex-noshrink margin-left-8 margin-vertical-8"},P.createElement(r,{pageContext:e.pageContext,currentVersion:e.originalVersion,onVersionChanged:e.onOriginalVersionChanged,ariaLabelPrefix:"Original"}),P.createElement(r,{pageContext:e.pageContext,currentVersion:e.modifiedVersion,onVersionChanged:e.onModifiedVersionChanged,ariaLabelPrefix:"Modified"})),P.createElement(N.Observer,{diffNavigation:i.getDiffNavigation(),diffOrientation:t.getDiffOrientation()},({diffNavigation:e})=>(P.createElement(L.ResponsiveLayout,{responsiveChildren:[1,2],ignoredChildren:[0]},P.createElement("div",{className:"flex-row flex-center flex-grow rhythm-horizontal-8 margin-8 scroll-hidden"},P.createElement("div",{className:"flex-grow",key:"mid-spacer"}),P.createElement("div",{className:"flex-row",key:"added-removed-pills"},e&&e.totalRemovedLines>0&&P.createElement(U.Pill,{containsCount:!0,className:"repos-compare-removed-lines-pill"},P.createElement(k.Tooltip,{text:(0,C.format)(se.LinesRemovedTooltip,e.totalRemovedLines)},P.createElement("span",null,"-",e.totalRemovedLines))),e&&e.totalAddedLines>0&&P.createElement(U.Pill,{containsCount:!0,className:"repos-compare-added-lines-pill"},P.createElement(k.Tooltip,{text:(0,C.format)(se.LinesAddedTooltip,e.totalAddedLines)},P.createElement("span",null,"+",e.totalAddedLines)))),P.createElement(R.HeaderCommandBar,{className:"repos-compare-header-commandbar",items:[{ariaLabel:se.PreviousDiff,disabled:!i.getHasPreviousDiff(),iconProps:{iconName:"Up"},id:"prev-diff",important:!0,onActivate:()=>{i.previousDiff();},subtle:!0},{ariaLabel:se.NextDiff,disabled:!i.getHasNextDiff(),iconProps:{iconName:"Down"},id:"next-diff",important:!0,onActivate:()=>{i.nextDiff();},subtle:!0},t.getDiffOrientationMenuItem()],key:"diff-header"}))))));},r=e=>(P.createElement(N.Observer,{content:e.currentVersion.content},t=>{const i=e.pageContext.getService("IFilesHubViewService"),o=e.currentVersion.version;let n="",s="",r="";return t.content&&t.content.error&&1===o.versionOptions?(s=se.NoPreviousVersion,r=se.NoPreviousVersion):(n=t.content?(0,a.getShortCommitId)(t.content.commitId):2===o.versionType?(0,a.getShortCommitId)(o.version):o.version,r=e.ariaLabelPrefix+" "+n,0===o.versionType&&(0===o.versionOptions?s=se.Head:1===o.versionOptions&&(s=se.Previous),r=r+" "+s)),P.createElement(B.ExpandableButton,{anchorOrigin:{horizontal:"start",vertical:"end"},dropdownOrigin:{horizontal:"start",vertical:"start"},renderCallout:(t,o,n,s,r,a,l)=>(P.createElement(O.Callout,{anchorElement:n,anchorOffset:s,anchorOrigin:r,anchorPoint:a,blurDismiss:!0,calloutOrigin:l,contentShadow:!0,escDismiss:!0,focuszoneProps:{circularNavigation:!0,defaultActiveElement:".repos-compare-version-dropdown",focusOnMount:!0},lightDismiss:!0,onDismiss:t.collapse},P.createElement("div",{className:"repos-compare-version-dropdown v-scroll-auto custom-scrollbar scroll-auto-hide no-outline",tabIndex:-1},P.createElement(T.WrappedComponent,{wrappedType:"repos-commits-history",dependencies:["ms.vss-code-web.commits-list"],wrappedProps:{filePath:i.getSelectedItem().value.path,filterVisible:!1,onActivate:(i,o)=>{i.preventDefault(),e.onVersionChanged({version:o.commit.commitId,versionType:2,versionOptions:0},o.commit.changes&&o.commit.changes.length?o.commit.changes[0].sourceServerItem:void 0),t.collapse();},shouldUpdateUrl:!1,showGraph:!1,showHeader:!1,showCommitDetails:!1,version:i.getVersion()}})))),subtle:!0,ariaLabel:r},P.createElement(P.Fragment,null,n&&P.createElement("span",{className:"font-weight-semibold margin-right-4"},n),s&&P.createElement("span",{className:"secondary-text"},"("+s+")")));}));function c(e){return Object.assign(Object.assign({},e),{versionOptions:1});}class d extends i.VssService{constructor(){super(...arguments),this.clearCustomVersions=()=>{const e=this.filesService.getSelectedItem().value.path,t=this.filesService.getVersion();this.modifiedPath.value=e,this.modifiedVersion.value=t,this.originalPath.value=e,this.originalVersion.value=c(t);};}_serviceStart(e){super._serviceStart(e),this.filesService=this.pageContext.getService("IFilesHubViewService"),this.tabsService=(0,ae.getFilesHubTabsService)(this.pageContext);const t=this.filesService.getSelectedItem().value.path,i=this.pageContext.getService("IPageStateHistoryService"),o=i.getProjectedState();this.modifiedPath=new v.ObservableValue(o.mpath||t),i.registerObservable(this.modifiedPath,"mpath",0,e=>(e===this.filesService.getSelectedItem().value.path?"":e),e=>(e||this.filesService.getSelectedItem().value.path)),this.originalPath=new v.ObservableValue(o.opath||t),i.registerObservable(this.originalPath,"opath",0,e=>(e===this.filesService.getSelectedItem().value.path?"":e),e=>(e||this.filesService.getSelectedItem().value.path)),this.modifiedVersion=new v.ObservableValue(this.filesService.getVersion()),i.registerObservable(this.modifiedVersion,"mversion",0,e=>{const t=(0,l.getVersionString)(this.filesService.getVersion()),i=(0,l.getVersionString)(e);return i===t?"":i;},e=>(e?(0,l.gitVersionStringToVersionDescriptor)(e):this.filesService.getVersion())),this.originalVersion=new v.ObservableValue(c(this.filesService.getVersion())),i.registerObservable(this.originalVersion,"oversion",0,e=>{const t=(0,l.getVersionString)(c(this.filesService.getVersion())),i=(0,l.getVersionString)(e);return i===t?"":i;},e=>(e?(0,l.gitVersionStringToVersionDescriptor)(e):c(this.filesService.getVersion()))),this.filesService.getSelectedItem().subscribe(this.clearCustomVersions),this.tabsService.getSelectedTabId().subscribe(this.clearCustomVersions);}_serviceEnd(e){super._serviceEnd(e),this.filesService.getSelectedItem().unsubscribe(this.clearCustomVersions),this.tabsService.getSelectedTabId().unsubscribe(this.clearCustomVersions);}getModifiedPath(){return this.modifiedPath;}getModifiedVersion(){return this.modifiedVersion;}getOriginalPath(){return this.originalPath;}getOriginalVersion(){return this.originalVersion;}setModifiedVersion(e,t){if(this.modifiedVersion.value=e,!t){t=this.pageContext.getService("IFilesHubViewService").getSelectedItem().value.path;}t!==this.modifiedPath.value&&(this.modifiedPath.value=t);}setOriginalVersion(e,t){if(this.originalVersion.value=e,!t){t=this.pageContext.getService("IFilesHubViewService").getSelectedItem().value.path;}t!==this.originalPath.value&&(this.originalPath.value=t);}}i.Services.add("ICompareContentService",{serviceFactory:d}),(0,ae.registerFilesHubTab)({getTab:(e,t,i)=>{if(!t.isFolder&&!t.isInvalid&&!i){const t=e.getService("IFilesHubFilterActionsService");return{id:"compare",name:se.Compare,order:30,render:()=>(P.createElement(o,null)),renderFilterBar:e=>(e?P.createElement(R.HeaderCommandBar,{items:t.getActions()}):void 0)};}},dependencies:["ms.vss-code-web.code-editor"]});}("ComponentsCompareContent")),(function(e){ce=__WRAPPED_set(t,e,'=',{}),__WRAPPED_get(t,e).NotInitializedButton={displayToolTip:!1,buttonColor:"",buttonIcon:"Error",buttonText:se.IndexingButtonInitialText,onClickRef:se.IndexingInitialOnClickRef};__WRAPPED_get(t,e).FilesHeader=n=>{const __cas_var0=n,s=__cas_var0.pageContext,[r,a]=P.useState(),[l,c]=P.useState(),[d,m]=P.useState(),h=P.useCallback(async e=>{if(e.name!==d){const t=e.commitId,i=await(null==r?void 0:r.getToolTipProvider(e.path.substring(1),t,!0));i&&(c({displayToolTip:i.displayToolTip,buttonText:i.buttonText,buttonColor:i.buttonColor,buttonIcon:i.buttonIcon,onClickRef:i.onClickRef}),m(e.name));}},[r,l,d]);return P.useEffect(()=>{if(!r){(async()=>{const e=s.getService("IVssContributionService"),t=e.getContributionsByType("ms.vss-features.code-editor-navigation-provider");for(const i in t){const t=await e.getService(i);a({availableLanguages:null==t?void 0:t.availableLanguages,getToolTipProvider:null==t?void 0:t.getToolTipProvider});}})();}},[]),P.createElement(K.ScreenSizeObserver,null,n=>{const a=s.getService("IFilesHubViewService");return P.createElement(N.Observer,{item:a.getSelectedItem()},c=>{const __cas_var1=c,d=__cas_var1.item,m={cpp:"cpp",cs:"csharp",vb:"csharp",h:"cpp",java:"java",js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript"},u=e=>{if(r&&Object.keys(r).length>0){const t=(e=>(e.name.split(".").slice(-1)[0]))(e);if(t)return-1!=r.availableLanguages.indexOf(__WRAPPED_get(m,t));}return!1;};return u(d)&&r&&h(d),P.createElement(P.Fragment,null,P.createElement(i,{item:d,pageContext:s,screenSize:n.screenSize}),P.createElement(q.CustomHeader,{className:"repos-files-header bolt-header-with-commandbar"},P.createElement(q.HeaderTitleArea,null,P.createElement(q.HeaderTitleRow,null,P.createElement(q.HeaderTitle,{className:"text-ellipsis",titleSize:1},"/"===d.path?se.Files:d.name)),u(d)&&(null==l?void 0:l.displayToolTip)&&P.createElement(B.Button,{style:{background:"None",paddingLeft:"revert",color:l?null==l?void 0:l.buttonColor:__WRAPPED_get(t,e).NotInitializedButton.buttonColor},className:"repos-files-header Indexing button",ariaLabel:l?null==l?void 0:l.buttonText:__WRAPPED_get(t,e).NotInitializedButton.buttonText,iconProps:{iconName:l?null==l?void 0:l.buttonIcon:__WRAPPED_get(t,e).NotInitializedButton.buttonIcon},onClick:()=>(window.open(l?null==l?void 0:l.onClickRef:__WRAPPED_get(t,e).NotInitializedButton.onClickRef,"_blank"))})),"/"===d.path&&P.createElement(o,{pageContext:s}),P.createElement(j.FilesHeaderCommandBar,{filesService:a,item:d,saveTitle:se.Commit,screenSize:n.screenSize})));});});};const i=e=>{const __cas_var2=e,t=__cas_var2.item,i=__cas_var2.pageContext,o=__cas_var2.screenSize,n=i.getService("IFilesHubViewService"),s=n.getVersion(),r=new v.ObservableValue(!1),a=P.createRef(),d=i.getService("IVssKeyboardShortcutService");P.useEffect(()=>((d.registerShortcut(se.FilesShortcutGroup,{combos:["w"],description:se.SelectBranchShortcutDescription,action:()=>{a.current&&(a.current.focus(),a.current.expand());}}),d.registerShortcut(se.FilesShortcutGroup,{combos:["."],description:se.OpenInVsCodeForTheWeb,action:()=>{var e;const t=new URL((0,c.getGitRepository)(i).remoteUrl);t.search=n.getSelectedItem().value.linkProps.href;const o=i.getService("IVssPageService").getData(),s=(null==o?void 0:o.isHosted)?t.pathname.replace(se.DefaultCollection,""):t.pathname;let r=se.VsCodeUrl+t.hostname+s+t.search;if((0,b.isFeatureFlagEnabled)(i,"SourceControl.PassTenantIdToVSCodeShortcut",!1)){var a=i.getService("IVssContributionService").getData("ms.vss-code-web.organization-admin-aad-data-provider");(null===(e=null==a?void 0:a.orgnizationTenantData)||void 0===e?void 0:e.id)&&a.orgnizationTenantData.id!==C.EmptyGuidString&&(r=r+"&tenantId="+a.orgnizationTenantData.id);}(0,I.onClickFPS)(i,r,!0);}}),()=>{d.unRegisterShortcut(se.FilesShortcutGroup,"w"),d.unRegisterShortcut(se.FilesShortcutGroup,".");})));const m=(e,t)=>{var o;const n=i.getService("IFilesHubViewService"),s=(0,ae.getFilesHubTabsService)(i),r=(0,l.getVersionString)(n.getVersion()),c=t.data.versionDescriptor,d=(0,l.getVersionString)(c);if(r!==d){const t=n.getItemUrl(n.getSelectedItem().value.path,{version:d,tabId:s.getSelectedTabId().value});(0,I.onClickFPS)(i,t,!0,e),null===(o=a.current)||void 0===o||o.resetSelection();}};return P.createElement("div",{className:"repos-files-header-path-row body-m flex-row flex-center flex-noshrink scroll-hidden"},P.createElement(N.Observer,{editMode:r,key:"version"},e=>(P.createElement(z.VersionDropdown,{className:(0,A.css)(e.editMode&&o<=0&&"hidden"),initiallySelectedVersion:s,onSelect:m,providerOptions:{onCreateBranchClick:()=>{a.current&&a.current.focus(),(0,M.getDefaultCreateBranchAction)(i,{referenceVersion:s},n.getSelectedItem().value.path)();}},ref:a}))),P.createElement(_.ClipboardButton,{className:"repos-files-branch-copy-button",getContent:()=>(s.version),key:"clipboard",showCopiedTooltip:!0,tooltipProps:{text:Q.CopyToClipboard}}),P.createElement(G.FilesEditableBreadcrumb,{key:"breadcrumb",canSearch:!0,editMode:r,filesService:n,onPathSelected:e=>(n.setSelectedPath(e)),selectedPath:t.path,screenSize:o}));},o=e=>{const t=e.pageContext,i=t.getService("IFilesHubViewService"),o=(0,c.getGitRepository)(t),n=(0,p.getTFSPageData)(t).project,s=i.getVersion();if(0!==s.versionType)return null;const r="refs/heads/"+s.version;return P.createElement(T.WrappedComponent,{wrappedType:"Repos.BranchPipelineStatus",dependencies:["ms.vss-code-web.pipeline-status-dependencies"],className:"flex-noshrink margin-horizontal-8 flex-self-center",projectId:n.id,repositoryId:o.id,refName:r,renderNoStatus:()=>{const e=t.getService("IStartRightExtensionService").getCreatePipelineUrlByRepository(t,o.id,o.name,r)||(0,W.routeUrl)(t,"ms.vss-ciworkflow.ci-editor-route",{project:n.name,_a:"build-definition-getting-started",source:"code",repository:o.name,repositoryId:o.id,branchName:r,repositoryType:"TfsGit"});return P.createElement(B.Button,{className:"repos-files-header-setup-build-button",iconProps:{iconName:"Build"},primary:!0,text:se.SetupBuild,href:e});}});};}("ComponentsFilesHeader")),t.ComponentsFolderListing={},(0,ae.registerFilesHubTab)({getTab:(e,t)=>{if(t.isFolder&&!t.isInvalid){const t=e.getService("IFilesHubFilterActionsService");return{id:"contents",name:se.Contents,order:10,render:()=>(P.createElement($.FolderListing,{commentsHeaderTitle:se.Commits,filesService:(0,ae.getFilesHubViewService)(e)})),renderFilterBar:e=>(e?P.createElement(R.HeaderCommandBar,{items:t.getActions()}):void 0)};}}}),(function(e){__WRAPPED_set(t,e,'=',{});class i extends T.VssComponent{constructor(){super(...arguments),this.onContentChanged=e=>{const t=this.context.pageContext.getService("IFilesHubViewService").getSelectedItemContent();t.value&&t.value.editContext&&t.value.editContext.setContent(e);};}render(){const e=this.context.pageContext.getService("IFilesHubViewService");return P.createElement(N.Observer,{originalContent:e.getSelectedItemContent()},t=>{let i;return t.originalContent&&(i=t.originalContent.details,t.originalContent.editContext&&(i={content:t.originalContent.editContext.getContent(),contentTruncated:t.originalContent.details.contentTruncated,metadata:t.originalContent.details.metadata,objectId:t.originalContent.details.objectId,resourceUri:t.originalContent.details.resourceUri})),P.createElement(E.Card,{className:"no-padding flex-grow v-scroll-hidden",contentProps:{contentPadding:!1}},t.originalContent?P.createElement(T.WrappedComponent,{wrappedType:"repos-diff-viewer",dependencies:["ms.vss-code-web.code-editor"],wrappedProps:{addDiffKeyboardShortcuts:!1,className:"flex-column flex-grow",diffOrientation:e.getDiffOrientation(),editable:!0,editorClassName:"repos-file-editor-background scroll-hidden",isPixelDiff:!1,modifiedContent:i,onContentChanged:this.onContentChanged,originalContent:t.originalContent.details}}):P.createElement("div",{className:"repos-file-editor-background flex-grow"}));});}}__WRAPPED_get(t,e).HighlightChanges=i,(0,ae.registerFilesHubTab)({getTab:(e,t,o)=>{if(o&&!t.isFolder&&!t.isNewItem)return{id:"diff",name:se.HighlightChanges,order:20,render:()=>(P.createElement(i,null)),renderFilterBar:t=>{const i=e.getService("IFilesHubViewService");return t?P.createElement(N.Observer,{diffOrientation:i.getDiffOrientation()},()=>(P.createElement(R.HeaderCommandBar,{items:[i.getDiffOrientationMenuItem()]}))):void 0;}};}});}("ComponentsHighlightChanges")),(function(e){t.ComponentsHistoryContent={};class i extends T.VssComponent{render(){return P.createElement(y.PerformanceScenarioContext.Consumer,null,e=>{const t=e.registerPendingWork("load-history"),i=this.context.pageContext.getService("IFilesHubViewService");return P.createElement(T.WrappedComponent,{wrappedType:"repos-commits-history",dependencies:["ms.vss-code-web.commits-list"],wrappedProps:{filterVisible:this.props.filterVisible,filePath:i.getSelectedItem().value.path,isSingleFileHistory:!i.getSelectedItem().value.isFolder,onLoaded:t&&t.complete,shouldUpdateUrl:!0,showGraph:!0,version:i.getVersion()}});});}}(0,ae.registerFilesHubTab)({getTab:(e,t,o)=>{if(!t.isInvalid&&!o){const t=e.getService("IFilesHubFilterActionsService"),o=e.getService("IVssHistoryService").getState(),n=new v.ObservableValue(Boolean(o.toDate||o.fromDate||o.user||o.historyType));return{id:"history",name:se.History,order:20,render:()=>(P.createElement(i,{filterVisible:n})),renderFilterBar:e=>(e?P.createElement(R.HeaderCommandBar,{items:[{ariaLabel:se.Filter,iconProps:{iconName:"Filter"},id:"filter",onActivate:()=>{n.value=!n.value;},subtle:!0},...t.getActions()]}):void 0)};}},dependencies:["ms.vss-code-web.commits-list"]});}()),(function(e){__WRAPPED_set(t,e,'=',{});class i extends T.VssComponent{render(){const e=this.context.pageContext.getService("IFilesHubViewService"),t=e.getSelectedItem().value.path,i=e.getVersion(),o=(0,c.getGitRepository)(this.context.pageContext),n=(0,C.format)(se.InvalidFileMessageFormat,t,(0,l.getVersionDisplayName)(i));let s,r,d;return(0,C.equals)(o.defaultBranch,(0,a.specToRefName)(i))?(s=se.GoToRepositoryRoot,r=e.getItemUrl("/"),d=t=>{e.setSelectedPath("/"),t.preventDefault();}):(s=se.GoToDefaultBranch,r=e.getItemUrl(t,{version:"GB"+(0,a.refToBranchName)(o.defaultBranch)})),P.createElement(Z.ZeroData,{className:"flex-grow",imagePath:(0,W.getAssetLocation)(this.context.pageContext,"ms.vss-code-web/files-hub-content-new/Content/invalid-path.svg"),imageAltText:n,primaryText:se.InvalidFileTitle,secondaryText:n,actionType:0,actionText:s,actionHref:r,onActionClick:d});}}__WRAPPED_get(t,e).InvalidPath=i,(0,ae.registerFilesHubTab)({getTab:(e,t,o)=>{if(t.isInvalid&&!t.isNewItem)return{id:"contents",name:se.Contents,order:10,render:()=>(P.createElement(i,null))};}});}("ComponentsInvalidPath")),t.ComponentsPreviewContent={},(0,ae.registerFilesHubTab)({getTab:(e,t,i)=>{if(t.isInvalid&&!t.isNewItem)return;const o=(0,Y.getContentPreviewService)(e).getPreviewContribution(t.path);if(!o)return;const n=(0,ae.getFilesHubViewService)(e);return{id:"preview",name:se.Preview,order:15,render:()=>(P.createElement(d.ContentPreview,{className:"files-hub-content-preview",contributionId:o.contributionId,contribution:o,getItemContent:()=>(n.getItemContent(t.path)),urlTransformer:n.getUrlTransformer(t.path)}))};},isDefaultTab:(e,t,i,o,n)=>{const s=(0,Y.getContentPreviewService)(e).getPreviewContribution(t.path),r=e.getService("IPageStateHistoryService").getProjectedState();return!i&&""===n&&!!s&&s.defaultBehavior&&!(r.line&&r.lineStartColumn)&&(s.defaultBehavior===Y.ContentPreviewDefaultBehavior.ShowRenderedContent||s.defaultBehavior.toString()===__WRAPPED_get(Y.ContentPreviewDefaultBehavior,Y.ContentPreviewDefaultBehavior.ShowRenderedContent));}}),(function(e){t.ComponentsFilesHub={};const i="Repos.FilesHub.SplitterWidth";class o extends T.VssComponent{render(){const e=new w.Uri(__WRAPPED_get(window,'location').href);if(e.hashString){const t=(0,w.parseQueryString)(e.hashString);for(const i of t)e.addQueryParam(i.name,i.value);return e.hashString="",(0,I.FastPageSwitch)(this.context.pageContext,e.absoluteUri,!1),null;}return P.createElement(y.PerformanceScenario,{area:"Repos",scenarioName:"files-hub",tti:!0},P.createElement(n,{pageContext:this.context.pageContext}));}}const n=e=>{const __cas_var3=e,t=__cas_var3.pageContext,o=(0,ae.getFilesHubTabsService)(t),n=(0,ae.getFilesHubViewService)(t),r=t.getService("IVssLayoutManager"),a=e=>{o.setSelectedTabId(e);},l=()=>(P.createElement(J.FileExplorerTree,{filesService:n})),c=()=>{const e=o.getSelectedTabId(),i=o.getTabs();return P.createElement(ee.Page,{className:"repos-files-hub-page flex-grow custom-scrollbar scroll-auto-hide",tabProviders:i,selectedTabId:e},P.createElement(ce.FilesHeader,{pageContext:t}),P.createElement(oe.TabBar,{selectedTabId:e,onSelectedTabChanged:a}),P.createElement("div",{className:(0,T.css)("page-content page-content-top flex-column flex-noshrink flex-grow rhythm-vertical-16")},P.createElement(X.ReposMessages,{className:"flex-noshrink"}),P.createElement(s,{pageContext:t})));};return P.createElement(N.Observer,{loadedFolders:n.getLoadedFolders(),fullScreenMode:r.getFullScreenMode()},e=>{var t;return P.createElement(ie.Surface,{background:1},(null===(t=e.loadedFolders)||void 0===t?void 0:t.length)?P.createElement(K.ScreenSizeObserver,null,t=>{const o=0===t.screenSize;return o&&n.setDiffOrientation(2),P.createElement(te.Splitter,{className:(0,T.css)("scroll-hidden bolt-page-grey",o&&"extra-small-view"),collapsed:n.getExplorerCollapsed(),expandTooltip:se.ShowExplorerPane,farElementClassName:"flex-column",fixedElement:0,initialFixedSize:parseInt(""+(0,F.tryGetLocalStorageValue)(i))||300,minFixedSize:180,nearElementClassName:"flex-column",onCollapsedChanged:e=>(n.setExplorerCollapsed(e)),onFixedSizeChanged:e=>{(0,F.trySetLocalStorageValue)(i,""+e);},onRenderFarElement:c,onRenderNearElement:o||e.fullScreenMode?void 0:l});}):P.createElement(ee.Page,{className:"flex-grow"},P.createElement(ne.MessageCard,{severity:"Error"},se.BranchNotFound)));});},s=e=>{const __cas_var4=e,t=__cas_var4.pageContext,i=(0,ae.getFilesHubViewService)(t),o=(0,ae.getFilesHubTabsService)(t),n=i.getSelectedItem(),s=o.getSelectedTabId();let r=n.value.path,a=s.value;return P.createElement(y.PerformanceScenarioContext.Consumer,null,e=>(P.createElement(N.Observer,{selectedItem:n,selectedTab:s},i=>{const o=i.selectedItem.path!==r,n=i.selectedTab!==a;if(o||n){const t=e.resetScenario();t.addProperties({inPageNavigate:!0}),t.addProperties({switchFiles:o}),t.addProperties({switchTabs:n}),r=i.selectedItem.path,a=i.selectedTab;}e.getScenario().addProperties({tab:i.selectedTab});return t.getService("ITfsNavigationService").setPageTitle("/"===i.selectedItem.path?(0,c.getGitRepository)(t).name:i.selectedItem.name),P.createElement(oe.TabContent,null);})));};T.Components.add("ms.vss-code-web.files-hub",o);}());},["Resources","RestClient/Git","FilesHubViewService","Components/FileContent","Components/BlameContent","Components/CompareContent","Components/FilesHeader","Components/FolderListing","Components/HighlightChanges","Components/HistoryContent","Components/InvalidPath","Components/PreviewContent","Components/FilesHub"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-code-web.files-hub-content-new"}}));